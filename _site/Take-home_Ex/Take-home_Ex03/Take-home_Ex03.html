<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sei Sar Hla Kyi">
<meta name="dcterms.date" content="2024-10-14">

<title>ISSS626-GAA - Take Home Exercise 3: Modelling Geography of Financial Inclusion in Tanzania with Geographically Weighted Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">2 Methodology</a></li>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages">3 Loading R Packages</a></li>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">4 Importing the Data</a>
  <ul class="collapse">
  <li><a href="#the-datasets" id="toc-the-datasets" class="nav-link" data-scroll-target="#the-datasets">4.1 The Datasets</a></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">4.2 Aspatial Data</a></li>
  <li><a href="#geospatial-data---study-area" id="toc-geospatial-data---study-area" class="nav-link" data-scroll-target="#geospatial-data---study-area">4.3 Geospatial Data - Study Area</a></li>
  </ul></li>
  <li><a href="#the-dependent-variable" id="toc-the-dependent-variable" class="nav-link" data-scroll-target="#the-dependent-variable">5 The Dependent Variable</a>
  <ul class="collapse">
  <li><a href="#financial-inclusion-in-tanzania" id="toc-financial-inclusion-in-tanzania" class="nav-link" data-scroll-target="#financial-inclusion-in-tanzania"><strong>5.1 Financial Inclusion in Tanzania</strong></a></li>
  <li><a href="#deriving-the-dependent-variable---mobile-money-usage" id="toc-deriving-the-dependent-variable---mobile-money-usage" class="nav-link" data-scroll-target="#deriving-the-dependent-variable---mobile-money-usage"><strong>5.2 Deriving The Dependent Variable - Mobile Money Usage</strong></a></li>
  <li><a href="#dependent-variable-implications" id="toc-dependent-variable-implications" class="nav-link" data-scroll-target="#dependent-variable-implications">5.3 Dependent Variable Implications</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">6 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables">6.1 Categorical Variables</a></li>
  <li><a href="#continuous-variables" id="toc-continuous-variables" class="nav-link" data-scroll-target="#continuous-variables">6.2 Continuous Variables</a></li>
  <li><a href="#dependent-variable" id="toc-dependent-variable" class="nav-link" data-scroll-target="#dependent-variable">6.3 Dependent Variable</a></li>
  <li><a href="#forming-centroids" id="toc-forming-centroids" class="nav-link" data-scroll-target="#forming-centroids">6.4 Forming Centroids</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">7 Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics-and-visualizations" id="toc-descriptive-statistics-and-visualizations" class="nav-link" data-scroll-target="#descriptive-statistics-and-visualizations">7.1 Descriptive Statistics and Visualizations</a>
  <ul class="collapse">
  <li><a href="#visualizing-dependent-variable" id="toc-visualizing-dependent-variable" class="nav-link" data-scroll-target="#visualizing-dependent-variable">7.1.1 Visualizing Dependent Variable</a></li>
  <li><a href="#histogram-plots-of-predictor-variables" id="toc-histogram-plots-of-predictor-variables" class="nav-link" data-scroll-target="#histogram-plots-of-predictor-variables">7.1.2 Histogram Plots of Predictor Variables</a></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">7.2 Correlation Analysis</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">8 Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#initial-model" id="toc-initial-model" class="nav-link" data-scroll-target="#initial-model">8.1 Initial Model</a></li>
  <li><a href="#the-refined-model---stepwise-regression" id="toc-the-refined-model---stepwise-regression" class="nav-link" data-scroll-target="#the-refined-model---stepwise-regression">8.2 The Refined Model - Stepwise Regression</a></li>
  <li><a href="#variable-selected" id="toc-variable-selected" class="nav-link" data-scroll-target="#variable-selected">8.3 Variable Selected</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">8.4 Model Diagnostics</a>
  <ul class="collapse">
  <li><a href="#multicollinearity---vif" id="toc-multicollinearity---vif" class="nav-link" data-scroll-target="#multicollinearity---vif"><strong>8.4.1 Multicollinearity - VIF</strong></a></li>
  <li><a href="#test-for-non-linearity" id="toc-test-for-non-linearity" class="nav-link" data-scroll-target="#test-for-non-linearity">8.4.2 Test for Non Linearity</a></li>
  <li><a href="#test-for-normality-assumption" id="toc-test-for-normality-assumption" class="nav-link" data-scroll-target="#test-for-normality-assumption">8.4.3 Test for Normality Assumption</a></li>
  <li><a href="#test-for-spatial-autocorrelation" id="toc-test-for-spatial-autocorrelation" class="nav-link" data-scroll-target="#test-for-spatial-autocorrelation">8.4.4 Test for Spatial Autocorrelation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geographically-weighted-linear-regression" id="toc-geographically-weighted-linear-regression" class="nav-link" data-scroll-target="#geographically-weighted-linear-regression">9 Geographically Weighted Linear Regression</a>
  <ul class="collapse">
  <li><a href="#adaptive-bandwidth" id="toc-adaptive-bandwidth" class="nav-link" data-scroll-target="#adaptive-bandwidth">9.1 Adaptive Bandwidth</a></li>
  <li><a href="#gwr-model" id="toc-gwr-model" class="nav-link" data-scroll-target="#gwr-model">9.2 GWR Model</a></li>
  <li><a href="#visualizing-gwr-output" id="toc-visualizing-gwr-output" class="nav-link" data-scroll-target="#visualizing-gwr-output">9.3 Visualizing GWR Output</a>
  <ul class="collapse">
  <li><a href="#visualizing-local-r2" id="toc-visualizing-local-r2" class="nav-link" data-scroll-target="#visualizing-local-r2">9.3.1 Visualizing Local <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#visualizing-coefficient-estimates" id="toc-visualizing-coefficient-estimates" class="nav-link" data-scroll-target="#visualizing-coefficient-estimates">9.3.2 Visualizing coefficient estimates</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">10 Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 3: Modelling Geography of Financial Inclusion in Tanzania with Geographically Weighted Methods</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sei Sar Hla Kyi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 14, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1 Overview</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.1 Background</h2>
<p>Financial inclusion plays a key role in promoting equitable economic growth by enabling individuals and businesses to access essential financial services such as banking, loans, insurance, and equity products. In Tanzania, financial inclusion initiatives have become a priority in addressing the needs of underserved populations, particularly those in rural or economically disadvantaged areas. These initiatives aim to improve household incomes, reduce income inequality, and foster inclusive economic participation by providing timely and affordable access to financial products and services(United Nations Capital Development Fund [UNCDF], 2024).</p>
<p>Despite significant progress in financial inclusion efforts, access to financial services is uneven across different geographical regions within Tanzania. Rural areas, particularly in districts with low levels of economic activity, often face greater challenges in accessing financial services compared to more urbanized districts. These spatial disparities raise important questions about the factors driving financial inclusion at the district level and how regional policies can be designed to promote more inclusive economic outcomes.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>This analysis aims to build an explanatory model using Multiple Linear Regression as well as Geographically Weighted Regression (GWR) to identify the key factors affecting financial inclusion across districts in Tanzania. By focusing on multiple socio-economic and infrastructural variables, this study will provide insights into how these factors vary geographically and influence financial access <strong><em>at a district level</em></strong>.</p>
<p>Specifically, the objectives are:</p>
<ul>
<li><p><strong>Identify Key Determinants</strong>: Determine the primary socio-economic and infrastructural factors that influence financial inclusion.</p></li>
<li><p><strong>Examine Regional Variation</strong>: Explore how the effects of these factors vary across different districts, providing a localized understanding of financial inclusion.</p></li>
</ul>
</section>
</section>
<section id="methodology" class="level1">
<h1>2 Methodology</h1>
<p>The explanatory model will be developed first using <strong>Multiple Linear Regression</strong> and <strong>Geographically Weighted Regression (GWR)</strong>, which is a spatial extension of multiple linear regression that allows for localized variations in the relationships between predictors and the response variable—in this case, financial inclusion.</p>
<p>The process will follow these steps:</p>
<ul>
<li><p><strong>Defining dependent variable (y)</strong>: Derive dependent variable which represents financial inclusion from the FinScope dataset.</p></li>
<li><p><strong>Explanatory Variable Selection (x)</strong>: Identify key predictor variables, both continuous and categorical, from the FinScope dataset. These will serve as explanatory variables in the model.</p></li>
<li><p><strong>Model Building</strong>: Build the explanatory model using multiple linear regression techniques, enhanced by GWR to account for geographical variations. This will allow us to evaluate the influence of each predictor on financial inclusion across different districts.</p></li>
<li><p><strong>Model Calibration and Validation</strong>: Calibrate the model to ensure that it effectively captures the localized relationships between financial inclusion and its determinants.</p></li>
<li><p><strong>Spatial Visualization</strong>: Mapping the results of the GWR model to visualize how the effects of each factor vary geographically, will highlight districts where specific variables have a stronger or weaker influence on financial inclusion.</p></li>
</ul>
<hr>
</section>
<section id="loading-r-packages" class="level1">
<h1>3 Loading R Packages</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Packages Used</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The following packages were used for this study:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>olsrr</td>
<td>For creating and evaluating ordinary least squares regression models.</td>
</tr>
<tr class="even">
<td>ggstatsplot</td>
<td>for producing statistical visualizations that combine ggplot2 graphics with statistical results</td>
</tr>
<tr class="odd">
<td>e1071</td>
<td>For checking skewness of variables</td>
</tr>
<tr class="even">
<td>ggpubr</td>
<td>To create publication-ready visualizations with ggplot2 and arranging multiple plots</td>
</tr>
<tr class="odd">
<td>sf</td>
<td>For importing, managing, and handling geospatial data</td>
</tr>
<tr class="even">
<td>sfdep</td>
<td>To analyze spatial relationships and incorporate them into regression models</td>
</tr>
<tr class="odd">
<td>spdep</td>
<td>For calculating spatial weights and conducting tests for spatial relationships</td>
</tr>
<tr class="even">
<td>GWmodel</td>
<td>To explore spatially varying relationships between the dependent and independent variables</td>
</tr>
<tr class="odd">
<td>tmap</td>
<td>For thematic mapping, allowing us to visualize spatial data in an intuitive and aesthetically pleasing manner</td>
</tr>
<tr class="even">
<td>tidyverse</td>
<td>For data manipulation, cleaning, and visualization</td>
</tr>
<tr class="odd">
<td>gtsummary</td>
<td>To create summary tables for regression results, providing a clear and concise presentation of model outputs</td>
</tr>
<tr class="even">
<td>see</td>
<td>For visualizing model diagnostics and results</td>
</tr>
<tr class="odd">
<td>performance</td>
<td>For evaluating model performance and diagnostics</td>
</tr>
<tr class="even">
<td>datawizard</td>
<td>To handle missing values, recode variables, and perform exploratory data analysis before modeling</td>
</tr>
<tr class="odd">
<td>gtsummary</td>
<td>To create publication ready summary tables</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We will use this code to load the packages mentioned:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(st,olsrr,e1071, ggstatsplot, ggpubr, sf, spdep, sfdep, GWmodel, tmap, tidyverse, gtsummary,see,performance,datawizard,gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="importing-the-data" class="level1">
<h1>4 Importing the Data</h1>
<section id="the-datasets" class="level2">
<h2 class="anchored" data-anchor-id="the-datasets">4.1 The Datasets</h2>
<p>For this analysis, we will use two primary datasets: (1) FinScope Tanzania 2023, which provides district-level data on financial inclusion, and (2) district-level boundary GIS data from the geoBoundaries portal to facilitate spatial analysis.</p>
<ul>
<li><p><strong>FinScope Tanzania 2023</strong>: This dataset include comprehensive district-level data on access to financial services, covering indicators such as banking services, mobile money usage, savings, loans, and insurance. The dataset will be used to identify the key factors affecting financial inclusion and to develop the explanatory model.</p></li>
<li><p><strong>District Boundary GIS Data</strong>: Geographic boundary data for the districts of Tanzania, sourced from the geoBoundaries, will enable us to link the financial inclusion data to specific geographic locations for spatial analysis using GWR.</p></li>
</ul>
</section>
<section id="aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data">4.2 Aspatial Data</h2>
<p>The <em>FinScope</em> <em>Tanzania</em> dataset from 2023, was imported by using <em>read_csv()</em> package.</p>
<p>Then, the data was prepared for analysis with the following steps:</p>
<ul>
<li>We extract the columns with the variables chosen which will be explained in the Variable Selection section.</li>
<li>Rename some district names to match the boundary dataset in section 4.3.</li>
<li>Remove columns with all missing/NA values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/FinScope_Tanzania.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">16</span>, <span class="dv">65</span><span class="sc">:</span><span class="dv">67</span>,<span class="dv">70</span><span class="sc">:</span><span class="dv">73</span>, <span class="dv">82</span><span class="sc">:</span><span class="dv">83</span>, <span class="dv">85</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">103</span>, <span class="dv">107</span><span class="sc">:</span><span class="dv">119</span>, <span class="dv">125</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="dv">140</span>, <span class="dv">142</span><span class="sc">:</span><span class="dv">151</span>, <span class="dv">160</span><span class="sc">:</span><span class="dv">174</span>, <span class="dv">177</span><span class="sc">:</span><span class="dv">178</span>, <span class="dv">180</span>, <span class="dv">183</span><span class="sc">:</span><span class="dv">192</span>, <span class="dv">196</span>, <span class="dv">215</span><span class="sc">:</span><span class="dv">223</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="dv">275</span><span class="sc">:</span><span class="dv">278</span>, <span class="dv">294</span><span class="sc">:</span><span class="dv">306</span>, <span class="dv">344</span><span class="sc">:</span><span class="dv">353</span>, <span class="dv">361</span><span class="sc">:</span><span class="dv">372</span>, <span class="dv">374</span><span class="sc">:</span><span class="dv">378</span>, <span class="dv">395</span><span class="sc">:</span><span class="dv">397</span>, <span class="dv">455</span><span class="sc">:</span><span class="dv">460</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="dv">495</span>, <span class="dv">497</span>, <span class="dv">507</span><span class="sc">:</span><span class="dv">529</span>, <span class="dv">574</span><span class="sc">:</span><span class="dv">580</span>, <span class="dv">591</span>, <span class="dv">612</span>, <span class="dv">650</span><span class="sc">:</span><span class="dv">651</span>, <span class="dv">653</span>, <span class="dv">655</span>, <span class="dv">657</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">678</span>, <span class="dv">680</span><span class="sc">:</span><span class="dv">685</span>, <span class="dv">697</span><span class="sc">:</span><span class="dv">698</span>, <span class="dv">702</span><span class="sc">:</span><span class="dv">716</span>, <span class="dv">718</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Magharibi A"</span>, <span class="st">"Magharibi"</span>, dist_name),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Magharibi B"</span>, <span class="st">"Magharibi"</span>, dist_name),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Nyang'hwale"</span>, <span class="st">"Nyanghwale"</span>, dist_name),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Wanging'ombe"</span>, <span class="st">"Wangingombe"</span>, dist_name),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Tanganyika"</span>, <span class="st">"Tanga"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use <strong><em>glimpse()</em></strong> to quickly check the attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tanzania)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we will save the prepared dataframe into rds format.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzania, <span class="st">"data/rds/tanzania.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzania.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="geospatial-data---study-area" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data---study-area">4.3 Geospatial Data - Study Area</h2>
<p>The <em>geo Boundaries of Tanzania</em> dataset, was imported by using <em>st_read()</em> package.</p>
<p>The dataset was prepared for analysis with the following steps:</p>
<ul>
<li><p>We note that Tanzania is in WGS 84/ UTM Zone 37S. We will use st_transform to reproject coordinate reference system to EPSG: 32737 for Tanzania.</p></li>
<li><p>To perform left join with the aspatial dataset, we need a common column - districts name. Therefore, we need to change the variable, shapeName, to ‘dist_name’ to make it a common variable with the FinScope Tanzania dataset.</p></li>
<li><p>To ensure the districts are common, some districts will be renamed from “Arusha Urban” to “Arusha” as the same way it was displayed in FinScope Tanzania dataset. Since the FinScope Tanzania dataset already have a variable that classifies if the surveyee is residing in an urban or rural area, we do not need to have a separate district with the title Urban as it falls under the same district.</p></li>
<li><p>We will also remove some district names that are not present in the FinScope Tanzania dataset.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tanzbounds <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"geoBoundaries-TZA-ADM2"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">32737</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist_name =</span> shapeName) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Arusha Urban"</span>, <span class="st">"Arusha"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Meru"</span>, <span class="st">"Arumeru"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Iringa Urban"</span>,<span class="st">"Iringa"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Bukoba Urban"</span>, <span class="st">"Bukoba"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mpanda Urban"</span>, <span class="st">"Mpanda"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kigoma  Urban"</span>, <span class="st">"Kigoma"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Moshi Urban"</span>, <span class="st">"Moshi"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Lindi Urban"</span>, <span class="st">"Lindi"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Musoma Urban"</span>, <span class="st">"Musoma"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mbeya Urban"</span>, <span class="st">"Mbeya"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Babati UrbanBabati Urban"</span>, <span class="st">"Babati"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Dodoma Urban"</span>, <span class="st">"Dodoma"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kibaha Urban"</span>, <span class="st">"Kibaha"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Morogoro Urban"</span>, <span class="st">"Morogoro"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mtwara Urban"</span>, <span class="st">"Mtwara"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Njombe Urban"</span>, <span class="st">"Njombe"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mtwara Urban"</span>, <span class="st">"Mtwara"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Shinyanga Urban"</span>, <span class="st">"Shinyanga"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Singida Urban"</span>, <span class="st">"Singida"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Songea Urban"</span>, <span class="st">"Songea"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Sumbawanga Urban"</span>, <span class="st">"Sumbawanga"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Tabora Urban"</span>, <span class="st">"Tabora"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Tanga Urban"</span>, <span class="st">"Tanga"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Nyang'hwale"</span>, <span class="st">"Nyanghwale"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Wanging'ombe"</span>, <span class="st">"Wangingombe"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Butiam"</span>, <span class="st">"Butiama"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kahama Township Authority"</span>, <span class="st">"Kahama"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kasulu Township Authority"</span>, <span class="st">"Kasulu"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Masasi  Township Authority"</span>, <span class="st">"Masasi"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Handeni Mji"</span>, <span class="st">"Handeni"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>dist_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Korogwe Township Authority"</span>,<span class="st">"Mafia"</span>,<span class="st">"Tunduma"</span>,<span class="st">"Korogwe"</span>,<span class="st">"Mafinga Township Authority"</span>,<span class="st">"Makambako Township Authority"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (<span class="sc">-</span><span class="fu">c</span>(<span class="st">"shapeISO"</span>,<span class="st">"shapeID"</span>,<span class="st">"shapeGroup"</span>,<span class="st">"shapeType"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `geoBoundaries-TZA-ADM2' from data source 
  `/Users/seesarhlakyi/Desktop/ssrhk/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/data/rawdata' 
  using driver `ESRI Shapefile'
Simple feature collection with 170 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 29.58953 ymin: -11.76235 xmax: 40.44473 ymax: -0.983143
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>To ensure the study area is in the correct format, we will use <strong><em>st_crs</em></strong> to check.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(tanzbounds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32737 
  wkt:
PROJCRS["WGS 84 / UTM zone 37S",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 37S",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",39,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",10000000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["Between 36°E and 42°E, southern hemisphere between 80°S and equator, onshore and offshore. Kenya. Mozambique. Tanzania."],
        BBOX[-80,36,0,42]],
    ID["EPSG",32737]]</code></pre>
</div>
</div>
<p>Now that we have seen that study area is correct and names are properly changed, we will use the code chunk below to dissolve the geometries within each district into a single, unified shape using <code>st_union()</code>. By doing this, we ensure that each district has only one consolidated geometry, removing any duplicate shapes associated with that district. The <code>.groups = 'drop'</code> argument is included to simplify the output, dropping the grouping structure after summarizing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tanzbounds <span class="ot">&lt;-</span> tanzbounds <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dist_name) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">'drop'</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we are ready to save the dataset.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzbounds, <span class="st">"data/rds/tanzbounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tanzbounds<span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzbounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="the-dependent-variable" class="level1">
<h1>5 The Dependent Variable</h1>
<section id="financial-inclusion-in-tanzania" class="level2">
<h2 class="anchored" data-anchor-id="financial-inclusion-in-tanzania"><strong>5.1 Financial Inclusion in Tanzania</strong></h2>
<p>Financial inclusion ensures that individuals and businesses have access to affordable financial products and services—spanning payments, savings, credit, and insurance—that meet their needs. It plays a crucial role in economic growth and poverty alleviation, enabling people to manage financial risks, invest in education, and improve livelihoods. According to the World Bank, financial inclusion is “a key enabler for reducing poverty and boosting shared prosperity by providing underserved populations access to essential financial services” (World Bank, 2023).</p>
<p>In Tanzania, financial inclusion is especially important for rural populations, where limited access to traditional banking infrastructure can hinder economic mobility. Many rely on informal financial services, which are often less secure and limit access to broader economic opportunities. Mobile financial services have had a transformative impact across Sub-Saharan Africa, enabling millions to participate in the financial system without needing a physical bank. In Tanzania, mobile money usage has become one of the foundation of financial inclusion, especially in rural and remote areas where mobile access is far more prevalent than traditional banking facilities (World Bank Group, 2024).</p>
<p>However, access to financial services remains uneven, with notable disparities between urban and rural regions. Understanding the factors that drive financial inclusion across various communities in Tanzania is essential to improve access and support inclusive economic growth. This study aims to create a robust dependent variable reflecting financial inclusion using the FinScope dataset, capturing financial engagement through the use of mobile money services.</p>
</section>
<section id="deriving-the-dependent-variable---mobile-money-usage" class="level2">
<h2 class="anchored" data-anchor-id="deriving-the-dependent-variable---mobile-money-usage"><strong>5.2 Deriving The Dependent Variable - Mobile Money Usage</strong></h2>
<p>For this study, mobile money usage is used as a primary indicator of financial inclusion, reflecting the importance of mobile banking in bridging the financial access gap across Tanzania. By focusing on mobile money usage as a core indicator, this study recognizes mobile banking as a primary driver of financial inclusion in Tanzania. Mobile money services enable financial transactions in remote areas, where traditional banking infrastructure is sparse. This approach reflects the integration of mobile financial services into daily life and acknowledges their role in bridging the access gap for underserved communities.</p>
<p>The dependent variable, Mobile Money Usage (MMU), is calculated as follows:</p>
<p><span class="math display">\[MMU_i&nbsp;=&nbsp;\frac{\text{MobileMoneyUsers}_i}{\text{DistrictCount}_i}\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(MobileMoneyUsers_i\)</span> = Number of individuals in district&nbsp;i&nbsp;who use mobile money/banking services.</p></li>
<li><p><span class="math inline">\(DistrictCount​_i\)</span> = Number of total records in that particular district i</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dividing by the total records in each district normalizes the measure of mobile money usage across districts, allowing for a more accurate comparison between areas of different population sizes. Without normalization, districts with larger populations would disproportionately influence the results, making it harder to observe patterns in smaller or more rural areas. A normalized indicator ensures that each district’s financial inclusion level is weighted by its own population, avoiding skewed results.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="dependent-variable-implications" class="level2">
<h2 class="anchored" data-anchor-id="dependent-variable-implications">5.3 Dependent Variable Implications</h2>
<p>Since <em>Mobile Money Users</em> is divided by number of records in the district, it is represented as a percentage or proportion of people that has access to mobile money in that given district.</p>
<ul>
<li><p><strong>Higher MMU Values:</strong> A higher Mobile Money Usage (MMU) value indicates greater financial inclusion within a district, suggesting that a substantial proportion of individuals in that area are using mobile money services. This often reflects improved access to essential financial transactions, enabling individuals to save, transfer funds, and manage payments conveniently. With more people using mobile money, there is likely an increase in financial security and accessibility, allowing residents to participate more actively in the economy. Higher MMU values suggest that individuals in these districts are more empowered to manage financial risks, save for future needs, and potentially invest in small businesses or educational expenses, contributing to overall economic resilience.</p></li>
<li><p><strong>Lower MMU Value:</strong> In contrast, a lower MMU value implies limited mobile money usage within a district, often indicating lower financial inclusion. This can reflect barriers to accessing financial services, such as a lack of digital infrastructure, limited mobile network coverage, or economic challenges that prevent individuals from engaging with mobile money services. Individuals in areas with low MMU values may depend on informal financial mechanisms, which can carry higher risks, less security, and fewer opportunities for economic growth. Low MMU values suggest a need for targeted interventions to address the gaps in financial access, as these populations may be more vulnerable to financial instability, lack of savings, and limited economic opportunities, potentially hindering their capacity to break out of poverty cycles.</p></li>
</ul>
<hr>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>6 Data Wrangling</h1>
<p>In the development of a multiple linear regression model, the selection of appropriate variables is critical to ensuring the model’s accuracy and interpretability. This section focuses on the selection of both categorical and continuous variables that will serve as predictors in our regression analysis.</p>
<p>Initially, we will extract a preliminary set of variables based on theoretical foundations and previous empirical research from the 722 variables of FinScope Tanzania dataset.</p>
<section id="categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="categorical-variables">6.1 Categorical Variables</h2>
<p>We will employ one-hot encoding to transform categorical variables into a format suitable for regression modeling. One-hot encoding allows us to create binary columns for each category, enabling the regression model to assess the impact of each nominal variable effectively. This approach ensures that we capture the distinct effects of categorical factors on the dependent variable while maintaining the integrity of the data.</p>
<p>Before we further prepare our variables (which are in the form of survey questions), we will convert the column names into a more R-friendly format using&nbsp;<code>make.names()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tanzania) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(tanzania))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the following variables and code chunk to one-hot encode all the nominal variables as mentioned above. Some one hot encoded columns will be used to derive continuous variables as well.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Variables and Justification</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 70%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Justification for Selection</strong></th>
<th><strong>Modification</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cluster type</td>
<td>Urban-rural differences may impact access to mobile banking services due to differences in infrastructure, network coverage, and accessibility.</td>
<td><p>Encoded as two columns - ‘Urban’ and ‘Rural’</p>
<p>If respondent indicates ‘urban’, this variable will be 1 and 0 for rural.</p></td>
</tr>
<tr class="even">
<td>Respondent gender</td>
<td>Gender may influence mobile banking adoption, as social and economic factors often create differences in financial access between men and women.</td>
<td>Encoded as two columns - ‘male’ and ‘female’</td>
</tr>
<tr class="odd">
<td>Education Background</td>
<td>Education level may affect the likelihood of adopting mobile banking due to varying levels of digital literacy.</td>
<td>Encoded as eight columns - ‘NoFormalEducation’ and ‘SomePrimary’ and so on</td>
</tr>
<tr class="even">
<td>Access to Mobile Phone and Internet</td>
<td>Directly related to mobile banking, as mobile phones are required to use mobile money and mobile banking services. Internet access can influence mobile banking adoption, particularly for smartphone-based banking services that require internet connectivity.</td>
<td>Encoded as two columns - ‘MobilePhone’ and ‘Internet’ (1 if respondent has access, 0 if not).</td>
</tr>
<tr class="odd">
<td>Mobile Phone’s Connection</td>
<td>The quality of mobile phone connection can impact user experience and satisfaction with mobile banking services. A poor connection may hinder transaction speed, reliability, and user confidence, thus influencing adoption rates. This variable allows for a understanding of barriers to mobile banking use.</td>
<td>Encoded as 4 columns - “NoPhoneConnection” “BadPhoneConnection” “GoodPhoneConnection” “ExcellentPhoneConnection”</td>
</tr>
<tr class="even">
<td>Have 2 or more devices</td>
<td>Ownership of multiple devices may indicate a respondent’s comfort and familiarity with technology, potentially facilitating easier access to mobile banking services. This variable helps to identify tech-savvy users who may be more likely to engage with mobile banking.</td>
<td>Encoded as “Own2Phones”</td>
</tr>
<tr class="odd">
<td>If Phone is smart phone</td>
<td>The type of mobile device, particularly whether it is a smartphone, is significant because smartphones typically offer enhanced capabilities for mobile banking compared to basic phones. They allow access to apps and services that facilitate easier financial transactions, thus influencing mobile banking adoption.</td>
<td>Encoded as “SmartPhone</td>
</tr>
<tr class="even">
<td>Using mobile phone to pay or lottery game</td>
<td>This variable captures the extent to which respondents are already engaging with their mobile phones for financial transactions or gaming. If individuals are using their phones for payments or other financial activities, they may be more inclined to adopt mobile banking services, making this a valuable predictor.</td>
<td>Encoded as “Phone_PayforThings” and “Phone_LotteryGaming”</td>
</tr>
<tr class="odd">
<td>Main Reason the respondent don’t own a phone</td>
<td>Understanding the reasons for not owning a phone provides insight into barriers that may prevent respondents from accessing mobile banking. By encoding various reasons, such as financial constraints or social restrictions, this variable can highlight the nature of mobile banking access challenges and inform targeted interventions to improve financial inclusion.</td>
<td>Encoded as 4 columns - “NoMoneyForPhone” “UseSomeoneElsePhone” “ParentsSpouseDontAllowPhone” “DontNeedPhone”</td>
</tr>
<tr class="even">
<td>Financial Documents owned Bank/MFI Statements</td>
<td>Ownership of bank or MFI statements may indicate financial inclusion and readiness to adopt mobile banking.</td>
<td>Encoded as ‘BankMFIStatement’</td>
</tr>
<tr class="odd">
<td>If Business is registered with government</td>
<td>Owning a registered business can increase the likelihood of using mobile banking for transactions. This variable also reflects formal economic activity, which may correlate with mobile banking usage.</td>
<td>Encoded as two columns - ‘BusinessRegistered_Yes’ and ‘BusinessRegistered_No’</td>
</tr>
<tr class="even">
<td>Coping Mechanisms(What they did when they could not meet spending needs)</td>
<td>Indicates financial behavior and reliance on financial services, which can influence the adoption of mobile banking for emergency needs.</td>
<td>Encoded as 10 columns - ‘UsedSavings’ and ‘BorrowedFromBank’</td>
</tr>
<tr class="odd">
<td>Comfort with Banks</td>
<td>Reflects trust in formal financial institutions, which may correlate with comfort using mobile banking services.</td>
<td>Encoded as ‘ComfortableWithBank_Yes’ and ‘ComfortableWithBank_No’</td>
</tr>
<tr class="even">
<td>Financial Education</td>
<td>Financial literacy can influence the ability to understand and trust mobile banking services.</td>
<td>Encoded as ‘ReceivedFinancialEducation_Yes’ and ‘ReceivedFinancialEducation_No’</td>
</tr>
<tr class="odd">
<td>Confidence in financial institutions</td>
<td>Trust in banks and mobile money may be a predictor of mobile banking adoption.</td>
<td>Encoded as “ConfidentWithBanks” and ‘ConfidentWithPensionFund’ and so on</td>
</tr>
<tr class="even">
<td>If they have borrowed money from any financial institutions</td>
<td>Access to credit services from banks or MFIs can be linked to mobile banking adoption, especially for transactions.</td>
<td>Encoded as binary columns for each financial institution type such as ‘BorrowedFrom_Bank’ and ‘BorrowedFrom_MFI’</td>
</tr>
<tr class="odd">
<td>How often a respondent use the payment type for purchases</td>
<td>Patterns in payment methods can reveal familiarity with financial technology and willingness to adopt mobile-based transactions.</td>
<td>Encoded as binary columns for each payment type such as Used_Cash, Used_ATM, Used_CreditCard and so on.</td>
</tr>
<tr class="even">
<td>Reporting problems regarding financial matters</td>
<td>Access to or barriers in resolving financial issues could impact mobile banking adoption, especially if respondents face challenges that could be solved by mobile services.</td>
<td>Encoded as binary columns such as ‘Do_Not_Know_Where_To_Go’ and ‘Do_Not_Think_They_Care’</td>
</tr>
<tr class="odd">
<td>Confidence and Trust in Insurance Companies</td>
<td>Confidence in formal financial institutions like insurance companies can influence openness to adopting other formal services, including mobile banking.</td>
<td>Encoded as relevant indicators such as Trust_Insurance_Companies</td>
</tr>
<tr class="even">
<td>Issues Accessing Mobile/Online Financial Products</td>
<td>These barriers are directly relevant to mobile banking, as access issues like network failure and agent availability can significantly impact the usability and reliability of mobile money services. If respondents frequently experience these problems, they may be less likely to adopt or rely on mobile banking. Understanding these barriers helps identify structural challenges in mobile banking infrastructure that could hinder financial inclusion efforts.</td>
<td>Encoded as Network_Failure and Agent_Absent and so on</td>
</tr>
<tr class="odd">
<td>Access and relationship with moneylender</td>
<td>Engagement with informal lenders may indicate a lack of access to formal banking, which mobile banking could address.</td>
<td>Encoded as Moneylender_Access and Moneylender_TreatsWell</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tanzania_onehotencoded<span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Urban =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Cluster.type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Urban"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rural =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Cluster.type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Rural"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C9..Respondent.gender.Interviewer.to.observe</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Male"</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C9..Respondent.gender.Interviewer.to.observe</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Female"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoFormalEducation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No formal education"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomePrimary =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some primary"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">PrimaryCompleted =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Primary completed"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostPrimaryTechnicalTraining =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Post primary technical training"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomeSecondary =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some secondary"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">SecondaryCompleted_OLevel =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Secondary competed-O level"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomeUniversityOrHigherEducation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some University or other higher education"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">UniversityOrHigherEducationCompleted =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"University or higher education completed"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">MobilePhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C23..Which.of.the.following.do.you.have.access..to..Mobile.phone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Internet =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C23..Which.of.the.following.do.you.have.access..to..Internet</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoPhoneConnection =</span> <span class="fu">ifelse</span> (<span class="st">`</span><span class="at">C24.3.How.good.is.the.mobile.phone.connection.from.your.home..would.you.say.that...</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"There is no connection"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="at">BadPhoneConnection =</span> <span class="fu">ifelse</span> (<span class="st">`</span><span class="at">C24.3.How.good.is.the.mobile.phone.connection.from.your.home..would.you.say.that...</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"It is bad – calls rarely connect, calls often drop, it is hard to hear what people say"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="at">GoodPhoneConnection =</span> <span class="fu">ifelse</span> (<span class="st">`</span><span class="at">C24.3.How.good.is.the.mobile.phone.connection.from.your.home..would.you.say.that...</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"It is good – calls sometimes drop, sound is often poor, although you can still understand what people say"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="at">ExcellentPhoneConnection =</span> <span class="fu">ifelse</span> (<span class="st">`</span><span class="at">C24.3.How.good.is.the.mobile.phone.connection.from.your.home..would.you.say.that...</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"It is excellent – calls mostly connect, sound is excellent"</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Own2MobilePhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C24.1..Do.you.personally.own.a.mobile.phone.</span><span class="st">`</span><span class="sc">==</span> <span class="st">"2"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">SmartPhone=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C25..Is.your.phone.a.smart.phone.or.a.simple.mobile.phone..Smart.phone</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">Phone_PayforThings =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C25X2..Which.of.these.things.are.you.using..apps.on.your.phone.to.do...Pay.for.things</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Phone_LotteryGaming =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C25X2..Which.of.these.things.are.you.using..apps.on.your.phone.to.do...Lottery..gaming</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoMoneyForPhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C26..What.is.the..main.reason..why.don.t.you.have.a.mobile.phone.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Don’t have enough money/expensive to buy the handset"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">UseSomeoneElsePhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C26..What.is.the..main.reason..why.don.t.you.have.a.mobile.phone.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Use someone else’s phone"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">DontNeedPhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C26..What.is.the..main.reason..why.don.t.you.have.a.mobile.phone.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Don’t want to / Don’t need it"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">ParentSpouseDontAllowPhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C26..What.is.the..main.reason..why.don.t.you.have.a.mobile.phone.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Parents/spouse/other don’t want/allow me to"</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">BankMFIStatement =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Bank.MFI.Statement</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4a.Is.your.business.registered.with.any.government.authority.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4a.Is.your.business.registered.with.any.government.authority.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_HouseholdMember =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..A.household.member</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FamilyMember =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Another.family.member</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Employer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Employer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Bank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Bank</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Microfinance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Microfinance.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SACCOS =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Savings.and.credit.cooperative..SACCOS.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FinancialAdvisor =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Financial.advisor</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FarmersAssociation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Farmers.association</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_BusinessAssociation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Business.association</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SavingsGroup =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Savings.group</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Moneylender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Moneylender.in.community</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_GovernmentOfficial =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Government.official</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_VillageElder =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Village.elder.elder</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_OtherSpecify =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Other.specify</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_NoOne =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..I.do.not.speak.with.anyone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">UsedSavings =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Used.savings</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromBank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.a.bank.MFI.SACCO</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedThroughMM =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.money.through.MM</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromMoneyLender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.money.lender</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromFriendFamily =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.friend.family.community</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">GotAssistanceFromFamily =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Got.assistance.from.family.friends.community..that.I.did.not.need.to.repay.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">SoldLivestock =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Sold.livestock</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">CutSpending =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Cut.spending</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">WorkedMore =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Worked.more</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_CouldntMeetNeeds =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Others</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableWithBank_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.1..You.feel.comfortable.to.go.into.a.bank.or.another.financial.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableWithBank_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.1..You.feel.comfortable.to.go.into.a.bank.or.another.financial.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"FALSE"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">ReceivedFinancialEducation_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.2..You.have.received.some.financial.education.in.your.life</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">ReceivedFinancialEducation_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.2..You.have.received.some.financial.education.in.your.life</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"FALSE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithBanks =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Banks</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMFIs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._MFIs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSACCOs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._SACCOs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Mobile.money.operators</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithPensionFund =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Pension.fund</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSavingsGroups =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Savings.groups.CMGs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithFamilyFriends =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Family.friends</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithUTTs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._UTTs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Bank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Bank</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MFI =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Microfinance.institution.such.as</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SACCO =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..SACCOS</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..A.mobile.money.service.provider</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_PensionFund =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..A.pension.fund</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Employer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Your.employer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_PayBack =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Family.friends.that.you.had.to.pay.back</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_NoPayBack =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Family.friends.that.you.did.not.have.to.pay.back</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SavingsGroup =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Savings.group</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_CommunityLender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Someone.in.the.community.who.lend</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_OtherSource =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Did.you.borrow.money.from.another.source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.1.In.the.past.12.months..how.often.did.you.use.the.Cash.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_ATM_DebitCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.2.In.the.past.12.months..how.often.did.you.use.the.ATM...Debit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.1.In.the.past.12.months..how.often.did.you.use.the.Cash.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a><span class="at">Used_ATM_DebitCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.2.In.the.past.12.months..how.often.did.you.use.the.ATM...Debit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a><span class="at">Used_CreditCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.3.In.the.past.12.months..how.often.did.you.use.the.Credit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a><span class="at">Used_BankTransfer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.4.In.the.past.12.months..how.often.did.you.use.the.Bank.transfer.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a><span class="at">Used_MobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.5.In.the.past.12.months..how.often.did.you.use.the.Mobile.money.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a><span class="at">Used_Cryptocurrency =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.6.In.the.past.12.months..how.often.did.you.use.the.Cryptocurrency.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a><span class="at">Used_QR_Code =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.In.the.past.12.months..how.often.did.you.use.the.QR.code..for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a><span class="at">Used_POS =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.2.In.the.past.12.months..how.often.did.you.use.the.POS.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a><span class="at">Used_LipaNamba =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.3.In.the.past.12.months..how.often.did.you.use.the.Lipa.Namba.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a><span class="at">Used_AZAMPay =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.4.In.the.past.12.months..how.often.did.you.use.the.AZAM.Pay.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Know_Where_To_Go =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..I.do.not.know.where.to.go</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">Places_Not_In_My_Area =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..The.places.are.not.in.my.area</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Think_They_Care =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..I.do.not.think.they.care.about</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>     <span class="at">Trust_Insurance_Companies =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1.3.Please.tell.me.which.of.the.following.you.is.true.for.you...You.trust.insurance.companies.to.pay.out.when.something.does.go.wrong</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">Insurance_Good_Idea =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1.3.Please.tell.me.which.of.the.following.you.is.true.for.you...Insurance.is.a.good.idea.for.everyone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">Have_Insurance_Cover =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Do.you.have.insurance.cover.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">Network_Failure =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Network.failure</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Absent =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.absent.not.available</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_No_Cash_Float =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.didn.t.have.enough.cash.float</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Overcharged =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.overcharged.for.transactions</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lost_Money =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Lost.money</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Requested_PIN =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.wanted.you.to.reveal.your.PIN.number</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_Problems =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Any.other.problem</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_Access =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..You.can.use.or.access.your.moneylender.whenever.you.need.to</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_TreatsWell =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Your.moneylender.always.treats.you.well</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_InfoClear =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Before.you.took.out.a.loan.with.your.moneylender..you.got.as.much.info.as.needed.and.it.was.easy.to.understand</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_NeedsMet =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..The.products.and.services.offered.by.your.moneylender.meets.your.financial.needs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_FeesReasonable =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Your.moneylender.s.fees.and.charges.are.reasonable</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_CustomerSupport =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..You.are.satisfied.with.your.moneylender.s.customer.support</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a><span class="at">FORM_INVESTMENTS =</span> <span class="fu">ifelse</span>(FORM_INVESTMENTS <span class="sc">==</span> <span class="st">"FORM_INVESTMENTS"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">PayingBack_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.2.4..Have.you..in.the.past.12.months..been.paying.back.money.that.you.borrowed.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">PayingBack_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.2.4..Have.you..in.the.past.12.months..been.paying.back.money.that.you.borrowed.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">MobileMoney =</span> <span class="fu">ifelse</span>(Mobile.money <span class="sc">==</span> <span class="st">"MM"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We will ensure these newly encoded variables are numeric format and all NA will be replaced by 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tanzania_onehotencoded <span class="ot">&lt;-</span> tanzania_onehotencoded <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="dv">204</span><span class="sc">:</span><span class="dv">312</span>), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(., <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we will aggregate the one hot encoded variables to group by district since our analysis on district level and not on each respondent level.</p>
<p>The following table explains the code chunk below and how the variables will be grouped.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 83%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>District Level Transformation (Group by)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cluster type</td>
<td>Percentage of Urban for each district ( to reduce multicollinearity in regression as Rural and Urban will add up to 1, we will only choose one out of the two)</td>
</tr>
<tr class="even">
<td>Respondent gender</td>
<td><p>Ratio of Male vs Female (1: equal number, &lt;1: less Male than Female, &gt;1: More Male than Female, 0: No male in this district)</p>
<p>*To reduce multicollinearity, we will not be using the same denominator, number of total respondents in district, as we did in Cluster type.</p></td>
</tr>
<tr class="odd">
<td>Education Background</td>
<td>Ratio of poeple with No Formal Education vs other categories of education fromPrimary ~ University (1: equal number, &lt;1: less people with no formal education than people with some formal education, &gt;1: More people with no formal education than people with some formal education, 0: All respondents have some kind of education in this district; there is no one without)</td>
</tr>
<tr class="even">
<td>Access to Mobile Phone and Internet</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Mobile Phone’s Connection</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Have 2 or more devices</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>If Phone is smart phone</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Using mobile phone to pay or lottery game</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Financial Documents owned</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>If Business is registered with government</td>
<td>Ratio of Registered Businesses vs Not Registered (1: equal number, &lt;1: less Registered Businesses than Not, &gt;1: More Registered Businesses than Not, 0: No registered business in this district)</td>
</tr>
<tr class="odd">
<td>Coping Mechanisms( What they did when they could not meet spending needs)</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Comfort with banks</td>
<td>Ratio of People comfortable with Banks vs Not comfortable (1: equal number, &lt;1: less people comfortable with banks than Not, &gt;1: More people comfortable with banks than Not, 0: No one is comfortable with banks in this district)</td>
</tr>
<tr class="odd">
<td>Financial Education</td>
<td>Ratio of People that received financial education vs No financial education (1: equal number, &lt;1: less people received financial edcation than Not, &gt;1: More people received financial education than Not, 0: No one received financial education in this district)</td>
</tr>
<tr class="even">
<td>Confidence in financial institutions</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>If they have borrowed money from any financial institutions</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>How often a respondent use the payment type for purchases</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Reporting problems regarding financial matters</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Confidence and Trust in Insurance Companies</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Insurance ownership</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Issues accessing mobile/online financial products</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Access and relationship with moneylender</td>
<td>Sum/Count of each category for each district</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>categorical_var <span class="ot">&lt;-</span> tanzania_onehotencoded <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dist_name) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">district_count =</span> <span class="fu">n</span>(),  <span class="co"># total records in each district</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Urban =</span> <span class="fu">ifelse</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(Rural, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(Rural, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    ), <span class="co"># Percentage of Urban</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male_Female_Ratio =</span><span class="fu">sum</span>(Male, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(Female, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of Male to Female in each district</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Registered_YesNo_Ratio =</span><span class="fu">sum</span>(BusinessRegistered_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(BusinessRegistered_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>, <span class="co"># Ratio of Registered Businesses vs Not Registered</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableBank_YesNo_Ratio =</span><span class="fu">sum</span>(ComfortableWithBank_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(ComfortableWithBank_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of Comfortable with Bank vs Not Comfortable</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="at">PayingBack_YesNo_Ratio =</span><span class="fu">sum</span>(PayingBack_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(PayingBack_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of People that currently owes money vs people that does not</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">FinancialEducation_YesNo_Ratio =</span><span class="fu">sum</span>(ReceivedFinancialEducation_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(ReceivedFinancialEducation_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of People Received Financial Education vs No Financial Education</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoEdu_SomeEdu =</span> <span class="fu">sum</span>(NoFormalEducation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">sum</span>(SomePrimary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span><span class="fu">sum</span>(PrimaryCompleted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(PostPrimaryTechnicalTraining, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SomeSecondary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SecondaryCompleted_OLevel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SomeUniversityOrHigherEducation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(UniversityOrHigherEducationCompleted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="co">#Ratio of People Received No Education vs Some Education</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">MobilePhone =</span> <span class="fu">sum</span>(MobilePhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Internet =</span> <span class="fu">sum</span>(Internet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="at">NoPhoneConnection_Some=</span> <span class="fu">sum</span>(NoPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">sum</span>(BadPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span><span class="fu">sum</span>(GoodPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)<span class="sc">+</span><span class="fu">sum</span>(ExcellentPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), <span class="co">#Ratio of People with No connection at all vs Some </span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="at">Own2MobilePhone =</span> <span class="fu">sum</span>(Own2MobilePhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="at">NoPhoneConnection=</span> <span class="fu">sum</span>(NoPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="at">BadPhoneConnection=</span> <span class="fu">sum</span>(BadPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="at">GoodPhoneConnection=</span> <span class="fu">sum</span>(GoodPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="at">ExcellentPhoneConnection=</span> <span class="fu">sum</span>(ExcellentPhoneConnection, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="at">SmartPhone =</span> <span class="fu">sum</span>(SmartPhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="at">Phone_PayforThings =</span> <span class="fu">sum</span>(Phone_PayforThings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="at">Phone_LotteryGaming =</span> <span class="fu">sum</span>(Phone_LotteryGaming, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="at">NoMoneyForPhone =</span> <span class="fu">sum</span>(NoMoneyForPhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="at">UseSomeoneElsePhone =</span> <span class="fu">sum</span>(UseSomeoneElsePhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="at">DontNeedPhone =</span> <span class="fu">sum</span>(DontNeedPhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="at">ParentSpouseDontAllowPhone =</span> <span class="fu">sum</span>(ParentSpouseDontAllowPhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">BankMFIStatement =</span> <span class="fu">sum</span>(BankMFIStatement, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithBanks =</span> <span class="fu">sum</span>(ConfidentWithBanks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMFIs =</span> <span class="fu">sum</span>(ConfidentWithMFIs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSACCOs =</span> <span class="fu">sum</span>(ConfidentWithSACCOs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMobileMoney =</span> <span class="fu">sum</span>(ConfidentWithMobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithPensionFund =</span> <span class="fu">sum</span>(ConfidentWithPensionFund, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSavingsGroups =</span> <span class="fu">sum</span>(ConfidentWithSavingsGroups, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithFamilyFriends =</span> <span class="fu">sum</span>(ConfidentWithFamilyFriends, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithUTTs =</span> <span class="fu">sum</span>(ConfidentWithUTTs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Bank =</span> <span class="fu">sum</span>(BorrowedFrom_Bank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MFI =</span> <span class="fu">sum</span>(BorrowedFrom_MFI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SACCO =</span> <span class="fu">sum</span>(BorrowedFrom_SACCO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MobileMoney =</span> <span class="fu">sum</span>(BorrowedFrom_MobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_PensionFund =</span> <span class="fu">sum</span>(BorrowedFrom_PensionFund, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Employer =</span> <span class="fu">sum</span>(BorrowedFrom_Employer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_PayBack =</span> <span class="fu">sum</span>(BorrowedFrom_Family_PayBack, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_NoPayBack =</span> <span class="fu">sum</span>(BorrowedFrom_Family_NoPayBack, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SavingsGroup =</span> <span class="fu">sum</span>(BorrowedFrom_SavingsGroup, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_CommunityLender =</span> <span class="fu">sum</span>(BorrowedFrom_CommunityLender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_OtherSource =</span> <span class="fu">sum</span>(BorrowedFrom_OtherSource, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="at">BorrowedFrom_MoneyLender =</span> <span class="fu">sum</span>(BorrowedFromMoneyLender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_FriendFamily =</span> <span class="fu">sum</span>(BorrowedFromFriendFamily, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">GotAssistanceFrom_Family =</span> <span class="fu">sum</span>(GotAssistanceFromFamily, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">SoldLivestock =</span> <span class="fu">sum</span>(SoldLivestock, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">CutSpending =</span> <span class="fu">sum</span>(CutSpending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">WorkedMore =</span> <span class="fu">sum</span>(WorkedMore, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">Advice_HouseholdMember =</span> <span class="fu">sum</span>(Advice_HouseholdMember, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FamilyMember =</span> <span class="fu">sum</span>(Advice_FamilyMember, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Employer =</span> <span class="fu">sum</span>(Advice_Employer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Bank =</span> <span class="fu">sum</span>(Advice_Bank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Microfinance =</span> <span class="fu">sum</span>(Advice_Microfinance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SACCOS =</span> <span class="fu">sum</span>(Advice_SACCOS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FinancialAdvisor =</span> <span class="fu">sum</span>(Advice_FinancialAdvisor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FarmersAssociation =</span> <span class="fu">sum</span>(Advice_FarmersAssociation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_BusinessAssociation =</span> <span class="fu">sum</span>(Advice_BusinessAssociation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SavingsGroup =</span> <span class="fu">sum</span>(Advice_SavingsGroup, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Moneylender =</span> <span class="fu">sum</span>(Advice_Moneylender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_GovernmentOfficial =</span> <span class="fu">sum</span>(Advice_GovernmentOfficial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_VillageElder =</span> <span class="fu">sum</span>(Advice_VillageElder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_OtherSpecify =</span> <span class="fu">sum</span>(Advice_OtherSpecify, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_NoOne =</span> <span class="fu">sum</span>(Advice_NoOne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a><span class="at">UsedSavings =</span> <span class="fu">sum</span>(UsedSavings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_CouldntMeetNeeds =</span> <span class="fu">sum</span>(Others_CouldntMeetNeeds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">sum</span>(Used_Cash, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_ATM_DebitCard =</span> <span class="fu">sum</span>(Used_ATM_DebitCard, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_CreditCard =</span> <span class="fu">sum</span>(Used_CreditCard, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_MobileMoney =</span> <span class="fu">sum</span>(Used_MobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cryptocurrency =</span> <span class="fu">sum</span>(Used_Cryptocurrency, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_QR_Code =</span> <span class="fu">sum</span>(Used_QR_Code, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_POS =</span> <span class="fu">sum</span>(Used_POS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_LipaNamba =</span> <span class="fu">sum</span>(Used_LipaNamba, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_AZAMPay =</span> <span class="fu">sum</span>(Used_AZAMPay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Know_Where_To_Go =</span> <span class="fu">sum</span>(Do_Not_Know_Where_To_Go, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Places_Not_In_My_Area =</span> <span class="fu">sum</span>(Places_Not_In_My_Area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Think_They_Care =</span> <span class="fu">sum</span>(Do_Not_Think_They_Care, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Trust_Insurance_Companies =</span> <span class="fu">sum</span>(Trust_Insurance_Companies, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">Insurance_Good_Idea =</span> <span class="fu">sum</span>(Insurance_Good_Idea, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">Have_Insurance_Cover =</span> <span class="fu">sum</span>(Have_Insurance_Cover,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">Network_FailureMM =</span> <span class="fu">sum</span>(Network_Failure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_AbsentMM =</span> <span class="fu">sum</span>(Agent_Absent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_No_Cash_FloatMM =</span> <span class="fu">sum</span>(Agent_No_Cash_Float, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_OverchargedMM =</span> <span class="fu">sum</span>(Agent_Overcharged, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lost_MoneyMM =</span> <span class="fu">sum</span>(Lost_Money, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Requested_PINMM =</span> <span class="fu">sum</span>(Agent_Requested_PIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_ProblemsMM =</span> <span class="fu">sum</span>(Other_Problems, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_Access =</span> <span class="fu">sum</span>(Moneylender_Access, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_TreatsWell =</span> <span class="fu">sum</span>(Moneylender_TreatsWell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_InfoClear =</span> <span class="fu">sum</span>(Moneylender_InfoClear, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_NeedsMet =</span> <span class="fu">sum</span>(Moneylender_NeedsMet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_FeesReasonable =</span> <span class="fu">sum</span>(Moneylender_FeesReasonable, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_CustomerSupport =</span> <span class="fu">sum</span>(Moneylender_CustomerSupport, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a><span class="at">FORM_INVESTMENTS =</span> <span class="fu">sum</span>(FORM_INVESTMENTS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a><span class="at">MobileMoney =</span> <span class="fu">sum</span>(MobileMoney,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="continuous-variables" class="level2">
<h2 class="anchored" data-anchor-id="continuous-variables">6.2 Continuous Variables</h2>
<p>The following are the chosen continuous variables for our initial model:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 83%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Justification for Selection</strong></th>
<th>District Level (Group by)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Age</td>
<td>Age is a critical demographic variable that often influences various socio-economic outcomes. It can affect financial behaviors, access to resources, and the types of assistance individuals might require.</td>
<td>Mean Age at each district</td>
</tr>
<tr class="even">
<td>Amount Owed</td>
<td>The amount of debt an individual holds may influence their adoption of mobile banking, as those with higher financial obligations may seek convenient options for managing and repaying debt. Mobile money services can facilitate easier debt payments and transfers, making mobile banking particularly valuable for financially burdened individuals. Understanding average debt levels in each district can reveal areas where mobile banking may have higher utility due to financial distress.</td>
<td>Mean Amount Owed at each district</td>
</tr>
<tr class="odd">
<td>Money Spent on Betting</td>
<td>Spending on betting, often linked with financial behaviors that may involve digital payments, has a connection to mobile money services, which are frequently used in betting transactions. Understanding the average betting expenditure can provide insights into districts where mobile money usage is integrated into daily financial activities.</td>
<td>Mean Money Spent on Betting at each district</td>
</tr>
</tbody>
</table>
<p>For these three continuous variables, we will prepare the data in the following steps:</p>
<ul>
<li><p>Rename the variables</p></li>
<li><p>Replace NA values with 0, Except for Age</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Age 0 does not make logical sense, Therefore the missing ones will be replaced with the mean_age of the whole dataset excluding NA values which is 39
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(tanzania<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mean_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.67635</code></pre>
</div>
</div></li>
<li><p>Ensure they are in numeric format</p></li>
<li><p>Derive the district level variable</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Age)), <span class="dv">39</span>)),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount_Owed =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(G.<span class="dv">2</span>.<span class="dv">6</span>..Approximately.how.much.money.do.you.owe..in.TZS)), <span class="dv">0</span>)),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount_Betting =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X17c.On.average..how.much.do.you.spend.on.betting.in.a.month.)), <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>continuous_var <span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dist_name) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age =</span> <span class="fu">mean</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_AmountOwed =</span> <span class="fu">mean</span>(Amount_Owed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_AmountBetting =</span> <span class="fu">mean</span>(Amount_Betting, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use <strong><em>left_join</em></strong> to combine the categorical and continuous variable dataframe to derive the final dataframe, using the common column <strong><em>dist_name</em></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tanzania_combined <span class="ot">&lt;-</span> categorical_var <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(continuous_var, <span class="at">by =</span> <span class="st">"dist_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="dependent-variable">6.3 Dependent Variable</h2>
<p>Recall that dependent variable, Mobile Money Usage (MMU) will be calculated as:</p>
<p><span class="math display">\[MMU_i&nbsp;=&nbsp;\frac{\text{MobileMoneyUsers}_i}{\text{DistrictCount}_i}\]</span></p>
<p>Therefore, we create a new column, MMU, in the combined dataframe with the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tanzania_combined<span class="ot">&lt;-</span> tanzania_combined <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MMU =</span> (MobileMoney <span class="sc">/</span> district_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forming-centroids" class="level2">
<h2 class="anchored" data-anchor-id="forming-centroids">6.4 Forming Centroids</h2>
<p>We noted that the geometry column is in MULTIPOLYGON format. For GWR analysis later on, we will need&nbsp;point geometries&nbsp;to represent specific locations. Leaving the geometry as MULTIPOLYGON can negatively affect the GWR analysis, as the model requires precise locations for its local regression estimations.We will use st_centroid to find the centroid points of each district.</p>
<p>To start, we will create a dataframe that includes the geoboundaries by left joining the geospatial dataframe (tanzbound) to the attribute dataframe (tanzania) by using <strong><em>left_join()</em></strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
To perform a left_join(), we must ensure that there is a common column between the two. For our case, the common column is ‘dist_name’ as we have prepared the data in Section 4.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tanzbounds,tanzania_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also save a polygon version for choloropleth map analysis in later sections.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned_polygons <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tanzbounds,tanzania_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
With the following code <strong><em>st_point_on_surface</em></strong> we find the centroids on the joined dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>centroids <span class="ot">&lt;-</span> <span class="fu">st_point_on_surface</span>(tanzania_cleaned<span class="sc">$</span>geometry)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geometry =</span> centroids) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzania_cleaned,<span class="st">"data/rds/tanzania_cleaned"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzania_cleaned"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will visualize the points with <strong>tmap</strong> to ensure they are properly placed (not in water).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tanzbounds) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border.col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(tanzania_cleaned<span class="sc">$</span>geometry) <span class="sc">+</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.03</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Centroids of Districts in Tanzania"</span>, </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"top"</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.size =</span> <span class="fl">0.8</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the map, we have verified that none of the points fall into water and are properly placed. 3 districts: Mafinga, Makambako, and Korogwe are missing since there is no data collected in theses districts for FinScope dataset.</p>
<hr>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1>7 Exploratory Data Analysis (EDA)</h1>
<p>Exploratory Data Analysis (EDA) is a crucial step allowing us to uncover underlying patterns and identify anomalies in our cleaned dataset. EDA not only aids in formulating hypotheses but also guides feature selection and model building, ensuring that the subsequent analysis is robust and meaningful. In this section, we will explore our dataset through descriptive statistics, visualizations, and correlation analysis to derive insights that can inform our understanding of financial inclusion in Tanzania.</p>
<section id="descriptive-statistics-and-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-visualizations">7.1 Descriptive Statistics and Visualizations</h2>
<section id="visualizing-dependent-variable" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-dependent-variable">7.1.1 Visualizing Dependent Variable</h3>
<p>To begin our exploratory data analysis, we will first visualize the distribution of the dependent variable, the Mobile Money Usage (MMU). The histogram created using <code>ggplot2</code> provides a clear representation of how the MMU is distributed across the dataset. By setting the <code>bins</code> to 20, we can observe the frequency of different MMU values, revealing patterns such as skewness or the presence of outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">MMU</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can confirm that the dependent variable MMU is in normal distribution.</p>
<p>Next, we utilize a histogram to visualize Mobile Money Usage (MMU) values across different districts in Tanzania. This visualization effectively highlights disparities in mobile money usage among districts, providing insights into areas where financial inclusion may be particularly high or low.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(dist_name,MMU), <span class="at">y =</span> MMU)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average MMU Values by District"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"District Name"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mobile Money Usage (MMU)"</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram, we see that Meatu with around 25% access to mobile money has the lowest and Ilala with around 95% access to mobile money has the highest access.</p>
</section>
<section id="histogram-plots-of-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="histogram-plots-of-predictor-variables">7.1.2 Histogram Plots of Predictor Variables</h3>
<p>Next we will use the code chunk below to visualize histograms of key predictor variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_Age</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Registered_YesNo_Ratio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Registered_YesNo_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>Male_Female_Ratio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Male_Female_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>Urban <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Urban</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>MobileMoney <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MobileMoney</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>FinancialEducation <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">FinancialEducation_YesNo_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>Mean_AmountBetting <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_AmountBetting</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>Mean_AmountOwed <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_AmountOwed</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>MobilePhone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MobilePhone</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(Age, Registered_YesNo_Ratio, Male_Female_Ratio, Urban, </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>          FinancialEducation, Mean_AmountBetting, Mean_AmountOwed,MobilePhone,</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram, it was noted that some variables are highly skewed. We will apply <span class="math inline">\(log(10+1)\)</span> transformation to normalize variables that has an absolute skewness of 3 or more. The following code chunk was used to check which variables were skewed.</p>
<p>We must use the dataframe without geometry for this task.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>nogeom_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">st_drop_geometry</span>(tanzania_cleaned))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>skew_threshold <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>skewed_vars <span class="ot">&lt;-</span> nogeom_df <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), skewness)) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Skewness =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Variable"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(Skewness) <span class="sc">&gt;</span> skew_threshold)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(skewed_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                Variable Skewness
1        Registered_YesNo_Ratio.Skewness 7.939190
2                 NoEdu_SomeEdu.Skewness 5.191753
3        NoPhoneConnection_Some.Skewness 3.057964
4            Phone_PayforThings.Skewness 3.669470
5      BorrowedFrom_PensionFund.Skewness 5.764491
6  BorrowedFrom_CommunityLender.Skewness 3.021749
7               Advice_Employer.Skewness 6.891396
8                   Advice_Bank.Skewness 5.405322
9           Advice_Microfinance.Skewness 6.731263
10                Advice_SACCOS.Skewness 5.764491
11      Advice_FinancialAdvisor.Skewness 3.195030
12    Advice_FarmersAssociation.Skewness 6.726136
13   Advice_BusinessAssociation.Skewness 5.044916
14          Advice_SavingsGroup.Skewness 3.173397
15           Advice_Moneylender.Skewness 6.731263
16    Advice_GovernmentOfficial.Skewness 4.405674
17          Advice_OtherSpecify.Skewness 4.600732
18           Used_ATM_DebitCard.Skewness 3.400497
19              Used_CreditCard.Skewness 4.909681
20                 Used_QR_Code.Skewness 3.549885
21                     Used_POS.Skewness 4.598958
22              Mean_AmountOwed.Skewness 3.443722
23           Mean_AmountBetting.Skewness 5.153680</code></pre>
</div>
</div>
<p>We will apply <span class="math inline">\(log(10+1)\)</span> transformation to these variables with the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Registered_YesNo_Ratio <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Registered_YesNo_Ratio <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>NoEdu_SomeEdu <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>NoEdu_SomeEdu <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Phone_PayforThings <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Phone_PayforThings <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>BorrowedFrom_PensionFund <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>BorrowedFrom_PensionFund <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_Employer <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_Employer <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_Bank <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_Bank <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_Microfinance <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_Microfinance <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_SACCOS <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_SACCOS <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_FinancialAdvisor <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_FinancialAdvisor <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_FarmersAssociation <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_FarmersAssociation <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_BusinessAssociation <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_BusinessAssociation <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_SavingsGroup <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_SavingsGroup <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_Moneylender <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_Moneylender <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_GovernmentOfficial <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_GovernmentOfficial <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Advice_OtherSpecify <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Advice_OtherSpecify <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Used_ATM_DebitCard <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Used_ATM_DebitCard <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Used_CreditCard <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Used_CreditCard <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Used_QR_Code <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Used_QR_Code <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Used_POS <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Used_POS <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Mean_AmountOwed <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Mean_AmountOwed <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>Mean_AmountBetting <span class="ot">&lt;-</span> <span class="fu">log10</span>(tanzania_cleaned<span class="sc">$</span>Mean_AmountBetting <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">7.2 Correlation Analysis</h2>
<p>Since we have around 80 variables chosen, it is hard to visualize a correlation matrix. Therefore we will display the highly correlated pairs of variables (with absolute correlations greater than 0.8) with the following code chunk. Again we will use the dataframe without geometry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>cor_data <span class="ot">&lt;-</span> nogeom_df <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(MMU,district_count, dist_name, MobileMoney))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>high_correlations <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(cor_matrix) <span class="sc">&gt;</span> <span class="fl">0.8</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>high_cor_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var1 =</span> <span class="fu">rownames</span>(cor_matrix)[high_correlations[, <span class="dv">1</span>]],</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var2 =</span> <span class="fu">colnames</span>(cor_matrix)[high_correlations[, <span class="dv">2</span>]],</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correlation =</span> cor_matrix[high_correlations]</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>high_cor_df <span class="ot">&lt;-</span> high_cor_df <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Var1 <span class="sc">!=</span> Var2) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(high_cor_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the correlation table we will keep and eliminate the following variables:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th>Keep</th>
<th>Eliminate</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Used_MobileMoney</code></td>
<td><code>ConfidentWithMobileMoney</code></td>
<td><code>Used_MobileMoney</code>&nbsp;likely indicates behavior, while&nbsp;<code>ConfidentWithMobileMoney</code>&nbsp;is more attitudinal. Behavior often has a stronger impact in financial inclusion models.</td>
</tr>
<tr class="even">
<td><code>BorrowedFrom_FriendFamily</code></td>
<td><code>CutSpending</code></td>
<td>Borrowing behavior is more directly tied to financial inclusion than cutting expenses, which might be more of a personal decision.</td>
</tr>
<tr class="odd">
<td><code>Advice_FamilyMember</code></td>
<td><code>Used_Cash</code></td>
<td>Family advice could capture unique information on social support or trust, whereas&nbsp;<code>Used_Cash</code>&nbsp;may overlap with other usage variables like mobile money.</td>
</tr>
<tr class="even">
<td><code>GoodPhoneConnection</code></td>
<td><code>Used_Cash</code> (additional instance)</td>
<td>Phone connectivity could be critical for mobile money use, which is essential in financial inclusion contexts.</td>
</tr>
<tr class="odd">
<td><code>Used_MobileMoney</code></td>
<td><code>Used_LipaNamba</code></td>
<td><code>Used_MobileMoney</code>&nbsp;can serve as a broader measure of digital financial inclusion.</td>
</tr>
<tr class="even">
<td><code>MobilePhone</code></td>
<td><code>ExcellentPhoneConnection</code></td>
<td>Having a mobile phone itself is more foundational to financial inclusion than connection quality.</td>
</tr>
<tr class="odd">
<td><code>Trust_Insurance_Companies</code></td>
<td><code>Insurance_Good_Idea</code></td>
<td>Trust is a more robust predictor of willingness to engage with insurance providers.</td>
</tr>
<tr class="even">
<td><code>Moneylender_Access</code></td>
<td><code>Moneylender_FeesReasonable</code></td>
<td>Access to moneylenders may be more indicative of financial reach than opinions on fees, which could be subjective.</td>
</tr>
<tr class="odd">
<td><code>Do_Not_Know_Where_To_Go</code></td>
<td><code>Advice_HouseholdMember</code></td>
<td>Not knowing where to seek financial help may indicate a gap in inclusion more directly than family advice.</td>
</tr>
</tbody>
</table>
<p>The following code excludes the variables from the highly correlated pairs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ConfidentWithMobileMoney"</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CutSpending"</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Advice_FamilyMember"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GoodPhoneConnection"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"WorkedMore"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GotAssistanceFrom_Family"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ExcellentPhoneConnection"</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Trust_Insurance_Companies"</span>,</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Internet"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Phone_PayforThings"</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Network_FailureMM"</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"SmartPhone"</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Used_LipaNamba"</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_FeesReasonable"</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Advice_HouseholdMember"</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Do_Not_Know_Where_To_Go"</span>,</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MobilePhone"</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Insurance_Good_Idea"</span>,</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UsedSavings"</span>,</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NoPhoneConnection_Some"</span>,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Agent_No_Cash_FloatMM"</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_Access"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BorrowedFrom_FriendFamily"</span>,</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BorrowedFrom_Family_PayBack"</span>,</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NoMoneyForPhone"</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Own2MobilePhone"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ConfidentWithBanks"</span>,</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_InfoClear"</span>,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_NeedsMet"</span>,</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_CustomerSupport"</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also conduct a VIF test to confirm correlation after building our first linear regression model later on.</p>
<hr>
</section>
</section>
<section id="multiple-linear-regression" class="level1">
<h1>8 Multiple Linear Regression</h1>
<section id="initial-model" class="level2">
<h2 class="anchored" data-anchor-id="initial-model">8.1 Initial Model</h2>
<p>We will construct our initial model using these derived variables and use summary() to check the initial model’s explanatory power.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>tanzania.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula <span class="ot">&lt;-</span> MMU <span class="sc">~</span> Urban <span class="sc">+</span> Male_Female_Ratio <span class="sc">+</span> Registered_YesNo_Ratio <span class="sc">+</span> ComfortableBank_YesNo_Ratio <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>           PayingBack_YesNo_Ratio <span class="sc">+</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> NoEdu_SomeEdu <span class="sc">+</span> NoPhoneConnection <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>           BadPhoneConnection <span class="sc">+</span> Phone_LotteryGaming <span class="sc">+</span> UseSomeoneElsePhone <span class="sc">+</span> DontNeedPhone <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>           ParentSpouseDontAllowPhone <span class="sc">+</span> BankMFIStatement <span class="sc">+</span> ConfidentWithMFIs <span class="sc">+</span> ConfidentWithSACCOs <span class="sc">+</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>           ConfidentWithFamilyFriends <span class="sc">+</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>           ConfidentWithUTTs <span class="sc">+</span> BorrowedFrom_Bank <span class="sc">+</span> BorrowedFrom_SACCO <span class="sc">+</span> </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>           BorrowedFrom_MobileMoney <span class="sc">+</span> BorrowedFrom_PensionFund <span class="sc">+</span> BorrowedFrom_Employer <span class="sc">+</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>           BorrowedFrom_Family_NoPayBack <span class="sc">+</span> BorrowedFrom_SavingsGroup <span class="sc">+</span> BorrowedFrom_CommunityLender <span class="sc">+</span> </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>           BorrowedFrom_OtherSource <span class="sc">+</span> BorrowedFrom_MoneyLender <span class="sc">+</span> SoldLivestock <span class="sc">+</span> Advice_Employer <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>           Advice_Bank <span class="sc">+</span> Advice_Microfinance <span class="sc">+</span> Advice_SACCOS <span class="sc">+</span> Advice_FinancialAdvisor <span class="sc">+</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>           Advice_FarmersAssociation <span class="sc">+</span> Advice_BusinessAssociation <span class="sc">+</span> Advice_SavingsGroup <span class="sc">+</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>           Advice_Moneylender <span class="sc">+</span> Advice_GovernmentOfficial <span class="sc">+</span> Advice_VillageElder <span class="sc">+</span> Advice_OtherSpecify <span class="sc">+</span> </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>           Advice_NoOne <span class="sc">+</span> Others_CouldntMeetNeeds <span class="sc">+</span> Used_ATM_DebitCard <span class="sc">+</span> Used_CreditCard <span class="sc">+</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>           Used_Cryptocurrency <span class="sc">+</span> Used_QR_Code <span class="sc">+</span> Used_POS <span class="sc">+</span> Used_AZAMPay <span class="sc">+</span> </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>           Places_Not_In_My_Area <span class="sc">+</span> Do_Not_Think_They_Care <span class="sc">+</span> Have_Insurance_Cover <span class="sc">+</span> </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>           Agent_OverchargedMM <span class="sc">+</span> Lost_MoneyMM <span class="sc">+</span> Agent_Requested_PINMM <span class="sc">+</span> Other_ProblemsMM <span class="sc">+</span> </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>           Moneylender_TreatsWell <span class="sc">+</span> FORM_INVESTMENTS <span class="sc">+</span> Mean_Age <span class="sc">+</span> Mean_AmountOwed <span class="sc">+</span> Mean_AmountBetting</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>, <span class="at">data =</span> tanzania_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tanzania.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = formula &lt;- MMU ~ Urban + Male_Female_Ratio + Registered_YesNo_Ratio + 
    ComfortableBank_YesNo_Ratio + PayingBack_YesNo_Ratio + FinancialEducation_YesNo_Ratio + 
    NoEdu_SomeEdu + NoPhoneConnection + BadPhoneConnection + 
    Phone_LotteryGaming + UseSomeoneElsePhone + DontNeedPhone + 
    ParentSpouseDontAllowPhone + BankMFIStatement + ConfidentWithMFIs + 
    ConfidentWithSACCOs + ConfidentWithFamilyFriends + ConfidentWithUTTs + 
    BorrowedFrom_Bank + BorrowedFrom_SACCO + BorrowedFrom_MobileMoney + 
    BorrowedFrom_PensionFund + BorrowedFrom_Employer + BorrowedFrom_Family_NoPayBack + 
    BorrowedFrom_SavingsGroup + BorrowedFrom_CommunityLender + 
    BorrowedFrom_OtherSource + BorrowedFrom_MoneyLender + SoldLivestock + 
    Advice_Employer + Advice_Bank + Advice_Microfinance + Advice_SACCOS + 
    Advice_FinancialAdvisor + Advice_FarmersAssociation + Advice_BusinessAssociation + 
    Advice_SavingsGroup + Advice_Moneylender + Advice_GovernmentOfficial + 
    Advice_VillageElder + Advice_OtherSpecify + Advice_NoOne + 
    Others_CouldntMeetNeeds + Used_ATM_DebitCard + Used_CreditCard + 
    Used_Cryptocurrency + Used_QR_Code + Used_POS + Used_AZAMPay + 
    Places_Not_In_My_Area + Do_Not_Think_They_Care + Have_Insurance_Cover + 
    Agent_OverchargedMM + Lost_MoneyMM + Agent_Requested_PINMM + 
    Other_ProblemsMM + Moneylender_TreatsWell + FORM_INVESTMENTS + 
    Mean_Age + Mean_AmountOwed + Mean_AmountBetting, data = tanzania_cleaned)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.199529 -0.052297 -0.006167  0.047776  0.194935 

Coefficients:
                                 Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)                     1.703e-01  1.789e-01   0.952  0.34395   
Urban                           8.288e-02  6.326e-02   1.310  0.19388   
Male_Female_Ratio               1.990e-02  4.302e-02   0.463  0.64487   
Registered_YesNo_Ratio          4.641e-01  3.089e-01   1.502  0.13691   
ComfortableBank_YesNo_Ratio     1.358e-02  1.176e-02   1.154  0.25183   
PayingBack_YesNo_Ratio          2.668e-01  1.014e-01   2.631  0.01020 * 
FinancialEducation_YesNo_Ratio  3.197e-01  1.173e-01   2.726  0.00787 **
NoEdu_SomeEdu                  -3.252e-01  1.707e-01  -1.905  0.06040 . 
NoPhoneConnection              -1.013e-03  6.168e-03  -0.164  0.86996   
BadPhoneConnection             -4.845e-03  1.789e-03  -2.709  0.00825 **
Phone_LotteryGaming            -1.897e-02  1.407e-02  -1.348  0.18143   
UseSomeoneElsePhone            -1.040e-02  5.622e-03  -1.850  0.06801 . 
DontNeedPhone                  -2.051e-03  1.326e-02  -0.155  0.87750   
ParentSpouseDontAllowPhone     -8.388e-03  6.899e-03  -1.216  0.22765   
BankMFIStatement               -1.061e-02  7.078e-03  -1.499  0.13774   
ConfidentWithMFIs               4.881e-03  5.286e-03   0.923  0.35863   
ConfidentWithSACCOs            -1.893e-03  4.882e-03  -0.388  0.69917   
ConfidentWithFamilyFriends      3.539e-05  1.420e-03   0.025  0.98018   
ConfidentWithUTTs               2.018e-03  5.658e-03   0.357  0.72223   
BorrowedFrom_Bank               9.632e-03  1.498e-02   0.643  0.52205   
BorrowedFrom_SACCO             -3.070e-02  2.190e-02  -1.402  0.16475   
BorrowedFrom_MobileMoney       -1.203e-02  9.981e-03  -1.205  0.23169   
BorrowedFrom_PensionFund        1.494e-01  2.765e-01   0.540  0.59057   
BorrowedFrom_Employer          -1.417e-02  1.201e-02  -1.179  0.24170   
BorrowedFrom_Family_NoPayBack   7.678e-03  8.696e-03   0.883  0.37993   
BorrowedFrom_SavingsGroup      -5.923e-03  4.287e-03  -1.382  0.17088   
BorrowedFrom_CommunityLender   -4.019e-03  8.109e-03  -0.496  0.62154   
BorrowedFrom_OtherSource        3.345e-02  2.990e-02   1.119  0.26655   
BorrowedFrom_MoneyLender        6.019e-03  8.335e-03   0.722  0.47233   
SoldLivestock                   4.284e-03  2.186e-03   1.959  0.05354 . 
Advice_Employer                 1.169e-02  1.216e-01   0.096  0.92365   
Advice_Bank                    -3.471e-01  1.524e-01  -2.278  0.02540 * 
Advice_Microfinance            -8.690e-02  3.041e-01  -0.286  0.77578   
Advice_SACCOS                   4.296e-01  2.564e-01   1.675  0.09775 . 
Advice_FinancialAdvisor        -2.669e-02  2.048e-01  -0.130  0.89665   
Advice_FarmersAssociation      -2.013e-02  1.171e-01  -0.172  0.86398   
Advice_BusinessAssociation      1.708e-01  1.610e-01   1.061  0.29202   
Advice_SavingsGroup             5.898e-02  1.252e-01   0.471  0.63892   
Advice_Moneylender              5.338e-02  2.702e-01   0.198  0.84388   
Advice_GovernmentOfficial      -1.468e-01  1.657e-01  -0.886  0.37836   
Advice_VillageElder            -1.070e-02  2.134e-02  -0.502  0.61738   
Advice_OtherSpecify             1.627e-01  1.393e-01   1.168  0.24627   
Advice_NoOne                    2.012e-03  1.774e-03   1.134  0.26030   
Others_CouldntMeetNeeds        -1.198e-02  1.250e-02  -0.958  0.34073   
Used_ATM_DebitCard              3.949e-02  5.559e-02   0.710  0.47955   
Used_CreditCard                -1.534e-01  6.910e-02  -2.219  0.02930 * 
Used_Cryptocurrency             1.138e-02  2.042e-02   0.557  0.57884   
Used_QR_Code                    1.466e-03  7.760e-02   0.019  0.98497   
Used_POS                        2.552e-02  7.568e-02   0.337  0.73683   
Used_AZAMPay                    5.224e-03  7.326e-03   0.713  0.47782   
Places_Not_In_My_Area           3.276e-03  2.977e-03   1.101  0.27435   
Do_Not_Think_They_Care         -1.521e-04  7.263e-03  -0.021  0.98334   
Have_Insurance_Cover           -1.329e-03  3.674e-03  -0.362  0.71850   
Agent_OverchargedMM            -1.244e-03  7.077e-03  -0.176  0.86089   
Lost_MoneyMM                    7.626e-03  9.855e-03   0.774  0.44131   
Agent_Requested_PINMM           6.410e-03  9.639e-03   0.665  0.50796   
Other_ProblemsMM               -1.187e-02  2.568e-02  -0.462  0.64510   
Moneylender_TreatsWell          1.812e-02  6.048e-03   2.996  0.00364 **
FORM_INVESTMENTS                7.945e-03  7.208e-03   1.102  0.27361   
Mean_Age                        9.222e-03  3.750e-03   2.459  0.01608 * 
Mean_AmountOwed                -1.925e-02  2.832e-02  -0.680  0.49876   
Mean_AmountBetting              3.178e-02  1.153e-02   2.755  0.00727 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0993 on 80 degrees of freedom
Multiple R-squared:  0.761, Adjusted R-squared:  0.5788 
F-statistic: 4.176 on 61 and 80 DF,  p-value: 2.022e-09</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The initial model has an adjusted R-squared value of 0.5788, meaning that approximately 58% of the variation in the Mobile Money Usage (MMU) is explained by these predictors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In multiple linear regression, adjusted R-squared is prioritized over R-squared because it adjusts for the number of predictors in the model, providing a more accurate assessment of model fit. Unlike R-squared, adjusted R-squared penalizes unnecessary predictors, helping to prevent overfitting and offering a more reliable measure of predictive power.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="the-refined-model---stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="the-refined-model---stepwise-regression">8.2 The Refined Model - Stepwise Regression</h2>
<p>In this section, we perform&nbsp;<strong>stepwise regression</strong>&nbsp;for variable selection. This method systematically includes or excludes variables based on specific criteria, such as the Akaike Information Criterion (AIC) or the Bayesian Information Criterion (BIC). Stepwise regression refines the model by retaining only those predictors that significantly contribute to explaining variations in the Financial Inclusion Index, leading to a more parsimonious and interpretable model.</p>
<p>Through this process, the multiple linear regression model is optimized to identify the key factors impacting FPAI while addressing multicollinearity and ensuring model stability. This approach ultimately enhances the model’s explanatory power, enabling more accurate and actionable insights into the drivers of financial inclusion.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Criteria for Variable Selection: Reject p-value greater than alpha value of 0.05
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>We will use the <code>olsrr</code> package to do this. The&nbsp;<code>olsrr</code>&nbsp;package in R provides a streamlined process for diagnosing multicollinearity issues, performing variable selection, and generating organized model assessment reports. This stage is critical for refining our initial model, ensuring each retained variable significantly contributes to explaining the dependent variable, the FPAI.</p>
<p>Since p value is our defined criteria, we use <strong><em>ols_step_forward_p()</em></strong> as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tanzania_vs_mlr <span class="ot">&lt;-</span> <span class="fu">ols_step_forward_p</span>(tanzania.mlr, <span class="at">p_val=</span> <span class="fl">0.05</span>, <span class="at">details=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>The stepwise regression analysis streamlined the initial variable set to 12 significant predictors, as illustrated in the accompanying plots. This selection process resulted in an increase in the model’s adjusted R-squared value, which increased from 0.5788 in the initial model to 0.625 in the final model. <strong>It suggests a greater proportion of the variance in the Mobile Money Usage (MMU), namely 62.5%, explained by the chosen predictors.</strong></p>
<p>The final model with the final variables selected by stepwise regression is shown below.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>MMU ~ Urban + ComfortableBank_YesNo_Ratio + Mean_Age + Mean_AmountBetting + 
    BadPhoneConnection + PayingBack_YesNo_Ratio + FinancialEducation_YesNo_Ratio + 
    Moneylender_TreatsWell + Advice_Bank + Do_Not_Think_They_Care + 
    Advice_SACCOS + Registered_YesNo_Ratio + Used_CreditCard
&lt;environment: 0x151cdd110&gt;</code></pre>
</div>
</div>
</section>
<section id="variable-selected" class="level2">
<h2 class="anchored" data-anchor-id="variable-selected">8.3 Variable Selected</h2>
<p>Lastly, we will use the <strong><em>tbl_regression()</em></strong> from <em>gtsummary</em> package which helps us to create a publication-ready summary table in R.</p>
<p><u><em>Results of Multiple Linear Regression for Impact of Selected Variables on Moblie Money Usage (MMU)</em></u></p>
<div class="cell">
<div class="cell-output-display">
<div id="uwjrkmcvxz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uwjrkmcvxz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uwjrkmcvxz thead, #uwjrkmcvxz tbody, #uwjrkmcvxz tfoot, #uwjrkmcvxz tr, #uwjrkmcvxz td, #uwjrkmcvxz th {
  border-style: none;
}

#uwjrkmcvxz p {
  margin: 0;
  padding: 0;
}

#uwjrkmcvxz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uwjrkmcvxz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uwjrkmcvxz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uwjrkmcvxz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uwjrkmcvxz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwjrkmcvxz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwjrkmcvxz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uwjrkmcvxz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uwjrkmcvxz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uwjrkmcvxz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uwjrkmcvxz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uwjrkmcvxz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uwjrkmcvxz .gt_spanner_row {
  border-bottom-style: hidden;
}

#uwjrkmcvxz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uwjrkmcvxz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uwjrkmcvxz .gt_from_md > :first-child {
  margin-top: 0;
}

#uwjrkmcvxz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uwjrkmcvxz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uwjrkmcvxz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uwjrkmcvxz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uwjrkmcvxz .gt_row_group_first td {
  border-top-width: 2px;
}

#uwjrkmcvxz .gt_row_group_first th {
  border-top-width: 2px;
}

#uwjrkmcvxz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwjrkmcvxz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uwjrkmcvxz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uwjrkmcvxz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwjrkmcvxz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwjrkmcvxz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uwjrkmcvxz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uwjrkmcvxz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uwjrkmcvxz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uwjrkmcvxz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwjrkmcvxz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwjrkmcvxz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uwjrkmcvxz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uwjrkmcvxz .gt_left {
  text-align: left;
}

#uwjrkmcvxz .gt_center {
  text-align: center;
}

#uwjrkmcvxz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uwjrkmcvxz .gt_font_normal {
  font-weight: normal;
}

#uwjrkmcvxz .gt_font_bold {
  font-weight: bold;
}

#uwjrkmcvxz .gt_font_italic {
  font-style: italic;
}

#uwjrkmcvxz .gt_super {
  font-size: 65%;
}

#uwjrkmcvxz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uwjrkmcvxz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uwjrkmcvxz .gt_indent_1 {
  text-indent: 5px;
}

#uwjrkmcvxz .gt_indent_2 {
  text-indent: 10px;
}

#uwjrkmcvxz .gt_indent_3 {
  text-indent: 15px;
}

#uwjrkmcvxz .gt_indent_4 {
  text-indent: 20px;
}

#uwjrkmcvxz .gt_indent_5 {
  text-indent: 25px;
}

#uwjrkmcvxz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uwjrkmcvxz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipCZXRhKio=&quot;><div class='gt_from_md'><p><strong>Beta</strong></p>
</div></div>"><div data-qmd-base64="KipCZXRhKio="><div class="gt_from_md"><p><strong>Beta</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;Kio5NSUgQ0kqKg==&quot;><div class='gt_from_md'><p><strong>95% CI</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="Kio5NSUgQ0kqKg=="><div class="gt_from_md"><p><strong>95% CI</strong></p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipwLXZhbHVlKio=&quot;><div class='gt_from_md'><p><strong>p-value</strong></p>
</div></div>"><div data-qmd-base64="KipwLXZhbHVlKio="><div class="gt_from_md"><p><strong>p-value</strong></p>
</div></div></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">0.0843</td>
<td headers="conf.low" class="gt_row gt_center">-0.1254, 0.2940</td>
<td headers="p.value" class="gt_row gt_center">0.4</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Urban</td>
<td headers="estimate" class="gt_row gt_center">0.1149</td>
<td headers="conf.low" class="gt_row gt_center">0.0356, 0.1942</td>
<td headers="p.value" class="gt_row gt_center">0.005</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ComfortableBank_YesNo_Ratio</td>
<td headers="estimate" class="gt_row gt_center">0.0264</td>
<td headers="conf.low" class="gt_row gt_center">0.0096, 0.0433</td>
<td headers="p.value" class="gt_row gt_center">0.002</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Mean_Age</td>
<td headers="estimate" class="gt_row gt_center">0.0094</td>
<td headers="conf.low" class="gt_row gt_center">0.0044, 0.0144</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Mean_AmountBetting</td>
<td headers="estimate" class="gt_row gt_center">0.0313</td>
<td headers="conf.low" class="gt_row gt_center">0.0159, 0.0468</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">BadPhoneConnection</td>
<td headers="estimate" class="gt_row gt_center">-0.0034</td>
<td headers="conf.low" class="gt_row gt_center">-0.0059, -0.0010</td>
<td headers="p.value" class="gt_row gt_center">0.007</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PayingBack_YesNo_Ratio</td>
<td headers="estimate" class="gt_row gt_center">0.1831</td>
<td headers="conf.low" class="gt_row gt_center">0.0430, 0.3232</td>
<td headers="p.value" class="gt_row gt_center">0.011</td></tr>
    <tr><td headers="label" class="gt_row gt_left">FinancialEducation_YesNo_Ratio</td>
<td headers="estimate" class="gt_row gt_center">0.2741</td>
<td headers="conf.low" class="gt_row gt_center">0.1239, 0.4243</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Moneylender_TreatsWell</td>
<td headers="estimate" class="gt_row gt_center">0.0118</td>
<td headers="conf.low" class="gt_row gt_center">0.0047, 0.0188</td>
<td headers="p.value" class="gt_row gt_center">0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Advice_Bank</td>
<td headers="estimate" class="gt_row gt_center">-0.3851</td>
<td headers="conf.low" class="gt_row gt_center">-0.5748, -0.1954</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Do_Not_Think_They_Care</td>
<td headers="estimate" class="gt_row gt_center">0.0111</td>
<td headers="conf.low" class="gt_row gt_center">0.0024, 0.0198</td>
<td headers="p.value" class="gt_row gt_center">0.013</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Advice_SACCOS</td>
<td headers="estimate" class="gt_row gt_center">0.4847</td>
<td headers="conf.low" class="gt_row gt_center">0.1027, 0.8668</td>
<td headers="p.value" class="gt_row gt_center">0.013</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Registered_YesNo_Ratio</td>
<td headers="estimate" class="gt_row gt_center">0.4829</td>
<td headers="conf.low" class="gt_row gt_center">0.0885, 0.8773</td>
<td headers="p.value" class="gt_row gt_center">0.017</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Used_CreditCard</td>
<td headers="estimate" class="gt_row gt_center">-0.0831</td>
<td headers="conf.low" class="gt_row gt_center">-0.1657, -0.0004</td>
<td headers="p.value" class="gt_row gt_center">0.049</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><div data-qmd-base64="UsKyID0gMC42NjA7IEFkanVzdGVkIFLCsiA9IDAuNjI1OyBBSUMgPSAtMjU0OyBTdGF0aXN0aWMgPSAxOS4xOyBwLXZhbHVlID0gPDAuMDAxOyDPgyA9IDAuMDk0"><div class="gt_from_md"><p>R² = 0.660; Adjusted R² = 0.625; AIC = -254; Statistic = 19.1; p-value = &lt;0.001; σ = 0.094</p>
</div></div></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><div class="gt_from_md"><p>CI = Confidence Interval</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Interpretation of Model Results:</p>
<ul>
<li><p><strong>Intercept (β = 0.0843)</strong>: The intercept represents the baseline level of financial participation when all other predictors are at zero. A positive but non-significant intercept suggests that financial participation would remain low if no other variables provided a positive influence, indicating limited financial engagement under baseline conditions.</p></li>
<li><p><strong>Urban (β = 0.1149)</strong>: Living in an urban area is positively associated with financial participation, likely due to better access to financial services and institutions in urban settings. The effect is moderate and statistically significant, indicating that urban residents tend to have higher financial access compared to rural counterparts.</p></li>
<li><p><strong>ComfortableBank_YesNo_Ratio (β = 0.0264)</strong>: This positive effect shows that individuals who feel comfortable using banks are more likely to engage in mobile banking activities. It highlights the importance of trust in financial institutions for financial participation.</p></li>
<li><p><strong>Mean_Age (β = 0.0094)</strong>: There’s a small positive association between age and financial participation, suggesting that older individuals may have higher access to mobile banking, potentially due to greater wealth accumulation or financial experience over time.</p></li>
<li><p><strong>Mean_AmountBetting (β = 0.0313)</strong>: A positive association with financial participation indicates that individuals who bet more may also be more financially active, possibly due to a greater tendency to take risks or engage in diverse financial behaviors.</p></li>
<li><p><strong>BadPhoneConnection (β = -0.0034)</strong>: A poor phone connection has a small but significant negative effect on mobile banking, indicating that connectivity challenges may hinder access to mobile-based financial services, which are critical in many regions.</p></li>
<li><p><strong>PayingBack_YesNo_Ratio (β = 0.1831)</strong>: This variable has a strong positive association with financial participation, suggesting that individuals who are currently paying back loans may be using mobile banking and thus increased access to financial resources.</p></li>
<li><p><strong>FinancialEducation_YesNo_Ratio (β = 0.2741)</strong>: A significant positive effect of financial education on participation implies that financial literacy promotes engagement with financial products, as educated individuals are likely to feel more confident in managing finances.</p></li>
<li><p><strong>Moneylender_TreatsWell (β = 0.0118)</strong>: The positive coefficient indicates that favorable experiences with moneylenders correlate with higher financial participation, possibly due to increased trust in these informal lending sources.</p></li>
<li><p><strong>Advice_Bank (β = -0.3851)</strong>: A strong negative effect, suggesting that relying on banks for financial advice is associated with lower financial participation and participation in mobile banking. This may reflect distrust in formal financial institutions or a lack of accessible, personalized advice from banks.</p></li>
<li><p><strong>Do_Not_Think_They_Care (β = 0.0111)</strong>: This small positive association suggests that individuals who believe financial institutions do not care about them are slightly more likely to engage in mobile banking activities, underscoring the role of perceived institutional support in financial inclusion.</p></li>
<li><p><strong>Advice_SACCOS (β = 0.4847)</strong>: The positive effect indicates that those who receive financial advice from SACCOs (Savings and Credit Cooperative Organizations) are more engaged in financial and mobile money activities, likely due to SACCOs’ community-based approach and support.</p></li>
<li><p><strong>Registered_YesNo_Ratio (β = 0.4829)</strong>: This positive association implies that individuals with formal registered businesses are more likely to participate in mobile banking, likely because they meet formal requirements for accessing financial services.</p></li>
<li><p><strong>Used_CreditCard (β = -0.0831)</strong>: The negative association suggests that individuals who use credit cards may have lower usage of mobile money, potentially due to reliance on this form of credit or barriers to other financial products.</p></li>
</ul>
<p>The predictors, especially those with larger positive coefficients like&nbsp;<strong>Registered_YesNo_Ratio</strong>&nbsp;(0.4829) and&nbsp;<strong>FinancialEducation_YesNo_Ratio</strong>&nbsp;(0.2741), reveal impactful areas where improvements could directly boost MMU and financial inclusion. Similarly, variables with negative coefficients, like&nbsp;<strong>Advice_Bank</strong>&nbsp;(-0.3851) and <strong>BadPhoneConnection</strong> (-0.0034<strong>)</strong>, suggest barriers that significantly limits access to financial products and would require attention to enhance inclusion.</p>
</section>
<section id="model-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnostics">8.4 Model Diagnostics</h2>
<section id="multicollinearity---vif" class="level3">
<h3 class="anchored" data-anchor-id="multicollinearity---vif"><strong>8.4.1 Multicollinearity - VIF</strong></h3>
<p>Given the large number of variables and low Adjusted R-squared, multicollinearity becomes a concern. High Variance Inflation Factor (VIF) scores indicate that some variables may be highly correlated with one another, which can distort the model’s estimates and inflate standard errors. By calculating the VIF for each predictor, we can identify those with excessive multicollinearity—typically with VIF values above 10, suggesting that they should be either removed or consolidated to improve model stability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(final_tanzania.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Variables Tolerance      VIF
1                           Urban 0.5391961 1.854613
2     ComfortableBank_YesNo_Ratio 0.8278066 1.208012
3                        Mean_Age 0.8853934 1.129441
4              Mean_AmountBetting 0.7942952 1.258978
5              BadPhoneConnection 0.7228062 1.383497
6          PayingBack_YesNo_Ratio 0.8077738 1.237970
7  FinancialEducation_YesNo_Ratio 0.6237903 1.603103
8          Moneylender_TreatsWell 0.8842631 1.130885
9                     Advice_Bank 0.4909498 2.036868
10         Do_Not_Think_They_Care 0.6649623 1.503845
11                  Advice_SACCOS 0.6677164 1.497642
12         Registered_YesNo_Ratio 0.5915445 1.690490
13                Used_CreditCard 0.6820998 1.466061</code></pre>
</div>
</div>
<p>After stepwise regression and significant variables were selected, we can see that there is no VIF greater than 10, indicating no multicollinearity is present in our refined model. This is expect since multicollinearity was not present in the initial model before stepwise regression as well.</p>
</section>
<section id="test-for-non-linearity" class="level3">
<h3 class="anchored" data-anchor-id="test-for-non-linearity">8.4.2 Test for Non Linearity</h3>
<p>Testing for non-linearity assesses whether the relationship between the predictor variables and the FPAI deviates from a straight line, as linear regression assumes a linear relationship. If non-linearity is present, the residuals will show systematic patterns rather than a random scatter. Testing for non-linearity ensures that the model captures the true relationships within the data and improves predictive accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit</span>(tanzania_vs_mlr<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can confirm that residuals are non linear.</p>
</section>
<section id="test-for-normality-assumption" class="level3">
<h3 class="anchored" data-anchor-id="test-for-normality-assumption">8.4.3 Test for Normality Assumption</h3>
<p>The normality assumption in linear regression pertains to the distribution of residuals, not the predictor variables. Residuals should follow a normal distribution for valid inference in terms of hypothesis testing and confidence intervals. If residuals are not normally distributed, transformations or robust regression techniques may be needed to satisfy the assumption, ensuring reliable and accurate estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_hist</span>(tanzania_vs_mlr<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can confirm that residuals are normally distributed.</p>
</section>
<section id="test-for-spatial-autocorrelation" class="level3">
<h3 class="anchored" data-anchor-id="test-for-spatial-autocorrelation">8.4.4 Test for Spatial Autocorrelation</h3>
<p>Testing for spatial autocorrelation is crucial when working with geographically clustered data, as it assesses whether residuals are correlated across spatial locations. Spatial autocorrelation implies that observations close in space may influence each other, violating the independence assumption in linear regression. Moran’s I statistic will be used to detect spatial autocorrelation in residuals.</p>
<p>First we will extract the residuals from the model and name this column as VS_ MLR_RES with the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mlr_output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tanzania_vs_mlr<span class="sc">$</span>model<span class="sc">$</span>residuals)<span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="st">'VS_MLR_RES'</span> <span class="ot">=</span> <span class="st">'tanzania_vs_mlr$model$residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we will use <strong>cbind</strong> (since there is no unique identifier) to join the newly created dataframe of residuals with our point feature data.frame, tanzania_cleaned_polygons, to plot the distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned_polygons <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tanzania_cleaned_polygons,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                         mlr_output<span class="sc">$</span>VS_MLR_RES) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="st">'MLR_RES'</span><span class="ot">=</span><span class="st">'mlr_output.VS_MLR_RES'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will visualize the MLR residual values in a choloropleth map as follows.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The map displays the spatial distribution of residuals from our multiple linear regression model across various districts in Tanzania. Each dot represents a point in the dataset, colored based on quantiles of residual values, ranging from low residuals (dark red) to high residuals (dark green). Negative residuals (red to yellow shades) suggest areas where the model underestimates the observed values, while positive residuals (yellow to green shades) indicate overestimations.</p>
<p>Clusters of similar residual values are visible in several regions. For instance, areas in the eastern parts of Tanzania show concentrations of positive residuals, whereas some <strong>central</strong> (Manyoni, Sikonge,Urambo) and <strong>northern regions</strong> (Karagwe,Ngara) display clusters of negative residuals. These clusters suggest spatial patterns in the model’s performance, indicating that it may overestimate or underestimate values systematically in specific areas.</p>
<section id="spatially-stationary-test" class="level4">
<h4 class="anchored" data-anchor-id="spatially-stationary-test">8.4.4.1 Spatially Stationary Test</h4>
<p>To determine whether similar or dissimilar values are clustered in space, we will conduct a Global Moran’s I test. This test will allow us to measure the degree of spatial autocorrelation in the data. If the residuals from the model are spatially independent, Moran’s I should indicate no significant spatial autocorrelation.</p>
<p>The hypotheses for this test are as follows:</p>
<ul>
<li><strong>Null Hypothesis (H0):</strong> The distribution of FPAI residuals is spatially independent, meaning there is no spatial pattern (random distribution).</li>
<li><strong>Alternative Hypothesis (H1):</strong> There is spatial dependence in the FPAI residuals, suggesting that similar values are spatially clustered or dispersed.</li>
</ul>
<p>A 95% confidence level will be used to evaluate significance (alpha level of 0.05).</p>
<p>To perform the Global Moran’s I test, we will first compute distance-based weights using <code>st_knn</code> to determine nearest neighbors and <code>st_weights</code> to assign weights based on these distances. This setup will provide the foundation for assessing spatial autocorrelation in the residuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">nb =</span> <span class="fu">st_knn</span>(geometry, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">longlat=</span> <span class="cn">FALSE</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">wt =</span> <span class="fu">st_weights</span>(nb,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">'W'</span>),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are ready to perform Global Moran I with 100 simulations using <strong><em>global_moran_perm.</em></strong> We will first set.seed tomake the random number generation deterministic, allowing us to get the same results every time this code is ran.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(tanzania_cleaned<span class="sc">$</span>MLR_RES,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                  tanzania_cleaned<span class="sc">$</span>nb,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                  tanzania_cleaned<span class="sc">$</span>wt,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.093571, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Since the p-value is much smaller than our significance level of 0.05, we <strong>reject the null hypothesis</strong>. This indicates that the residuals are not randomly distributed but instead exhibit clustering, suggesting spatial dependence. To further explore this spatial dependence in Mobile Money Usage(MMU) across districts in Tanzania, we will proceed with a geographically weighted linear regression (GWR) analysis. This approach will help us understand how the relationship between financial inclusion and its predictors varies across different locations.</p>
<hr>
</section>
</section>
</section>
</section>
<section id="geographically-weighted-linear-regression" class="level1">
<h1>9 Geographically Weighted Linear Regression</h1>
<section id="adaptive-bandwidth" class="level2">
<h2 class="anchored" data-anchor-id="adaptive-bandwidth">9.1 Adaptive Bandwidth</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(<span class="at">formula =</span> MMU <span class="sc">~</span> Urban <span class="sc">+</span> ComfortableBank_YesNo_Ratio <span class="sc">+</span> Mean_Age <span class="sc">+</span> Mean_AmountBetting <span class="sc">+</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    BadPhoneConnection <span class="sc">+</span> PayingBack_YesNo_Ratio <span class="sc">+</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    Moneylender_TreatsWell <span class="sc">+</span> Advice_Bank <span class="sc">+</span> Do_Not_Think_They_Care <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    Advice_SACCOS <span class="sc">+</span> Registered_YesNo_Ratio <span class="sc">+</span> Used_CreditCard,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> tanzania_cleaned, </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">approach=</span><span class="st">"CV"</span>, </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">kernel=</span><span class="st">"gaussian"</span>, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adaptive bandwidth: 95 CV score: 1.359257 
Adaptive bandwidth: 67 CV score: 1.359526 
Adaptive bandwidth: 114 CV score: 1.363338 
Adaptive bandwidth: 85 CV score: 1.359637 
Adaptive bandwidth: 103 CV score: 1.360108 
Adaptive bandwidth: 91 CV score: 1.359477 
Adaptive bandwidth: 98 CV score: 1.360422 
Adaptive bandwidth: 93 CV score: 1.360228 
Adaptive bandwidth: 96 CV score: 1.359983 
Adaptive bandwidth: 94 CV score: 1.359824 
Adaptive bandwidth: 95 CV score: 1.359257 </code></pre>
</div>
</div>
<p>The adaptive bandwidth values control the number of neighboring points included in each localized regression. Each bandwidth produced a Cross-Validation (CV) score, with lower scores indicating a better model fit. Here, an adaptive bandwidth of 95 neighbors provided the lowest CV score (1.359257), suggesting it best balances model accuracy with spatial variability across the regions studied.</p>
</section>
<section id="gwr-model" class="level2">
<h2 class="anchored" data-anchor-id="gwr-model">9.2 GWR Model</h2>
<p>Then we compute the GWR based on this bandwidth of 95 neighbors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> MMU <span class="sc">~</span> Urban <span class="sc">+</span> ComfortableBank_YesNo_Ratio <span class="sc">+</span> Mean_Age <span class="sc">+</span> Mean_AmountBetting <span class="sc">+</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>    BadPhoneConnection <span class="sc">+</span> PayingBack_YesNo_Ratio <span class="sc">+</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    Moneylender_TreatsWell <span class="sc">+</span> Advice_Bank <span class="sc">+</span> Do_Not_Think_They_Care <span class="sc">+</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    Advice_SACCOS <span class="sc">+</span> Registered_YesNo_Ratio <span class="sc">+</span> Used_CreditCard,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> tanzania_cleaned, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>gwr_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-07 13:04:34.293031 
   Call:
   gwr.basic(formula = MMU ~ Urban + ComfortableBank_YesNo_Ratio + 
    Mean_Age + Mean_AmountBetting + BadPhoneConnection + PayingBack_YesNo_Ratio + 
    FinancialEducation_YesNo_Ratio + Moneylender_TreatsWell + 
    Advice_Bank + Do_Not_Think_They_Care + Advice_SACCOS + Registered_YesNo_Ratio + 
    Used_CreditCard, data = tanzania_cleaned, bw = bw_adaptive, 
    kernel = "gaussian", adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable:  MMU
   Independent variables:  Urban ComfortableBank_YesNo_Ratio Mean_Age Mean_AmountBetting BadPhoneConnection PayingBack_YesNo_Ratio FinancialEducation_YesNo_Ratio Moneylender_TreatsWell Advice_Bank Do_Not_Think_They_Care Advice_SACCOS Registered_YesNo_Ratio Used_CreditCard
   Number of data points: 142
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
      Min        1Q    Median        3Q       Max 
-0.234523 -0.058602  0.002197  0.064349  0.252286 

   Coefficients:
                                   Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)                     0.084295   0.105985   0.795 0.427884    
   Urban                           0.114939   0.040080   2.868 0.004836 ** 
   ComfortableBank_YesNo_Ratio     0.026421   0.008518   3.102 0.002367 ** 
   Mean_Age                        0.009428   0.002520   3.741 0.000275 ***
   Mean_AmountBetting              0.031325   0.007810   4.011 0.000102 ***
   BadPhoneConnection             -0.003431   0.001240  -2.766 0.006506 ** 
   PayingBack_YesNo_Ratio          0.183052   0.070805   2.585 0.010850 *  
   FinancialEducation_YesNo_Ratio  0.274112   0.075927   3.610 0.000438 ***
   Moneylender_TreatsWell          0.011756   0.003571   3.292 0.001286 ** 
   Advice_Bank                    -0.385100   0.095880  -4.016 0.000100 ***
   Do_Not_Think_They_Care          0.011081   0.004412   2.511 0.013274 *  
   Advice_SACCOS                   0.484732   0.193080   2.511 0.013301 *  
   Registered_YesNo_Ratio          0.482927   0.199324   2.423 0.016800 *  
   Used_CreditCard                -0.083065   0.041767  -1.989 0.048858 *  

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 0.09364 on 128 degrees of freedom
   Multiple R-squared:  0.66
   Adjusted R-squared: 0.6254 
   F-statistic: 19.11 on 13 and 128 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 1.122394
   Sigma(hat): 0.08953827
   AIC:  -254.353
   AICc:  -250.5435
   BIC:  -277.6782
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 95 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                        Min.    1st Qu.     Median    3rd Qu.
   Intercept                       0.0024397  0.0151368  0.0657616  0.1244325
   Urban                           0.0972698  0.1029681  0.1144813  0.1230138
   ComfortableBank_YesNo_Ratio     0.0242926  0.0250739  0.0263692  0.0274140
   Mean_Age                        0.0081776  0.0087924  0.0098121  0.0106637
   Mean_AmountBetting              0.0272839  0.0281781  0.0310304  0.0342018
   BadPhoneConnection             -0.0036780 -0.0034616 -0.0032737 -0.0031668
   PayingBack_YesNo_Ratio          0.1303799  0.1441565  0.1824606  0.2293617
   FinancialEducation_YesNo_Ratio  0.2560450  0.2693637  0.2862596  0.2974368
   Moneylender_TreatsWell          0.0107185  0.0112226  0.0118736  0.0123978
   Advice_Bank                    -0.4066164 -0.3923835 -0.3659927 -0.3531177
   Do_Not_Think_They_Care          0.0106830  0.0109336  0.0113517  0.0114650
   Advice_SACCOS                   0.4242574  0.4350353  0.4871346  0.5362002
   Registered_YesNo_Ratio          0.3795064  0.4222253  0.4528071  0.5088361
   Used_CreditCard                -0.0868426 -0.0856401 -0.0817866 -0.0803661
                                     Max.
   Intercept                       0.1540
   Urban                           0.1319
   ComfortableBank_YesNo_Ratio     0.0278
   Mean_Age                        0.0109
   Mean_AmountBetting              0.0354
   BadPhoneConnection             -0.0031
   PayingBack_YesNo_Ratio          0.2437
   FinancialEducation_YesNo_Ratio  0.3023
   Moneylender_TreatsWell          0.0128
   Advice_Bank                    -0.3339
   Do_Not_Think_They_Care          0.0117
   Advice_SACCOS                   0.5705
   Registered_YesNo_Ratio          0.5257
   Used_CreditCard                -0.0798
   ************************Diagnostic information*************************
   Number of data points: 142 
   Effective number of parameters (2trace(S) - trace(S'S)): 22.11386 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 119.8861 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): -252.0175 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): -279.1281 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): -347.8753 
   Residual sum of squares: 1.022093 
   R-square value:  0.6903413 
   Adjusted R-square value:  0.6327421 

   ***********************************************************************
   Program stops at: 2024-11-07 13:04:34.302975 </code></pre>
</div>
</div>
<p>The comparison between the results of the global regression and Geographically Weighted Regression (GWR) reveals a significant improvement in model fit with GWR. The adjusted R-squared for the global regression stands at 0.6254, indicating that approximately 62.54% of the variance in the financial participation index (FPAI) is explained by the predictors. In contrast, <strong>the GWR model exhibits a substantially higher adjusted R-squared value of 0.6327, suggesting that about 63.27% of the variance is explained.</strong> This increase of approximately 0.73 percentage points indicates that GWR captures local variations and spatial heterogeneity slightly more effectively than the global model, highlighting the importance of accounting for geographical differences in understanding factors influencing access to Mobile Money/Banking.</p>
</section>
<section id="visualizing-gwr-output" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-gwr-output">9.3 Visualizing GWR Output</h2>
<p>To visualize the GWR output, we first convert the GWR output spatial data frame (SDF) into a standard&nbsp;<code>sf</code>&nbsp;data frame. In this step, we extract the relevant information from the GWR output while excluding the intercept found in column number 1. The code snippet for this operation is as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  gwr_adaptive<span class="sc">$</span>SDF)<span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we combine the cleaned Tanzania dataset with the GWR output to create a new spatial data frame,&nbsp;<code>gwr_sf_adaptive</code>, which includes both the geographical information and the localized regression results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>gwr_sf_adaptive_poly <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tanzania_cleaned_polygons,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                         gwr_adaptive_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualizing-local-r2" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-local-r2">9.3.1 Visualizing Local <span class="math inline">\(R^2\)</span></h3>
<p>The localized model demonstrates a significant enhancement in performance, with the local <span class="math inline">\(R^2\)</span> values reaching as high as 0.72 for specific locations. This improvement illustrates the effectiveness of GWR in capturing spatial variations in model performance across different regions. The following code generates a map that overlays the Tanzania boundary with the localized <span class="math inline">\(R^2\)</span> values represented as dots.</p>
<p>To visualize a choloropleth map we will take the following steps:</p>
<ol type="1">
<li>Set geometry of gwr_sf_adaptive to the polygons</li>
<li>Plot the choloropleth map of aggregated values</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The map displays the spatial distribution of local <span class="math inline">\(R^2\)</span> values from the geographically weighted regression (GWR) model, overlaid on Tanzania’s district boundaries. Each dot represents a location with a local <span class="math inline">\(R^2\)</span> value, color-coded according to its range. Darker shades indicate higher local <span class="math inline">\(R^2\)</span> values, while lighter shades indicate lower values.</p>
<p>The local <span class="math inline">\(R^2\)</span> values range from 0.65 to 0.72 in this visualization, with clusters of higher values (0.71 to 0.72) concentrated in certain areas. This variation in local <span class="math inline">\(R^2\)</span> suggests that the model’s explanatory power varies across Tanzania, reflecting differences in how well the predictors explain financial inclusion in different districts. Higher <span class="math inline">\(R^2\)</span> values in specific <strong>northern and western districts</strong> highlight areas where the GWR model better captures the relationship between Mobile Money Usage (MMU) and its predictors, likely due to localized factors influencing financial inclusion outcomes.</p>
</section>
<section id="visualizing-coefficient-estimates" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-coefficient-estimates">9.3.2 Visualizing coefficient estimates</h3>
<p>Lastly, we will visualize the standard error and t-value maps of the key significant predictors.</p>
<section id="financial-literacy-and-comfort" class="level4">
<h4 class="anchored" data-anchor-id="financial-literacy-and-comfort">9.3.2.1 Financial Literacy and Comfort</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>1.&nbsp;<strong>FinancialEducation_YesNo Ratio</strong></p>
<ul>
<li><strong>Left (SE):</strong> The map displays the standard error values associated with the ratio of individuals with financial education versus those without. Districts with darker orange dots in the north show higher standard errors, suggesting greater variability or uncertainty in how financial education impacts financial inclusion in these areas. Lighter shades in other districts indicate more stable estimates, implying a more consistent influence of financial education on financial inclusion.</li>
</ul>
<!-- -->
<ul>
<li><strong>Right (TV):</strong>The t-value map illustrates the strength and direction of the influence of financial education on Mobile Money Usage. Higher t-values, shown by darker dots, indicate a stronger positive impact of financial education on financial inclusion in those regions. The northeastern areas have relatively high t-values, suggesting that financial education is statistically significant and positively associated with financial inclusion in these regions.</li>
</ul>
<p>2.&nbsp;<strong>ComfortableBank_YesNo_Ratio (Bottom Row)</strong></p>
<ul>
<li><strong>Left (SE):</strong> Darker colors in northern regions indicate greater variability, reflecting more uncertainty in the influence of comfort with banking on Mobile banking in these areas. Lighter colors elsewhere suggest more stable estimates of this effect.</li>
<li><strong>Right (TV):</strong> The t-value map represents the strength and direction of the effect of comfort with banking services on Mobile Money Usage. Darker shades indicate stronger positive effects, where a higher proportion of individuals comfortable with banking correlates with higher levels of financial inclusion. The coastal and southern districts, with darker orange dots, show that comfort with banking has a particularly positive influence on MMU in these areas.</li>
</ul>
</section>
<section id="demographics" class="level4">
<h4 class="anchored" data-anchor-id="demographics">9.3.2.2 Demographics</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>1. Urban Ratio (Top Row)</p>
<ul>
<li><p><strong>Left (Urban_SE):</strong> The map displays the standard error values for the Urban ratio, representing the difference between urban and rural populations. Districts with darker orange shades, particularly in northern and central districts, show higher standard errors. This indicates greater variability or uncertainty in the influence of being in an urban setting on financial inclusion in these districts. Lighter colors elsewhere reflect more stable estimates.</p></li>
<li><p><strong>Right (Urban_TV):</strong> The t-value map illustrates the statistical significance and strength of the impact of urban residence on MMU. Higher t-values, shown by darker dots in the northwestern and southwestern districts, suggest a significant positive effect of urban residence on financial inclusion in these areas.</p></li>
</ul>
<p>2. Mean Age Ratio (Bottom Row)</p>
<ul>
<li><p><strong>Left (Mean_Age_SE):</strong> This map shows the standard error values for the Mean Age ratio, indicating the variability in the effect of mean age on financial inclusion across districts. Darker shades in the dis districts point to higher uncertainty in how age impacts financial inclusion, while lighter colors in the south suggest more consistent effects.</p></li>
<li><p><strong>Right (Mean_Age_TV):</strong> The t-value map represents the strength and direction of the relationship between mean age and MMU. Darker areas, mostly concentrated in the northern parts, indicate a statistically significant effect, implying that mean age is an influential factor in financial inclusion for these districts.</p></li>
</ul>
</section>
<section id="access-to-financial-products-and-basic-technology" class="level4">
<h4 class="anchored" data-anchor-id="access-to-financial-products-and-basic-technology">9.3.2.3 Access to Financial Products and Basic Technology</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>1. Used_CreditCard (Top Row)</p>
<ul>
<li><p><strong>Left (Used_CreditCard_SE):</strong> The map displays the standard error values, indicating the uncertainty in the effect of credit card usage on MMU across districts. The darker areas, mostly in the northern and eastern parts of the region, have higher standard errors, suggesting greater variability in these locations. Lighter colors elsewhere reflect more stable estimates.</p></li>
<li><p><strong>Right (Used_CreditCard_TV):</strong> The map on the right shows the t-values, representing the statistical significance of credit card usage on financial inclusion. Higher negative t-values, represented by darker points primarily in the north, indicate a significant effect. This suggests that, in these districts, credit card usage may have a more notable relationship with financial inclusion, even if the effect size is negative.</p></li>
</ul>
<p>2. BadPhoneConnection (Bottom Row)</p>
<ul>
<li><p><strong>Left (BadPhoneConnection_SE):</strong> Higher standard errors are shown in darker orange shades, mainly in southern and eastern districts, indicating greater uncertainty in how phone connection quality impacts financial inclusion in these areas. Lighter colors suggest more stable estimates in other regions.</p></li>
<li><p><strong>Right (BadPhoneConnection_TV):</strong> The t-value map shows the significance of the relationship between poor phone connectivity and financial inclusion. Darker colors in the southern districts represent stronger negative t-values, suggesting a statistically significant impact. This implies that poor phone connectivity may negatively affect financial inclusion more prominently in these areas.</p></li>
</ul>
</section>
<section id="financial-institutions-involvement" class="level4">
<h4 class="anchored" data-anchor-id="financial-institutions-involvement">9.3.2.3 Financial Institution’s Involvement</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>1. Do_Not_Think_They_Care (Top Row)</p>
<ul>
<li><p><strong>Left (Do_Not_Think_They_Care_SE):</strong> The map displays the standard error values, indicating the uncertainty in the effect of financial institutions not caring on mobile money usage across districts. There are only a few darker areas, mostly in the central districts, have higher standard errors, suggesting greater variability in these locations. Lighter colors elsewhere reflect more stable estimates.</p></li>
<li><p><strong>Right (Do_Not_Think_They_Care_TV):</strong> The map on the right shows the t-values, representing the statistical significance of financial institutions not caring on financial inclusion. Higher negative t-values, represented by darker points primarily in the western coastal districts, indicate a significant effect. This suggests that, in these districts, when financial institutions don’t care there may be a greater impact on financial inclusion.</p></li>
</ul>
<p>2. Advice_Bank (Bottom Row)</p>
<ul>
<li><p><strong>Left (Advice_Bank_SE):</strong> Higher standard errors are shown in darker orange shades, mainly in southern and central districts, indicating greater uncertainty in how advice from banks impacts Mobile banking in these areas. Lighter colors suggest more stable estimates in other regions.</p></li>
<li><p><strong>Right (Advice_Bank_TV):</strong> The t-value map shows the significance of the relationship between bank advice and financial inclusion. Darker colors in the southern districts represent stronger negative t-values, suggesting a statistically significant impact. This implies that advice from banks may negatively affect Mobile Banking more prominently in these districts. This calls for improvement in advice from banks to promote mobile banking,</p></li>
</ul>
<hr>
</section>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>10 Conclusion</h1>
<p>This study provides an in-depth analysis of the factors influencing financial inclusion in Tanzania through the lens of Mobile Money Usage (MMU), a core indicator of financial participation in underserved regions. By employing Multiple Linear Regression (MLR) and Geographically Weighted Regression (GWR), this analysis explores both the overall and localized effects of socio-economic, demographic, and infrastructural variables on financial access across Tanzanian districts.</p>
<p>The initial model, capturing approximately 58% of the variance in MMU, demonstrated a substantial explanatory power in identifying key drivers of financial inclusion. Through stepwise regression, a refined model achieved an adjusted R-squared of 62.5%, pinpointing significant predictors including urban residency, comfort with banking, financial education, mobile connectivity, and advice from SACCOs. Notably, urban residency and financial education emerged as critical enablers, emphasizing the importance of financial literacy and regional access to financial infrastructure. Conversely, reliance on banks for financial advice was associated with lower engagement, highlighting potential mistrust or accessibility issues with formal institutions.</p>
<p>Furthermore, the exploration of Geographically Weighted Regression (GWR) provided valuable insights into the spatial variations of these factors across different districts. GWR allowed for a better understanding of how the effects of key variables vary regionally, thereby increasing the explanatory power of the model to 63.27%.</p>
<p>This study emphasizes the multifaceted nature of financial inclusion, where socio-economic and infrastructural factors interact to influence access to financial services. The findings suggest targeted interventions, such as enhancing mobile connectivity in rural areas, promoting financial education, and fostering community-based financial organizations like SACCOs, could foster broader financial participation.</p>
<hr>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Demirgüç-Kunt, A., Klapper, L., &amp; Singer, D. (2017).&nbsp;<em>Financial inclusion and inclusive growth: A review of recent empirical evidence</em>&nbsp;(WPS8040). Development Research Group, Finance and Private Sector Development Team. https://doi.org/10.1596/1813-9450-8040</p>
<p>Koomson, I., Churchill, S.A. &amp; Munyanyi, M.E. Gambling and Financial Stress.&nbsp;<em>Soc Indic Res</em><strong>163</strong>, 473–503 (2022). https://doi.org/10.1007/s11205-022-02898-6</p>
<p>United Nations Capital Development Fund (UNCDF). (2024).&nbsp;<em>Insights from Tanzania: Global data reveals financial inclusion for women</em>. Retrieved from&nbsp;<a href="https://policyaccelerator.uncdf.org/whats-new/insights-tanzania-global-data-reveals-financial-inclusion-women" class="uri">https://policyaccelerator.uncdf.org/whats-new/insights-tanzania-global-data-reveals-financial-inclusion-women</a></p>
<p>World Bank. (17 April, 2024).&nbsp;<em>Financial inclusion in Sub-Saharan Africa: Overview</em>. Retrieved from&nbsp;<a href="https://www.worldbank.org/en/publication/globalfindex/brief/financial-inclusion-in-sub-saharan-africa-overview" class="uri">https://www.worldbank.org/en/publication/globalfindex/brief/financial-inclusion-in-sub-saharan-africa-overview</a></p>
<p>World Bank. (2022).&nbsp;<em>Global financial inclusion: A comprehensive overview</em>. Retrieved from&nbsp;<a href="https://documents1.worldbank.org/curated/en/099305408252329233/pdf/SECBOS1e6ff9a00041b4261bcdc9c154a7b.pdf" class="uri">https://documents1.worldbank.org/curated/en/099305408252329233/pdf/SECBOS1e6ff9a00041b4261bcdc9c154a7b.pdf</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>