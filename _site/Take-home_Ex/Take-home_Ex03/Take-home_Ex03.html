<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sei Sar Hla Kyi">
<meta name="dcterms.date" content="2024-10-14">

<title>ISSS626-GAA - Take Home Exercise 3: Modelling Geography of Financial Inclusion in Tanzania with Geographically Weighted Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">2 Methodology</a></li>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages">3 Loading R Packages</a></li>
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data">4 Importing the Data</a>
  <ul class="collapse">
  <li><a href="#the-datasets" id="toc-the-datasets" class="nav-link" data-scroll-target="#the-datasets">4.1 The Datasets</a></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">4.2 Aspatial Data</a></li>
  <li><a href="#geospatial-data---study-area" id="toc-geospatial-data---study-area" class="nav-link" data-scroll-target="#geospatial-data---study-area">4.3 Geospatial Data - Study Area</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">5 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables">5.1 Categorical Variables</a></li>
  <li><a href="#continuous-variables" id="toc-continuous-variables" class="nav-link" data-scroll-target="#continuous-variables">5.2 Continuous Variables</a></li>
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join">5.3 Left Join</a></li>
  <li><a href="#the-dependent-variable" id="toc-the-dependent-variable" class="nav-link" data-scroll-target="#the-dependent-variable">6 The Dependent Variable</a>
  <ul class="collapse">
  <li><a href="#financial-inclusion-in-tanzania" id="toc-financial-inclusion-in-tanzania" class="nav-link" data-scroll-target="#financial-inclusion-in-tanzania"><strong>6.1.1 Financial Inclusion in Tanzania</strong></a></li>
  <li><a href="#deriving-the-dependent-variable---financial-inclusion-index" id="toc-deriving-the-dependent-variable---financial-inclusion-index" class="nav-link" data-scroll-target="#deriving-the-dependent-variable---financial-inclusion-index"><strong>6.1.2 Deriving The Dependent Variable - Financial Inclusion Index</strong></a></li>
  <li><a href="#dependent-variable-implications" id="toc-dependent-variable-implications" class="nav-link" data-scroll-target="#dependent-variable-implications">6.1.3 Dependent Variable Implications</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">7 Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#descriptive-statistics-and-visualizations" id="toc-descriptive-statistics-and-visualizations" class="nav-link" data-scroll-target="#descriptive-statistics-and-visualizations">7.1 Descriptive Statistics and Visualizations</a>
  <ul class="collapse">
  <li><a href="#visualizing-dependent-variable" id="toc-visualizing-dependent-variable" class="nav-link" data-scroll-target="#visualizing-dependent-variable">7.1.1 Visualizing Dependent Variable</a></li>
  <li><a href="#histogram-plots-of-predictor-variables" id="toc-histogram-plots-of-predictor-variables" class="nav-link" data-scroll-target="#histogram-plots-of-predictor-variables">7.1.2 Histogram Plots of Predictor Variables</a></li>
  </ul></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">7.2 Correlation Analysis</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">8 Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#initial-model" id="toc-initial-model" class="nav-link" data-scroll-target="#initial-model">8.1 Initial Model</a></li>
  <li><a href="#the-refined-model---stepwise-regression" id="toc-the-refined-model---stepwise-regression" class="nav-link" data-scroll-target="#the-refined-model---stepwise-regression">8.2 The Refined Model - Stepwise Regression</a></li>
  <li><a href="#variable-selected" id="toc-variable-selected" class="nav-link" data-scroll-target="#variable-selected">8.3 Variable Selected</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">8.5 Model Diagnostics</a>
  <ul class="collapse">
  <li><a href="#multicollinearity---vif" id="toc-multicollinearity---vif" class="nav-link" data-scroll-target="#multicollinearity---vif"><strong>8.5.1 Multicollinearity - VIF</strong></a></li>
  <li><a href="#test-for-non-linearity" id="toc-test-for-non-linearity" class="nav-link" data-scroll-target="#test-for-non-linearity">8.5.2 Test for Non Linearity</a></li>
  <li><a href="#test-for-normality-assumption" id="toc-test-for-normality-assumption" class="nav-link" data-scroll-target="#test-for-normality-assumption">8.5.3 Test for Normality Assumption</a></li>
  <li><a href="#test-for-spatial-autocorrelation" id="toc-test-for-spatial-autocorrelation" class="nav-link" data-scroll-target="#test-for-spatial-autocorrelation">8.5.3 Test for Spatial Autocorrelation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geographically-weighted-linear-regression" id="toc-geographically-weighted-linear-regression" class="nav-link" data-scroll-target="#geographically-weighted-linear-regression">9 Geographically Weighted Linear Regression</a></li>
  <li><a href="#hedonic-pricing-using-gwmodel" id="toc-hedonic-pricing-using-gwmodel" class="nav-link" data-scroll-target="#hedonic-pricing-using-gwmodel">Hedonic Pricing using GWmodel</a>
  <ul class="collapse">
  <li><a href="#adaptive-bandwidth-gwr-model" id="toc-adaptive-bandwidth-gwr-model" class="nav-link" data-scroll-target="#adaptive-bandwidth-gwr-model">Adaptive Bandwidth GWR Model</a></li>
  <li><a href="#this-function-really-need-the-model-wont-work-without-model." id="toc-this-function-really-need-the-model-wont-work-without-model." class="nav-link" data-scroll-target="#this-function-really-need-the-model-wont-work-without-model.">This function really need the model, won’t work without model.</a></li>
  <li><a href="#visualizing-gwr-output" id="toc-visualizing-gwr-output" class="nav-link" data-scroll-target="#visualizing-gwr-output">Visualizing GWR Output</a>
  <ul class="collapse">
  <li><a href="#converting-sdf-into-sf-data.frame" id="toc-converting-sdf-into-sf-data.frame" class="nav-link" data-scroll-target="#converting-sdf-into-sf-data.frame">Converting SDF into sf data.frame</a></li>
  <li><a href="#visualizing-local-r2" id="toc-visualizing-local-r2" class="nav-link" data-scroll-target="#visualizing-local-r2">Visualizing local R2</a></li>
  <li><a href="#visualizing-coefficient-estimates" id="toc-visualizing-coefficient-estimates" class="nav-link" data-scroll-target="#visualizing-coefficient-estimates">Visualizing coefficient estimates</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 3: Modelling Geography of Financial Inclusion in Tanzania with Geographically Weighted Methods</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sei Sar Hla Kyi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 14, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 1, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1 Overview</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.1 Background</h2>
<p>Financial inclusion plays a key role in promoting equitable economic growth by enabling individuals and businesses to access essential financial services such as banking, loans, insurance, and equity products. In Tanzania, financial inclusion initiatives have become a priority in addressing the needs of underserved populations, particularly those in rural or economically disadvantaged areas. These initiatives aim to improve household incomes, reduce income inequality, and foster inclusive economic participation by providing timely and affordable access to financial products and services(United Nations Capital Development Fund [UNCDF], 2024).</p>
<p>Despite significant progress in financial inclusion efforts, access to financial services is uneven across different geographical regions within Tanzania. Rural areas, particularly in districts with low levels of economic activity, often face greater challenges in accessing financial services compared to more urbanized districts. These spatial disparities raise important questions about the factors driving financial inclusion at the district level and how regional policies can be designed to promote more inclusive economic outcomes.</p>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>This analysis aims to build an explanatory model using Multiple Linear Regression as well as Geographically Weighted Regression (GWR) to identify the key factors affecting financial inclusion across districts in Tanzania. By focusing on multiple socio-economic and infrastructural variables, this study will provide insights into how these factors vary geographically and influence financial access <strong><em>at a district level</em></strong>.</p>
<p>Specifically, the objectives are:</p>
<ul>
<li><p><strong>Identify Key Determinants</strong>: Determine the primary socio-economic and infrastructural factors that influence financial inclusion.</p></li>
<li><p><strong>Examine Regional Variation</strong>: Explore how the effects of these factors vary across different districts, providing a localized understanding of financial inclusion.</p></li>
</ul>
</section>
</section>
<section id="methodology" class="level1">
<h1>2 Methodology</h1>
<p>The explanatory model will be developed first using <strong>Multiple Linear Regression</strong> and <strong>Geographically Weighted Regression (GWR)</strong>, which is a spatial extension of multiple linear regression that allows for localized variations in the relationships between predictors and the response variable—in this case, financial inclusion.</p>
<p>The process will follow these steps:</p>
<ul>
<li><p><strong>Defining dependent variable (y)</strong>: Derive dependent variable which represents financial inclusion from the FinScope dataset.</p></li>
<li><p><strong>Explanatory Variable Selection (x)</strong>: Identify key predictor variables, both continuous and categorical, from the FinScope dataset. These will serve as explanatory variables in the model.</p></li>
<li><p><strong>Model Building</strong>: Build the explanatory model using multiple linear regression techniques, enhanced by GWR to account for geographical variations. This will allow us to evaluate the influence of each predictor on financial inclusion across different districts.</p></li>
<li><p><strong>Model Calibration and Validation</strong>: Calibrate the model to ensure that it effectively captures the localized relationships between financial inclusion and its determinants.</p></li>
<li><p><strong>Spatial Visualization</strong>: Mapping the results of the GWR model to visualize how the effects of each factor vary geographically, will highlight districts where specific variables have a stronger or weaker influence on financial inclusion.</p></li>
</ul>
<hr>
</section>
<section id="loading-r-packages" class="level1">
<h1>3 Loading R Packages</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Packages Used</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The following packages were used for this study:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 88%">
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>olsrr</td>
<td>For creating and evaluating ordinary least squares regression models.</td>
</tr>
<tr class="even">
<td>ggstatsplot</td>
<td>for producing statistical visualizations that combine ggplot2 graphics with statistical results</td>
</tr>
<tr class="odd">
<td>ggpubr</td>
<td>To create publication-ready visualizations with ggplot2 and arranging multiple plots</td>
</tr>
<tr class="even">
<td>sf</td>
<td>For importing, managing, and handling geospatial data</td>
</tr>
<tr class="odd">
<td>sfdep</td>
<td>To analyze spatial relationships and incorporate them into regression models</td>
</tr>
<tr class="even">
<td>spdep</td>
<td>For calculating spatial weights and conducting tests for spatial relationships</td>
</tr>
<tr class="odd">
<td>GWmodel</td>
<td>To explore spatially varying relationships between the dependent and independent variables</td>
</tr>
<tr class="even">
<td>tmap</td>
<td>For thematic mapping, allowing us to visualize spatial data in an intuitive and aesthetically pleasing manner</td>
</tr>
<tr class="odd">
<td>tidyverse</td>
<td>For data manipulation, cleaning, and visualization</td>
</tr>
<tr class="even">
<td>gtsummary</td>
<td>To create summary tables for regression results, providing a clear and concise presentation of model outputs</td>
</tr>
<tr class="odd">
<td>see</td>
<td>For visualizing model diagnostics and results</td>
</tr>
<tr class="even">
<td>performance</td>
<td>For evaluating model performance and diagnostics</td>
</tr>
<tr class="odd">
<td>datawizard</td>
<td>To handle missing values, recode variables, and perform exploratory data analysis before modeling</td>
</tr>
<tr class="even">
<td>gtsummary</td>
<td>To create publication ready summary tables</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(st,olsrr, ggstatsplot, ggpubr, sf, spdep, sfdep, GWmodel, tmap, tidyverse, gtsummary,see,performance,datawizard,gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="importing-the-data" class="level1">
<h1>4 Importing the Data</h1>
<section id="the-datasets" class="level2">
<h2 class="anchored" data-anchor-id="the-datasets">4.1 The Datasets</h2>
<p>For this analysis, we will use two primary datasets: (1) FinScope Tanzania 2023, which provides district-level data on financial inclusion, and (2) district-level boundary GIS data from the geoBoundaries portal to facilitate spatial analysis.</p>
<ul>
<li><p><strong>FinScope Tanzania 2023</strong>: This dataset include comprehensive district-level data on access to financial services, covering indicators such as banking services, mobile money usage, savings, loans, and insurance. The dataset will be used to identify the key factors affecting financial inclusion and to develop the explanatory model.</p></li>
<li><p><strong>District Boundary GIS Data</strong>: Geographic boundary data for the districts of Tanzania, sourced from the geoBoundaries, will enable us to link the financial inclusion data to specific geographic locations for spatial analysis using GWR.</p></li>
</ul>
</section>
<section id="aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data">4.2 Aspatial Data</h2>
<p>The <em>FinScope</em> <em>Tanzania</em> dataset from 2023, was imported by using <em>read_csv()</em> package.</p>
<p>Then, the data was prepared for analysis with the following steps:</p>
<ul>
<li>We extract the columns with the variables chosen which will be explained in the Variable Selection section.</li>
<li>Rename some district names to match the boundary dataset in section 4.3.</li>
<li>Remove columns with all missing/NA values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/FinScope_Tanzania.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">14</span>,<span class="dv">16</span>, <span class="dv">65</span><span class="sc">:</span><span class="dv">67</span>, <span class="dv">95</span><span class="sc">:</span><span class="dv">103</span>, <span class="dv">107</span><span class="sc">:</span><span class="dv">119</span>, <span class="dv">125</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="dv">140</span>, <span class="dv">142</span><span class="sc">:</span><span class="dv">151</span>, <span class="dv">160</span><span class="sc">:</span><span class="dv">174</span>, <span class="dv">177</span><span class="sc">:</span><span class="dv">178</span>, <span class="dv">180</span>, <span class="dv">183</span><span class="sc">:</span><span class="dv">192</span>, <span class="dv">196</span>, <span class="dv">215</span><span class="sc">:</span><span class="dv">223</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="dv">275</span><span class="sc">:</span><span class="dv">278</span>, <span class="dv">294</span><span class="sc">:</span><span class="dv">306</span>, <span class="dv">344</span><span class="sc">:</span><span class="dv">353</span>, <span class="dv">361</span><span class="sc">:</span><span class="dv">372</span>, <span class="dv">374</span><span class="sc">:</span><span class="dv">378</span>, <span class="dv">395</span><span class="sc">:</span><span class="dv">397</span>, <span class="dv">455</span><span class="sc">:</span><span class="dv">460</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="dv">495</span>, <span class="dv">497</span>, <span class="dv">507</span><span class="sc">:</span><span class="dv">529</span>, <span class="dv">574</span><span class="sc">:</span><span class="dv">580</span>, <span class="dv">591</span>, <span class="dv">612</span>, <span class="dv">650</span><span class="sc">:</span><span class="dv">651</span>, <span class="dv">653</span>, <span class="dv">655</span>, <span class="dv">657</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         <span class="dv">678</span>, <span class="dv">680</span><span class="sc">:</span><span class="dv">685</span>, <span class="dv">697</span><span class="sc">:</span><span class="dv">698</span>, <span class="dv">702</span><span class="sc">:</span><span class="dv">716</span>, <span class="dv">718</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Magharibi A"</span>, <span class="st">"Magharibi"</span>, dist_name),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Magharibi B"</span>, <span class="st">"Magharibi"</span>, dist_name),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Nyang'hwale"</span>, <span class="st">"Nyanghwale"</span>, dist_name),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Wanging'ombe"</span>, <span class="st">"Wangingombe"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(.))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use <strong><em>glimpse()</em></strong> to quickly check the attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tanzania)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lastly, we will save the prepared dataframe into rds format.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzania, <span class="st">"data/rds/tanzania.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzania.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="geospatial-data---study-area" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data---study-area">4.3 Geospatial Data - Study Area</h2>
<p>The <em>geo Boundaries of Tanzania</em> dataset, was imported by using <em>st_read()</em> package.</p>
<p>The dataset was prepared for analysis with the following steps:</p>
<ul>
<li><p>We note that Tanzania is in WGS 84/ UTM Zone 37S. We will use st_transform to reproject coordinate reference system to EPSG: 32737 for Tanzania.</p></li>
<li><p>To perform left join with the aspatial dataset, we need a common column - districts name. Therefore, we need to change the variable, shapeName, to ‘dist_name’ to make it a common variable with the FinScope Tanzania dataset.</p></li>
<li><p>To ensure the districts are common, some districts will be renamed from “Arusha Urban” to “Arusha” as the same way it was displayed in FinScope Tanzania dataset. Since the FinScope Tanzania dataset already have a variable that classifies if the surveyee is residing in an urban or rural area, we do not need to have a separate district with the title Urban as it falls under the same district.</p></li>
<li><p>We will also remove some district names that are not present in the FinScope Tanzania dataset.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tanzbounds <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"geoBoundaries-TZA-ADM2"</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">32737</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">dist_name =</span> shapeName) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Arusha Urban"</span>, <span class="st">"Arusha"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Meru"</span>, <span class="st">"Arumeru"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Iringa Urban"</span>,<span class="st">"Iringa"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Bukoba Urban"</span>, <span class="st">"Bukoba"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mpanda Urban"</span>, <span class="st">"Mpanda"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kigoma  Urban"</span>, <span class="st">"Kigoma"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Moshi Urban"</span>, <span class="st">"Moshi"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Lindi Urban"</span>, <span class="st">"Lindi"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Musoma Urban"</span>, <span class="st">"Musoma"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mbeya Urban"</span>, <span class="st">"Mbeya"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Babati UrbanBabati Urban"</span>, <span class="st">"Babati"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Dodoma Urban"</span>, <span class="st">"Dodoma"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Kibaha Urban"</span>, <span class="st">"Kibaha"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Morogoro Urban"</span>, <span class="st">"Morogoro"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mtwara Urban"</span>, <span class="st">"Mtwara"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Njombe Urban"</span>, <span class="st">"Njombe"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Mtwara Urban"</span>, <span class="st">"Mtwara"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Shinyanga Urban"</span>, <span class="st">"Shinyanga"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Singida Urban"</span>, <span class="st">"Singida"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Songea Urban"</span>, <span class="st">"Songea"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Sumbawanga Urban"</span>, <span class="st">"Sumbawanga"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Tabora Urban"</span>, <span class="st">"Tabora"</span>, dist_name))<span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Tanga Urban"</span>, <span class="st">"Tanga"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Nyang'hwale"</span>, <span class="st">"Nyanghwale"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Wanging'ombe"</span>, <span class="st">"Wangingombe"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_name =</span> <span class="fu">ifelse</span>(dist_name <span class="sc">==</span> <span class="st">"Butiam"</span>, <span class="st">"Butiama"</span>, dist_name)) <span class="sc">%&gt;%</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>dist_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mafinga Township Authority"</span>, <span class="st">"Kasulu Township Authority"</span>, <span class="st">"Masasi  Township Authority"</span> , <span class="st">"Makambako Township Authority"</span>, <span class="st">"Kahama Township Authority"</span>, <span class="st">"Korogwe Township Authority"</span>, <span class="st">"Handeni Mji"</span>,<span class="st">"Mafia"</span>,<span class="st">"Tunduma"</span>,<span class="st">"Korogwe"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (<span class="sc">-</span><span class="fu">c</span>(<span class="st">"shapeISO"</span>,<span class="st">"shapeID"</span>,<span class="st">"shapeGroup"</span>,<span class="st">"shapeType"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `geoBoundaries-TZA-ADM2' from data source 
  `/Users/seesarhlakyi/Desktop/ssrhk/ISSS626-GAA/Take-home_Ex/Take-home_Ex03/data/rawdata' 
  using driver `ESRI Shapefile'
Simple feature collection with 170 features and 5 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 29.58953 ymin: -11.76235 xmax: 40.44473 ymax: -0.983143
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<p>To ensure the study area is in the correct format, we will use <strong><em>st_crs</em></strong> to check.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(tanzbounds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: EPSG:32737 
  wkt:
PROJCRS["WGS 84 / UTM zone 37S",
    BASEGEOGCRS["WGS 84",
        ENSEMBLE["World Geodetic System 1984 ensemble",
            MEMBER["World Geodetic System 1984 (Transit)"],
            MEMBER["World Geodetic System 1984 (G730)"],
            MEMBER["World Geodetic System 1984 (G873)"],
            MEMBER["World Geodetic System 1984 (G1150)"],
            MEMBER["World Geodetic System 1984 (G1674)"],
            MEMBER["World Geodetic System 1984 (G1762)"],
            MEMBER["World Geodetic System 1984 (G2139)"],
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ENSEMBLEACCURACY[2.0]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4326]],
    CONVERSION["UTM zone 37S",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",39,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",10000000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["Between 36°E and 42°E, southern hemisphere between 80°S and equator, onshore and offshore. Kenya. Mozambique. Tanzania."],
        BBOX[-80,36,0,42]],
    ID["EPSG",32737]]</code></pre>
</div>
</div>
<p>Now we are ready to save the dataset.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzbounds, <span class="st">"data/rds/tanzbounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tanzbounds<span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzbounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>5 Data Wrangling</h1>
<p>In the development of a multiple linear regression model, the selection of appropriate variables is critical to ensuring the model’s accuracy and interpretability. This section focuses on the selection of both categorical and continuous variables that will serve as predictors in our regression analysis.</p>
<p>Initially, we will establish a preliminary set of variables based on theoretical foundations and previous empirical research from the 722 variables of FinScope Tanzania dataset.</p>
<section id="categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="categorical-variables">5.1 Categorical Variables</h2>
<p>We will employ one-hot encoding to transform categorical variables into a format suitable for regression modeling. One-hot encoding allows us to create binary columns for each category, enabling the regression model to assess the impact of each nominal variable effectively. This approach ensures that we capture the distinct effects of categorical factors on the dependent variable while maintaining the integrity of the data.</p>
<p>Before we further prepare our variables (which are in the form of survey questions), we will convert the column names into a more R-friendly format using&nbsp;<code>make.names()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tanzania) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">colnames</span>(tanzania))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the following variables and code chunk to one-hot encode all the nominal variables as mentioned above. Some one hot encoded columns will be used to derive continuous variables as well.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Variables and Justification</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 21%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Justification for Selection</strong></th>
<th><strong>Modification</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cluster type</td>
<td>To understand if there are any inequality across urban and rural areas</td>
<td><p>Encoded as two columns - ‘Urban’ and ‘Rural’</p>
<p>If respondent indicates ‘urban’, this variable will be 1 and 0 for rural.</p></td>
</tr>
<tr class="even">
<td>Respondent gender</td>
<td>To understand the demographic background of respondent</td>
<td>Encoded as two columns - ‘male’ and ‘female’</td>
</tr>
<tr class="odd">
<td>Education Background</td>
<td>To understand the demographic background of respondent</td>
<td>Encoded as eight columns - ‘NoFormalEducation’ and ‘SomePrimary’ and so on</td>
</tr>
<tr class="even">
<td>Access to Mobile Phone, Internet and Laptop</td>
<td>To understand the socioeconomic status of respondent</td>
<td>Encoded as three columns - ‘MobilePhone’, ‘Internet’ and ‘Laptop’</td>
</tr>
<tr class="odd">
<td>Financial Documents owned</td>
<td>To understand access to financial products</td>
<td>Encoded as ‘BankMFIStatement’,‘Lease’ and so on</td>
</tr>
<tr class="even">
<td>Source of Money to Start Business</td>
<td>To understand access to financial support system; internal and external</td>
<td>Encoded as ‘MoneyforBusiness_BankLoan’ and so on</td>
</tr>
<tr class="odd">
<td>If Business is registered with government and if it is not, why</td>
<td>To understand business compliance</td>
<td>Encoded as two columns - ‘BusinessRegistered_Yes’ and ‘BusinessRegistered_No’ and for not registered business encoded as ‘NoTime’ or ‘NoMoney’</td>
</tr>
<tr class="even">
<td>Respondent’s main income source</td>
<td>To understand the socioeconomic status of respondent</td>
<td>Encoded as binary columns for each income type, such as Formal_sector_salaried, Traders_agriculatural_proudcts, etc.</td>
</tr>
<tr class="odd">
<td>Who they discuss their financial matters with</td>
<td>To understand social support networks</td>
<td>Encoded as 15 columns - ‘Advice_HouseholdMember’ and ‘Advice_Bank’ and so on.</td>
</tr>
<tr class="even">
<td>What they did when they could not meet spending needs</td>
<td>To understand coping mechanisms</td>
<td>Encoded as 10 columns - ‘UsedSavings’ and ‘BorrowedFromBank’</td>
</tr>
<tr class="odd">
<td>Whether respondent is comfortable with banks</td>
<td>To gauge trust in financial institutions</td>
<td>Encoded as ‘ComfortableWithBank_Yes’ and ‘ComfortableWithBank_No’</td>
</tr>
<tr class="even">
<td>Financial Education</td>
<td>To understand the respondent’s financial literacy</td>
<td>Encoded as ‘ReceivedFinancialEducation_Yes’ and ‘ReceivedFinancialEducation_No’</td>
</tr>
<tr class="odd">
<td>Retirement plans</td>
<td>To understand future financial planning</td>
<td>Encoded as ‘Old_ChildrenWillTakeCareOfMe’ and ‘Old_Savings’</td>
</tr>
<tr class="even">
<td>Confidence in financial institutions</td>
<td>To understand perceptions of financial institutions</td>
<td>Encoded as “ConfidentWithBanks” and ‘ConfidentWithPensionFund’ and so on</td>
</tr>
<tr class="odd">
<td>If they are paying back money they owe within a year</td>
<td>To understand debt management</td>
<td>Encoded as PayingBack_Yes and PayingBack_No.</td>
</tr>
<tr class="even">
<td>If they have borrowed money from any financial institutions</td>
<td>To understand access to credit</td>
<td>Encoded as binary columns for each financial institution type such as ‘BorrowedFrom_Bank’ and ‘BorrowedFrom_MFI’</td>
</tr>
<tr class="odd">
<td>How often a respondent use the payment type for purchases</td>
<td>To understand spending habits</td>
<td>Encoded as binary columns for each payment type such as Used_Cash, Used_ATM, Used_CreditCard and so on.</td>
</tr>
<tr class="even">
<td>Assistance from Government or NGO and problems they face receiving assistance</td>
<td>To understand reliance on assistance and issues</td>
<td>Encoded as binary columns such as ‘Basic_TASAF_Cash_Transfer&nbsp;’ and ‘Money_Didnt_Come’</td>
</tr>
<tr class="odd">
<td>Reporting problems regarding financial matters</td>
<td>To understand barriers in reporting issues</td>
<td>Encoded as binary columns such as ‘Do_Not_Know_Where_To_Go’ and ‘Do_Not_Think_They_Care’</td>
</tr>
<tr class="even">
<td>Confidence and Trust in Insurance Companies</td>
<td>To assess trust in insurance</td>
<td>Encoded as relevant indicators such as Trust_Insurance_Companies</td>
</tr>
<tr class="odd">
<td>Insurance ownership and type of insurance</td>
<td>To understand financial protection</td>
<td>Encoded as binary columns for each insurance type such as Motor_vehicle_insurance, Health_Insurance, etc.</td>
</tr>
<tr class="even">
<td>If they have any issues accessing financial products</td>
<td>To understand barriers to access</td>
<td>Network_Failure and Agent_Absent</td>
</tr>
<tr class="odd">
<td>Access and relationship with moneylender</td>
<td>To understand trust and access to informal credit</td>
<td>Moneylender_Access and Moneylender_TreatsWell</td>
</tr>
<tr class="even">
<td>If respondent is involved with a Bank, MFI, PENSION, INSURANCE, SACCO, CAPITAL Fund Managers, FORMAL INVESTMEN, CMG, INFORMAL MONEYLENDER or apart of a Social group</td>
<td>To assess engagement with financial institutions, microfinance, pension and so on.</td>
<td>Encoded as Banked and Not_Banked, MFI and Not_MFI and so on.</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tanzania_onehotencoded<span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Urban =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Cluster.type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Urban"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rural =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Cluster.type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Rural"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C9..Respondent.gender.Interviewer.to.observe</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Male"</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C9..Respondent.gender.Interviewer.to.observe</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Female"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoFormalEducation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No formal education"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomePrimary =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some primary"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">PrimaryCompleted =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Primary completed"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">PostPrimaryTechnicalTraining =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Post primary technical training"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomeSecondary =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some secondary"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">SecondaryCompleted_OLevel =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Secondary competed-O level"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">SomeUniversityOrHigherEducation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Some University or other higher education"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">UniversityOrHigherEducationCompleted =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C11..Highest.level.of.education.completed..Can.read.out</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"University or higher education completed"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">MobilePhone =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C23..Which.of.the.following.do.you.have.access..to..Mobile.phone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Internet =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C23..Which.of.the.following.do.you.have.access..to..Internet</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Laptop =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C23..Which.of.the.following.do.you.have.access..to..Laptop.or.desktop.or.tablet</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">BankMFIStatement =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Bank.MFI.Statement</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lease =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Lease.rental.agreement.for.house.vehicle.</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subscription =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Subscription</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">TaxIDNumber =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Tax.ID.Number..TIN.</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">InsurancePolicy =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Insurance.Policy</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">PaySlip =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Pay.slip.from.employer</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">TitleDeed =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Title.deed</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">CertofOccupancy =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Certificate.of.customary.rights.of.occupancy..CCRO.</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">InsuranceCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">C27..Which.of.the.following.documents.do.you.currently.have.in.your.name..Insurance.card</span><span class="st">`</span><span class="sc">==</span> <span class="st">"Yes"</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_BankLoan =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Loan from bank or MFIs"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SACCOSLoan =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Loan from SACCOS"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_CMGSLoan =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Loan from CMGs"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_FamilyFriendsLoan =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Loan from family/friends"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_FamilyFriendsGift =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Gift from family/friends"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_Inheritance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"From Inheritance"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SaleOfAssets =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Sale of assets owned"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SavingsOrSalary =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X5b.Where.did.you.get.most.of.the.money.from.to.start.your.business.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Saving/Salary"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4a.Is.your.business.registered.with.any.government.authority.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4a.Is.your.business.registered.with.any.government.authority.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TriedButNot'</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..Tried.but.was.not</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoTime =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..Don.t.have.time</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c..Why.you.have.not.registered.this.business..Dont.have.money</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">TooComplicated =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..It.is.too.complicated</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoBenefit =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..No.benefit</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessTooSmall =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..Business.is.too.small</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoPayment =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c..Why.you.have.not.registered.this.business..Don.t.want.to.pay</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">DontKnowHow =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..Dontt.know.how</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegistrationInProcess =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X6.4c.Please.tell.me.why.you.have.not.registered.this.business..Registration.is.being.processed</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>))<span class="sc">%&gt;%</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Formal_sector_salaried =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Formal sector salaried"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informal_sector_salaried =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Informal sector salaried"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Farmers_and_fishers_Inncome =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Farmers and fishers"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Traders_agricultural_products_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Traders - agricultural products"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Traders_non_agricultural_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Traders - non-agricultural"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Service_providers_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Service providers"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Piece_work_casual_labor_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Piece work/casual labor"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rental_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Rental income"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interest_from_savings_investments_stocks_unit_trusts =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Interest from savings, investments, stocks, unit trusts etc."</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pension_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Pension"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Welfare_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Welfare"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gambling_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Gambling"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dependents_Income =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Dependents"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">OtherIncome =</span> <span class="fu">ifelse</span>(Main.Income.Source <span class="sc">==</span> <span class="st">"Other"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_HouseholdMember =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..A.household.member</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FamilyMember =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Another.family.member</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Employer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Employer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Bank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Bank</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Microfinance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Microfinance.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SACCOS =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Savings.and.credit.cooperative..SACCOS.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FinancialAdvisor =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Financial.advisor</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FarmersAssociation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Farmers.association</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_BusinessAssociation =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Business.association</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SavingsGroup =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Savings.group</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Moneylender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Moneylender.in.community</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_GovernmentOfficial =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Government.official</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_VillageElder =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Village.elder.elder</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_OtherSpecify =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..Other.specify</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_NoOne =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.3.3..Who.do.you.talk.with.for.advice.about.money.matters..I.do.not.speak.with.anyone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">UsedSavings =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Used.savings</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromBank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.a.bank.MFI.SACCO</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedThroughMM =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.money.through.MM</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromMoneyLender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.money.lender</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromFriendFamily =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Borrowed.from.friend.family.community</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">GotAssistanceFromFamily =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Got.assistance.from.family.friends.community..that.I.did.not.need.to.repay.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">SoldLivestock =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Sold.livestock</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">CutSpending =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Cut.spending</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">WorkedMore =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Worked.more</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_CouldntMeetNeeds =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.7.N.1..Last.12.months...what.did.you.do.when.you.couldn.t.meet.your.regular.spending.needs._Others</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableWithBank_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.1..You.feel.comfortable.to.go.into.a.bank.or.another.financial.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableWithBank_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.1..You.feel.comfortable.to.go.into.a.bank.or.another.financial.institution</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"FALSE"</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">ReceivedFinancialEducation_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.2..You.have.received.some.financial.education.in.your.life</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"TRUE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">ReceivedFinancialEducation_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.5.2..You.have.received.some.financial.education.in.your.life</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"FALSE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_Savings =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Savings"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_ChildrenWillTakeCareOfMe =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Children will take care of me"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_MoneyFromFriendsRelatives =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Money from friends/relatives"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_LandProperty =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Land/property"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_OwnBusiness =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Own business"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_RentalIncome =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Rental income"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_DividendsFromShares =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Dividends from shares"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_FarmingAgricultureLivestock =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Farming/agriculture/livestock"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_Pension =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Pension"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_InsurancePolicy =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Insurance policy"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_NoPlans =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">E.10..How.will.you.mainly.ensure.that.you.have.money.to.meet.your.needs.when.you.are.old.and.can.no.longer.work.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Don’t know/Have no plans/Have not yet thought about how/where I would get the money for this purpose"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithBanks =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Banks</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMFIs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._MFIs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSACCOs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._SACCOs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Mobile.money.operators</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithPensionFund =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Pension.fund</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSavingsGroups =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Savings.groups.CMGs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithFamilyFriends =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._Family.friends</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithUTTs =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">F.3.2.1..I.will.read.for.you.a.list.of.institutions..and.pease.tell.me.which.you.feel.confident.with.SAVINGS.your.money.with._UTTs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">PayingBack_Yes =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.2.4..Have.you..in.the.past.12.months..been.paying.back.money.that.you.borrowed.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">PayingBack_No =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.2.4..Have.you..in.the.past.12.months..been.paying.back.money.that.you.borrowed.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Bank =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Bank</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MFI =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Microfinance.institution.such.as</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SACCO =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..SACCOS</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..A.mobile.money.service.provider</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_PensionFund =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..A.pension.fund</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Employer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Your.employer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_PayBack =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Family.friends.that.you.had.to.pay.back</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_NoPayBack =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Family.friends.that.you.did.not.have.to.pay.back</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-134"><a href="#cb13-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SavingsGroup =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Savings.group</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-135"><a href="#cb13-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_CommunityLender =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Someone.in.the.community.who.lend</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-136"><a href="#cb13-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_OtherSource =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">G.5.2.Did.you.borrow.money.from.the.following..Did.you.borrow.money.from.another.source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-137"><a href="#cb13-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.1.In.the.past.12.months..how.often.did.you.use.the.Cash.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-138"><a href="#cb13-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_ATM_DebitCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.2.In.the.past.12.months..how.often.did.you.use.the.ATM...Debit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-139"><a href="#cb13-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.1.In.the.past.12.months..how.often.did.you.use.the.Cash.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-140"><a href="#cb13-140" aria-hidden="true" tabindex="-1"></a><span class="at">Used_ATM_DebitCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.2.In.the.past.12.months..how.often.did.you.use.the.ATM...Debit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a><span class="at">Used_CreditCard =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.3.In.the.past.12.months..how.often.did.you.use.the.Credit.card.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-142"><a href="#cb13-142" aria-hidden="true" tabindex="-1"></a><span class="at">Used_BankTransfer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.4.In.the.past.12.months..how.often.did.you.use.the.Bank.transfer.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-143"><a href="#cb13-143" aria-hidden="true" tabindex="-1"></a><span class="at">Used_MobileMoney =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.5.In.the.past.12.months..how.often.did.you.use.the.Mobile.money.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-144"><a href="#cb13-144" aria-hidden="true" tabindex="-1"></a><span class="at">Used_Cryptocurrency =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.6.In.the.past.12.months..how.often.did.you.use.the.Cryptocurrency.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-145"><a href="#cb13-145" aria-hidden="true" tabindex="-1"></a><span class="at">Used_QR_Code =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.In.the.past.12.months..how.often.did.you.use.the.QR.code..for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-146"><a href="#cb13-146" aria-hidden="true" tabindex="-1"></a><span class="at">Used_POS =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.2.In.the.past.12.months..how.often.did.you.use.the.POS.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-147"><a href="#cb13-147" aria-hidden="true" tabindex="-1"></a><span class="at">Used_LipaNamba =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.3.In.the.past.12.months..how.often.did.you.use.the.Lipa.Namba.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-148"><a href="#cb13-148" aria-hidden="true" tabindex="-1"></a><span class="at">Used_AZAMPay =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.4.In.the.past.12.months..how.often.did.you.use.the.AZAM.Pay.for.purchases.of.goods</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Never"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb13-149"><a href="#cb13-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">Basic_TASAF_Cash_Transfer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1..You.indicated.earlier.that.you.get.assistance.from.Government.or.NGO..please.tell.me.which...Basic.TASAF.cash.transfer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-150"><a href="#cb13-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Conditional_TASAF_Cash_Transfer =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1..You.indicated.earlier.that.you.get.assistance.from.Government.or.NGO..please.tell.me.which...Additional.Conditional.TASAF.cash.transfer</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-151"><a href="#cb13-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pension_for_Elders =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1..You.indicated.earlier.that.you.get.assistance.from.Government.or.NGO..please.tell.me.which...Pension.for.elders..Znz.only.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-152"><a href="#cb13-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_Assistance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1..You.indicated.earlier.that.you.get.assistance.from.Government.or.NGO..please.tell.me.which...Others</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-153"><a href="#cb13-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">Payment_Was_Late =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._Payment.was.late</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-154"><a href="#cb13-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gave_Money_To_Official =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._You.had.to.give.money.to.an.official</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-155"><a href="#cb13-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">Money_Didnt_Come =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._Money.didn.t.come.at.all</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-156"><a href="#cb13-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">Received_Less_Money =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._You.received.less.money.than.should.have</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-157"><a href="#cb13-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">Household_Not_On_Register =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._Your.household.not.on.the.register</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-158"><a href="#cb13-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unable_To_Collection_Point =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._You.were.not.able.to.go.to.the.collection.point.and.you.didn.t.get.the.payment</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-159"><a href="#cb13-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">No_Proof_Of_Identity =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Please.tell.me.which.of.the.following.problems.do.you.experience.with.these.payments._You.didn.t.have.proof.of.identity.and.didn.t.g.et.the.money</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-160"><a href="#cb13-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Know_Where_To_Go =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..I.do.not.know.where.to.go</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-161"><a href="#cb13-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">Places_Not_In_My_Area =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..The.places.are.not.in.my.area</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-162"><a href="#cb13-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Think_They_Care =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">J1.7.Why.don.t.you.report.problems..I.do.not.think.they.care.about</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-163"><a href="#cb13-163" aria-hidden="true" tabindex="-1"></a>     <span class="at">Trust_Insurance_Companies =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1.3.Please.tell.me.which.of.the.following.you.is.true.for.you...You.trust.insurance.companies.to.pay.out.when.something.does.go.wrong</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-164"><a href="#cb13-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">Insurance_Good_Idea =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1.3.Please.tell.me.which.of.the.following.you.is.true.for.you...Insurance.is.a.good.idea.for.everyone</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-165"><a href="#cb13-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">Need_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X1.3.Please.tell.me.which.of.the.following.you.is.true.for.you...You.don.t.need.insurance.as.you.get.money.if.things.go.wrong</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-166"><a href="#cb13-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">Have_Insurance_Cover =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X2.Do.you.have.insurance.cover.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-167"><a href="#cb13-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">Motor_Vehicle_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Motor.vehicle.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-168"><a href="#cb13-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">Households_Contents_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Households.contents.insura</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-169"><a href="#cb13-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">Private_Health_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Private.health.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-170"><a href="#cb13-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">National_Health_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..National.health.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-171"><a href="#cb13-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">Community_Health_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Community.health.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-172"><a href="#cb13-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">TIKA_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..TIKA..Tiba.Kwa.Kadi.</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-173"><a href="#cb13-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">Social_Health_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Social.Health.Insurance.Be</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-174"><a href="#cb13-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">Personal_Accident_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Personal.accident.insuranc</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-175"><a href="#cb13-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">Life_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Life.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-176"><a href="#cb13-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">Loan_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Loan.insurance.in.case.of</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-177"><a href="#cb13-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">Building_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Building.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-178"><a href="#cb13-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">Education_Policy =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Education.policy</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-179"><a href="#cb13-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">Funeral_Cover =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Funeral.cover</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-180"><a href="#cb13-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agricultural_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Agricultural.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-181"><a href="#cb13-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ushirika_Afya =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Ushirika.afya</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-182"><a href="#cb13-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">Motorcycle_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Motorcycle.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-183"><a href="#cb13-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livestock_Insurance =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Livestock.insurance</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-184"><a href="#cb13-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_Insurance_Products =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X3.1.1.Please.tell.me.which.of.the.following.you.have..Any.other.insurance.produc</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-185"><a href="#cb13-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">Network_Failure =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Network.failure</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-186"><a href="#cb13-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Absent =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.absent.not.available</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-187"><a href="#cb13-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_No_Cash_Float =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.didn.t.have.enough.cash.float</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-188"><a href="#cb13-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Overcharged =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.overcharged.for.transactions</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-189"><a href="#cb13-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lost_Money =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Lost.money</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-190"><a href="#cb13-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Requested_PIN =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Agent.wanted.you.to.reveal.your.PIN.number</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-191"><a href="#cb13-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_Problems =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X10.1.In.the.past.12.months.have.you.experienced.any.of.the.following.when.you.wanted.to.use.mobile.money._Any.other.problem</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-192"><a href="#cb13-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_Access =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..You.can.use.or.access.your.moneylender.whenever.you.need.to</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-193"><a href="#cb13-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_TreatsWell =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Your.moneylender.always.treats.you.well</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-194"><a href="#cb13-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_InfoClear =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Before.you.took.out.a.loan.with.your.moneylender..you.got.as.much.info.as.needed.and.it.was.easy.to.understand</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-195"><a href="#cb13-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_NeedsMet =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..The.products.and.services.offered.by.your.moneylender.meets.your.financial.needs</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-196"><a href="#cb13-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_FeesReasonable =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..Your.moneylender.s.fees.and.charges.are.reasonable</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-197"><a href="#cb13-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_CustomerSupport =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">X4b.Please.tell.me.which.of.the.following.statements.you.agree.with..You.are.satisfied.with.your.moneylender.s.customer.support</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-198"><a href="#cb13-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">Banked =</span> <span class="fu">ifelse</span>(Banked <span class="sc">==</span> <span class="st">"Banked"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-199"><a href="#cb13-199" aria-hidden="true" tabindex="-1"></a>    <span class="at">MFI =</span> <span class="fu">ifelse</span>(MFI <span class="sc">==</span> <span class="st">"MFI"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-200"><a href="#cb13-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">PENSION =</span> <span class="fu">ifelse</span>(PENSION <span class="sc">==</span> <span class="st">"PENSION"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-201"><a href="#cb13-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">INSURANCE =</span> <span class="fu">ifelse</span>(INSURANCE <span class="sc">==</span> <span class="st">"INSURANCE"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-202"><a href="#cb13-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">SACCO =</span> <span class="fu">ifelse</span>(SACCO <span class="sc">==</span> <span class="st">"SACCO"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-203"><a href="#cb13-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">CAPITALM_FUND_MANAGERS =</span> <span class="fu">ifelse</span>(CAPITALM_FUND_MANAGERS <span class="sc">==</span> <span class="st">"CAPITALM_FUND_MANAGERS"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-204"><a href="#cb13-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">FORM_INVESTMENTS =</span> <span class="fu">ifelse</span>(FORM_INVESTMENTS <span class="sc">==</span> <span class="st">"FORM_INVESTMENTS"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-205"><a href="#cb13-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">CMG =</span> <span class="fu">ifelse</span>(CMG <span class="sc">==</span> <span class="st">"CMG"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-206"><a href="#cb13-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">INFORMAL_MONEYLENDER =</span> <span class="fu">ifelse</span>(INFORMAL_MONEYLENDER <span class="sc">==</span> <span class="st">"INFORMAL_MONEYLENDER"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb13-207"><a href="#cb13-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">SOCIAL_GROUPS =</span> <span class="fu">ifelse</span>(SOCIAL_GROUPS <span class="sc">==</span> <span class="st">"SOCIAL_GROUPS"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb13-208"><a href="#cb13-208" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We will ensure these newly encoded variables are numeric format and all NA will be replaced by 0.</p>
<p>Then we will aggregate the one hot encoded variables to group by district since our analysis on district level and not on each respondent level.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tanzania_onehotencoded <span class="ot">&lt;-</span> tanzania_onehotencoded <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="dv">182</span><span class="sc">:</span><span class="dv">191</span>,<span class="dv">197</span><span class="sc">:</span><span class="dv">373</span>), <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(., <span class="dv">0</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>District Level Transformation (Group by)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Cluster type</td>
<td>Percentage of Urban for each district ( to reduce multicollinearity in regression as Rural and Urban will add up to 1, we will only choose one out of the two)</td>
</tr>
<tr class="even">
<td>Respondent gender</td>
<td><p>Ratio of Male vs Female (1: equal number, &lt;1: less Male than Female, &gt;1: More Male than Female, 0: No male in this district)</p>
<p>*To reduce multicollinearity, we will not be using the same denominator, number of total respondents in district, as we did in Cluster type.</p></td>
</tr>
<tr class="odd">
<td>Education Background</td>
<td>Ratio of poeple with No Formal Education vs other categories of education fromPrimary ~ University (1: equal number, &lt;1: less people with no formal education than people with some formal education, &gt;1: More people with no formal education than people with some formal education, 0: All respondents have some kind of education in this district; there is no one without)</td>
</tr>
<tr class="even">
<td>Access to Mobile Phone, Internet and Laptop</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Financial Documents owned</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Source of Money to Start Business</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>If Business is registered with government and if it is not, why</td>
<td><p>Ratio of Registered Businesses vs Not Registered (1: equal number, &lt;1: less Registered Businesses than Not, &gt;1: More Registered Businesses than Not, 0: No registered business in this district)</p>
<p>Sum/Count of each ‘No’ category for each district</p></td>
</tr>
<tr class="even">
<td>Respondent’s main income source</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Who they discuss their financial matters with</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>What they did when they could not meet spending needs</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Whether respondent is comfortable with banks</td>
<td>Ratio of People comfortable with Banks vs Not comfortable (1: equal number, &lt;1: less people comfortable with banks than Not, &gt;1: More people comfortable with banks than Not, 0: No one is comfortable with banks in this district)</td>
</tr>
<tr class="even">
<td>Financial Education</td>
<td>Ratio of People that received financial education vs No financial education (1: equal number, &lt;1: less people received financial edcation than Not, &gt;1: More people received financial education than Not, 0: No one received financial education in this district)</td>
</tr>
<tr class="odd">
<td>Retirement plans</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Confidence in financial institutions</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>If they are paying back money they owe within a year</td>
<td>Ratio of People that currently owes money vs people that does not (1: equal number, &lt;1: less people currently owe money than Not, &gt;1: More people currently owe money than Not, 0: No one currentlyn owe in this district)</td>
</tr>
<tr class="even">
<td>If they have borrowed money from any financial institutions</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>How often a respondent use the payment type for purchases</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Assistance from Government or NGO and problems they face receiving assistance</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Reporting problems regarding financial matters</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>Confidence and Trust in Insurance Companies</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Insurance ownership and type of insurance</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>If they have any issues accessing financial products</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="odd">
<td>Access and relationship with moneylender</td>
<td>Sum/Count of each category for each district</td>
</tr>
<tr class="even">
<td>If respondent is involved with a Bank, MFI, PENSION, INSURANCE, SACCO, CAPITAL Fund Managers, FORMAL INVESTMEN, CMG, INFORMAL MONEYLENDER or apart of a Social group</td>
<td>Percentage of Yes for each district( to reduce multicollinearity in regression as Yes and No will add up to 1, we will only choose one out of the two)</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>categorical_var <span class="ot">&lt;-</span> tanzania_onehotencoded <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dist_name) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Urban =</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(Rural, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">sum</span>(Urban, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(Rural, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    ), <span class="co"># Percentage of Urban</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Male_Female_Ratio =</span><span class="fu">sum</span>(Male, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(Female, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Percentage of Male</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Registered_YesNo_Ratio =</span><span class="fu">sum</span>(BusinessRegistered_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(BusinessRegistered_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>, <span class="co"># Ratio of Registered Businesses vs Not Registered</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ComfortableBank_YesNo_Ratio =</span><span class="fu">sum</span>(ComfortableWithBank_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(ComfortableWithBank_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of Comfortable with Bank vs Not Comfortable</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">FinancialEducation_YesNo_Ratio =</span><span class="fu">sum</span>(ReceivedFinancialEducation_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(ReceivedFinancialEducation_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of People Received Financial Education vs No Financial Education</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">PayingBack_YesNo_Ratio =</span><span class="fu">sum</span>(PayingBack_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(PayingBack_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># Ratio of People that currently owes money vs people that does not</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Banked =</span> <span class="fu">sum</span>(Banked, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of Banked</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">MFI =</span> <span class="fu">sum</span>(MFI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of MFI</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">PENSION =</span> <span class="fu">sum</span>(PENSION, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of Pension</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">INSURANCE =</span> <span class="fu">sum</span>(INSURANCE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of Insurance</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">SACCO =</span> <span class="fu">sum</span>(SACCO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of SACCO</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">CAPITALM_FUND_MANAGERS =</span> <span class="fu">sum</span>(CAPITALM_FUND_MANAGERS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of CAPITALM_FUND_MANAGERS</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">FORM_INVESTMENTS =</span> <span class="fu">sum</span>(FORM_INVESTMENTS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of FORM_INVESTMENTS</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">CMG =</span> <span class="fu">sum</span>(CMG, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of CMG</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">INFORMAL_MONEYLENDER =</span> <span class="fu">sum</span>(INFORMAL_MONEYLENDER, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of INFORMAL_MONEYLENDER</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">SOCIAL_GROUPS =</span> <span class="fu">sum</span>(SOCIAL_GROUPS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">n</span>(), <span class="co"># Percentage of SOCIAL_GROUPS</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoEdu_SomeEdu =</span> <span class="fu">sum</span>(NoFormalEducation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">sum</span>(SomePrimary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span><span class="fu">sum</span>(PrimaryCompleted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(PostPrimaryTechnicalTraining, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SomeSecondary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SecondaryCompleted_OLevel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(SomeUniversityOrHigherEducation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">sum</span>(UniversityOrHigherEducationCompleted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">MobilePhone =</span> <span class="fu">sum</span>(MobilePhone, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">Internet =</span> <span class="fu">sum</span>(Laptop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Laptop =</span> <span class="fu">sum</span>(Laptop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">BankMFIStatement =</span> <span class="fu">sum</span>(BankMFIStatement, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Subscription =</span> <span class="fu">sum</span>(Subscription, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">TaxIDNumber =</span> <span class="fu">sum</span>(TaxIDNumber, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">InsurancePolicy =</span> <span class="fu">sum</span>(InsurancePolicy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">PaySlip =</span> <span class="fu">sum</span>(PaySlip, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">TitleDeed =</span> <span class="fu">sum</span>(TitleDeed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">CertofOccupancy =</span> <span class="fu">sum</span>(CertofOccupancy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">InsuranceCard =</span> <span class="fu">sum</span>(InsuranceCard, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_BankLoan =</span> <span class="fu">sum</span>(MoneyforBusiness_BankLoan, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SACCOSLoan =</span> <span class="fu">sum</span>(MoneyforBusiness_SACCOSLoan, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_CMGSLoan =</span> <span class="fu">sum</span>(MoneyforBusiness_CMGSLoan, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_FamilyFriendsLoan =</span> <span class="fu">sum</span>(MoneyforBusiness_FamilyFriendsLoan, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_FamilyFriendsGift =</span> <span class="fu">sum</span>(MoneyforBusiness_FamilyFriendsGift, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_Inheritance =</span> <span class="fu">sum</span>(MoneyforBusiness_Inheritance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SaleOfAssets =</span> <span class="fu">sum</span>(MoneyforBusiness_SaleOfAssets, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">MoneyforBusiness_SavingsOrSalary =</span> <span class="fu">sum</span>(MoneyforBusiness_SavingsOrSalary, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_Yes =</span> <span class="fu">sum</span>(BusinessRegistered_Yes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessRegistered_No =</span> <span class="fu">sum</span>(BusinessRegistered_No, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">TriedButNot =</span> <span class="fu">sum</span>(TriedButNot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoTime =</span> <span class="fu">sum</span>(NoTime, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoMoney =</span> <span class="fu">sum</span>(NoMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">TooComplicated =</span> <span class="fu">sum</span>(TooComplicated, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoBenefit =</span> <span class="fu">sum</span>(NoBenefit, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">BusinessTooSmall =</span> <span class="fu">sum</span>(BusinessTooSmall, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">NoPayment =</span> <span class="fu">sum</span>(NoPayment, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">DontKnowHow =</span> <span class="fu">sum</span>(DontKnowHow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">RegistrationInProcess =</span> <span class="fu">sum</span>(RegistrationInProcess, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Formal_sector_salaried =</span> <span class="fu">sum</span>(Formal_sector_salaried, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Informal_sector_salaried =</span> <span class="fu">sum</span>(Informal_sector_salaried, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Farmers_and_fishers_Inncome =</span> <span class="fu">sum</span>(Farmers_and_fishers_Inncome, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Traders_agricultural_products_Income =</span> <span class="fu">sum</span>(Traders_agricultural_products_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Traders_non_agricultural_Income =</span> <span class="fu">sum</span>(Traders_non_agricultural_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Service_providers_Income =</span> <span class="fu">sum</span>(Service_providers_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Piece_work_casual_labor_Income =</span> <span class="fu">sum</span>(Piece_work_casual_labor_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Rental_Income =</span> <span class="fu">sum</span>(Rental_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">Interest_from_savings_investments_stocks_unit_trusts =</span> <span class="fu">sum</span>(Interest_from_savings_investments_stocks_unit_trusts, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pension_Income =</span> <span class="fu">sum</span>(Pension_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">Welfare_Income =</span> <span class="fu">sum</span>(Welfare_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gambling_Income =</span> <span class="fu">sum</span>(Gambling_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dependents_Income =</span> <span class="fu">sum</span>(Dependents_Income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">OtherIncome =</span> <span class="fu">sum</span>(OtherIncome, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_HouseholdMember =</span> <span class="fu">sum</span>(Advice_HouseholdMember, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FamilyMember =</span> <span class="fu">sum</span>(Advice_FamilyMember, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Employer =</span> <span class="fu">sum</span>(Advice_Employer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Bank =</span> <span class="fu">sum</span>(Advice_Bank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Microfinance =</span> <span class="fu">sum</span>(Advice_Microfinance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SACCOS =</span> <span class="fu">sum</span>(Advice_SACCOS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FinancialAdvisor =</span> <span class="fu">sum</span>(Advice_FinancialAdvisor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_FarmersAssociation =</span> <span class="fu">sum</span>(Advice_FarmersAssociation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_BusinessAssociation =</span> <span class="fu">sum</span>(Advice_BusinessAssociation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_SavingsGroup =</span> <span class="fu">sum</span>(Advice_SavingsGroup, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_Moneylender =</span> <span class="fu">sum</span>(Advice_Moneylender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_GovernmentOfficial =</span> <span class="fu">sum</span>(Advice_GovernmentOfficial, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_VillageElder =</span> <span class="fu">sum</span>(Advice_VillageElder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_OtherSpecify =</span> <span class="fu">sum</span>(Advice_OtherSpecify, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">Advice_NoOne =</span> <span class="fu">sum</span>(Advice_NoOne, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">UsedSavings =</span> <span class="fu">sum</span>(UsedSavings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromBank =</span> <span class="fu">sum</span>(BorrowedFromBank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedThroughMM =</span> <span class="fu">sum</span>(BorrowedThroughMM, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromMoneyLender =</span> <span class="fu">sum</span>(BorrowedFromMoneyLender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFromFriendFamily =</span> <span class="fu">sum</span>(BorrowedFromFriendFamily, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">GotAssistanceFromFamily =</span> <span class="fu">sum</span>(GotAssistanceFromFamily, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">SoldLivestock =</span> <span class="fu">sum</span>(SoldLivestock, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">CutSpending =</span> <span class="fu">sum</span>(CutSpending, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">WorkedMore =</span> <span class="fu">sum</span>(WorkedMore, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_CouldntMeetNeeds =</span> <span class="fu">sum</span>(Others_CouldntMeetNeeds, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_Savings =</span> <span class="fu">sum</span>(Old_Savings, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_ChildrenWillTakeCareOfMe =</span> <span class="fu">sum</span>(Old_ChildrenWillTakeCareOfMe, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_MoneyFromFriendsRelatives =</span> <span class="fu">sum</span>(Old_MoneyFromFriendsRelatives, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_LandProperty =</span> <span class="fu">sum</span>(Old_LandProperty, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_OwnBusiness =</span> <span class="fu">sum</span>(Old_OwnBusiness, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_RentalIncome =</span> <span class="fu">sum</span>(Old_RentalIncome, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_DividendsFromShares =</span> <span class="fu">sum</span>(Old_DividendsFromShares, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_FarmingAgricultureLivestock =</span> <span class="fu">sum</span>(Old_FarmingAgricultureLivestock, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_Pension =</span> <span class="fu">sum</span>(Old_Pension, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_InsurancePolicy =</span> <span class="fu">sum</span>(Old_InsurancePolicy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">Old_NoPlans =</span> <span class="fu">sum</span>(Old_NoPlans, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithBanks =</span> <span class="fu">sum</span>(ConfidentWithBanks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMFIs =</span> <span class="fu">sum</span>(ConfidentWithMFIs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSACCOs =</span> <span class="fu">sum</span>(ConfidentWithSACCOs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithMobileMoney =</span> <span class="fu">sum</span>(ConfidentWithMobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithPensionFund =</span> <span class="fu">sum</span>(ConfidentWithPensionFund, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithSavingsGroups =</span> <span class="fu">sum</span>(ConfidentWithSavingsGroups, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithFamilyFriends =</span> <span class="fu">sum</span>(ConfidentWithFamilyFriends, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">ConfidentWithUTTs =</span> <span class="fu">sum</span>(ConfidentWithUTTs, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Bank =</span> <span class="fu">sum</span>(BorrowedFrom_Bank, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MFI =</span> <span class="fu">sum</span>(BorrowedFrom_MFI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SACCO =</span> <span class="fu">sum</span>(BorrowedFrom_SACCO, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-118"><a href="#cb15-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_MobileMoney =</span> <span class="fu">sum</span>(BorrowedFrom_MobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-119"><a href="#cb15-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_PensionFund =</span> <span class="fu">sum</span>(BorrowedFrom_PensionFund, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-120"><a href="#cb15-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Employer =</span> <span class="fu">sum</span>(BorrowedFrom_Employer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-121"><a href="#cb15-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_PayBack =</span> <span class="fu">sum</span>(BorrowedFrom_Family_PayBack, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-122"><a href="#cb15-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_Family_NoPayBack =</span> <span class="fu">sum</span>(BorrowedFrom_Family_NoPayBack, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-123"><a href="#cb15-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_SavingsGroup =</span> <span class="fu">sum</span>(BorrowedFrom_SavingsGroup, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-124"><a href="#cb15-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_CommunityLender =</span> <span class="fu">sum</span>(BorrowedFrom_CommunityLender, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-125"><a href="#cb15-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">BorrowedFrom_OtherSource =</span> <span class="fu">sum</span>(BorrowedFrom_OtherSource, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-126"><a href="#cb15-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cash =</span> <span class="fu">sum</span>(Used_Cash, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-127"><a href="#cb15-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_ATM_DebitCard =</span> <span class="fu">sum</span>(Used_ATM_DebitCard, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-128"><a href="#cb15-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_CreditCard =</span> <span class="fu">sum</span>(Used_CreditCard, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-129"><a href="#cb15-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_MobileMoney =</span> <span class="fu">sum</span>(Used_MobileMoney, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-130"><a href="#cb15-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_Cryptocurrency =</span> <span class="fu">sum</span>(Used_Cryptocurrency, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-131"><a href="#cb15-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_QR_Code =</span> <span class="fu">sum</span>(Used_QR_Code, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-132"><a href="#cb15-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_POS =</span> <span class="fu">sum</span>(Used_POS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-133"><a href="#cb15-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_LipaNamba =</span> <span class="fu">sum</span>(Used_LipaNamba, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-134"><a href="#cb15-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">Used_AZAMPay =</span> <span class="fu">sum</span>(Used_AZAMPay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-135"><a href="#cb15-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">Basic_TASAF_Cash_Transfer =</span> <span class="fu">sum</span>(Basic_TASAF_Cash_Transfer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-136"><a href="#cb15-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">Additional_Conditional_TASAF_Cash_Transfer =</span> <span class="fu">sum</span>(Additional_Conditional_TASAF_Cash_Transfer, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-137"><a href="#cb15-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pension_for_Elders =</span> <span class="fu">sum</span>(Pension_for_Elders, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-138"><a href="#cb15-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">Others_Assistance =</span> <span class="fu">sum</span>(Others_Assistance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-139"><a href="#cb15-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">Payment_Was_Late =</span> <span class="fu">sum</span>(Payment_Was_Late, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-140"><a href="#cb15-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">Gave_Money_To_Official =</span> <span class="fu">sum</span>(Gave_Money_To_Official, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-141"><a href="#cb15-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">Money_Didnt_Come =</span> <span class="fu">sum</span>(Money_Didnt_Come, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-142"><a href="#cb15-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">Received_Less_Money =</span> <span class="fu">sum</span>(Received_Less_Money, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">Household_Not_On_Register =</span> <span class="fu">sum</span>(Household_Not_On_Register, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-144"><a href="#cb15-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">Unable_To_Collection_Point =</span> <span class="fu">sum</span>(Unable_To_Collection_Point, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-145"><a href="#cb15-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">No_Proof_Of_Identity =</span> <span class="fu">sum</span>(No_Proof_Of_Identity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-146"><a href="#cb15-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Know_Where_To_Go =</span> <span class="fu">sum</span>(Do_Not_Know_Where_To_Go, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-147"><a href="#cb15-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">Places_Not_In_My_Area =</span> <span class="fu">sum</span>(Places_Not_In_My_Area, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-148"><a href="#cb15-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">Do_Not_Think_They_Care =</span> <span class="fu">sum</span>(Do_Not_Think_They_Care, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-149"><a href="#cb15-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">Trust_Insurance_Companies =</span> <span class="fu">sum</span>(Trust_Insurance_Companies, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-150"><a href="#cb15-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">Insurance_Good_Idea =</span> <span class="fu">sum</span>(Insurance_Good_Idea, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-151"><a href="#cb15-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">Need_Insurance =</span> <span class="fu">sum</span>(Need_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-152"><a href="#cb15-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">Have_Insurance_Cover =</span> <span class="fu">sum</span>(Have_Insurance_Cover,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-153"><a href="#cb15-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">Motor_Vehicle_Insurance =</span> <span class="fu">sum</span>(Motor_Vehicle_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-154"><a href="#cb15-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">Households_Contents_Insurance =</span> <span class="fu">sum</span>(Households_Contents_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-155"><a href="#cb15-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">Private_Health_Insurance =</span> <span class="fu">sum</span>(Private_Health_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-156"><a href="#cb15-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">National_Health_Insurance =</span> <span class="fu">sum</span>(National_Health_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-157"><a href="#cb15-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">Community_Health_Insurance =</span> <span class="fu">sum</span>(Community_Health_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-158"><a href="#cb15-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">TIKA_Insurance =</span> <span class="fu">sum</span>(TIKA_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-159"><a href="#cb15-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">Social_Health_Insurance =</span> <span class="fu">sum</span>(Social_Health_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-160"><a href="#cb15-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">Personal_Accident_Insurance =</span> <span class="fu">sum</span>(Personal_Accident_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-161"><a href="#cb15-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">Life_Insurance =</span> <span class="fu">sum</span>(Life_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-162"><a href="#cb15-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">Loan_Insurance =</span> <span class="fu">sum</span>(Loan_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-163"><a href="#cb15-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">Building_Insurance =</span> <span class="fu">sum</span>(Building_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-164"><a href="#cb15-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">Education_Policy =</span> <span class="fu">sum</span>(Education_Policy, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-165"><a href="#cb15-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">Funeral_Cover =</span> <span class="fu">sum</span>(Funeral_Cover, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-166"><a href="#cb15-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agricultural_Insurance =</span> <span class="fu">sum</span>(Agricultural_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-167"><a href="#cb15-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ushirika_Afya =</span> <span class="fu">sum</span>(Ushirika_Afya, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-168"><a href="#cb15-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">Motorcycle_Insurance =</span> <span class="fu">sum</span>(Motorcycle_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-169"><a href="#cb15-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">Livestock_Insurance =</span> <span class="fu">sum</span>(Livestock_Insurance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-170"><a href="#cb15-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_Insurance_Products =</span> <span class="fu">sum</span>(Other_Insurance_Products, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-171"><a href="#cb15-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">Network_Failure =</span> <span class="fu">sum</span>(Network_Failure, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-172"><a href="#cb15-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Absent =</span> <span class="fu">sum</span>(Agent_Absent, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-173"><a href="#cb15-173" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_No_Cash_Float =</span> <span class="fu">sum</span>(Agent_No_Cash_Float, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-174"><a href="#cb15-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Overcharged =</span> <span class="fu">sum</span>(Agent_Overcharged, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-175"><a href="#cb15-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lost_Money =</span> <span class="fu">sum</span>(Lost_Money, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-176"><a href="#cb15-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">Agent_Requested_PIN =</span> <span class="fu">sum</span>(Agent_Requested_PIN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-177"><a href="#cb15-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">Other_Problems =</span> <span class="fu">sum</span>(Other_Problems, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-178"><a href="#cb15-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_Access =</span> <span class="fu">sum</span>(Moneylender_Access, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-179"><a href="#cb15-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_TreatsWell =</span> <span class="fu">sum</span>(Moneylender_TreatsWell, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-180"><a href="#cb15-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_InfoClear =</span> <span class="fu">sum</span>(Moneylender_InfoClear, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-181"><a href="#cb15-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_NeedsMet =</span> <span class="fu">sum</span>(Moneylender_NeedsMet, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-182"><a href="#cb15-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_FeesReasonable =</span> <span class="fu">sum</span>(Moneylender_FeesReasonable, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-183"><a href="#cb15-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">Moneylender_CustomerSupport =</span> <span class="fu">sum</span>(Moneylender_CustomerSupport, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-184"><a href="#cb15-184" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="continuous-variables" class="level2">
<h2 class="anchored" data-anchor-id="continuous-variables">5.2 Continuous Variables</h2>
<p>The following are the continuous variables for our initial model:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 82%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Variable</strong></th>
<th><strong>Justification for Selection</strong></th>
<th>District Level (Group by)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Age</td>
<td>Age is a critical demographic variable that often influences various socio-economic outcomes. It can affect financial behaviors, access to resources, and the types of assistance individuals might require.Research indicates that younger individuals may be more inclined to take risks and invest in education or business ventures, while older individuals might focus on savings and retirement planning</td>
<td>Mean Age at each district</td>
</tr>
<tr class="even">
<td>Amount Owed</td>
<td>The&nbsp;Amount Owed&nbsp;is a crucial indicator of an individual’s financial obligations and overall debt situation, which directly impacts financial inclusion and well-being. High levels of debt can signal financial distress and can limit individuals’ ability to access additional credit or financial services. Understanding the average amount owed at the district level helps identify areas where residents may be over-leveraged, affecting their financial stability and decision-making capabilities.</td>
<td>Mean Amount Owed at each district</td>
</tr>
<tr class="odd">
<td>Money Spent on Betting</td>
<td>Studies show that excessive gambling can lead to financial distress and lower overall financial health (Koomson et al., 2022). Lower spending may lead to better financial health and inclusion.</td>
<td>Mean Money Spent on Betting at each district</td>
</tr>
<tr class="even">
<td>Number of Saving Groups respondent belong to</td>
<td>Higher participation in savings groups typically correlates with better savings rates and financial stability. Groups provide social support and financial education.</td>
<td>Total Number of Savings Group at each district</td>
</tr>
<tr class="odd">
<td>Contribution to Saving Groups</td>
<td>Regular contributions can lead to increased savings and financial stability, improving access to credit and financial services.</td>
<td>Total Contribution to Saving Groups for each district</td>
</tr>
</tbody>
</table>
<p>For these four continuous variables, we will prepare the data in the following steps:</p>
<ul>
<li><p>Rename the variables</p></li>
<li><p>Replace NA values with 0, Except for Age (Age 0 does not make logical sense, Therefore the missing ones will be replaced with the mean_age of the whole dataset excluding NA values which is 39)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mean_age <span class="ot">&lt;-</span> <span class="fu">mean</span>(tanzania<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>mean_age</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 39.67635</code></pre>
</div>
</div></li>
<li><p>Ensure they are in numeric format</p></li>
<li><p>Remove 3 observations that states that they belong to 150000, 16000 and 2000 social groups which are outliers.</p></li>
<li><p>Derive the district level variable</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tanzania <span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Age)), <span class="dv">39</span>)),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount_Owed =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(G.<span class="dv">2</span>.<span class="dv">6</span>..Approximately.how.much.money.do.you.owe..in.TZS)), <span class="dv">0</span>)),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Amount_Betting =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X17c.On.average..how.much.do.you.spend.on.betting.in.a.month.)), <span class="dv">0</span>)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group_Belong =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X4.<span class="fl">3.</span>How.many.savings.groups.do.you.belong.to.in.total.)), <span class="dv">0</span>)),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group_Contribution =</span> <span class="fu">as.numeric</span>(<span class="fu">replace_na</span>(<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X4.<span class="fl">8.</span>How.much.do.you.contribute.in.total..to.all.the.groups.you.belong..in.a.mont)), <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>Group_Belong <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">150000</span>,<span class="dv">16000</span>,<span class="dv">2000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>continuous_var <span class="ot">&lt;-</span> tanzania <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dist_name) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_Age =</span> <span class="fu">mean</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_AmountOwed =</span> <span class="fu">mean</span>(Amount_Owed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_AmountBetting =</span> <span class="fu">mean</span>(Amount_Betting, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_GroupBelong =</span> <span class="fu">sum</span>(Group_Belong, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_GroupContribution =</span> <span class="fu">sum</span>(Group_Contribution, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will combine the categorical and continuous variable dataframe to derive the final dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tanzania_combined <span class="ot">&lt;-</span> categorical_var <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(continuous_var, <span class="at">by =</span> <span class="st">"dist_name"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="left-join" class="level2">
<h2 class="anchored" data-anchor-id="left-join">5.3 Left Join</h2>
<p>Next, we will create a layer by left joining the geospatial dataframe (tanzbound) to the attribute dataframe (tanzania) by using <strong><em>left_join()</em></strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
To perform a left_join(), we must ensure that there is a common column between the two. For our case, the common column is ‘dist_name’
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tanzbounds,tanzania_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We noted that the geometry column is in MULTIPOLYGON format. For GWR analysis later on, we will need&nbsp;point geometries&nbsp;to represent specific locations. Leaving the geometry as MULTIPOLYGON can negatively affect the GWR analysis, as the model requires precise locations for its local regression estimations.We will use st_centroid to find the centroid points of each district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned<span class="sc">$</span>centroids <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(tanzania_cleaned<span class="sc">$</span>geometry)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geometry =</span> centroids) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tanzania_cleaned,<span class="st">"data/rds/tanzania_cleaned"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tanzania_cleaned"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will visualize the points with <strong>tmap</strong> to ensure they are properly placed (not in water).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tanzbounds) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border.col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(tanzania_cleaned<span class="sc">$</span>geometry) <span class="sc">+</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="fl">0.03</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Centroids of Districts in Tanzania"</span>, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.position =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"top"</span>),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title.size =</span> <span class="fl">0.8</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="the-dependent-variable" class="level2">
<h2 class="anchored" data-anchor-id="the-dependent-variable">6 The Dependent Variable</h2>
<section id="financial-inclusion-in-tanzania" class="level3">
<h3 class="anchored" data-anchor-id="financial-inclusion-in-tanzania"><strong>6.1.1 Financial Inclusion in Tanzania</strong></h3>
<p>Financial inclusion refers to the process of ensuring that individuals and businesses have access to affordable and useful financial products and services that meet their needs—ranging from transactions, payments, savings, and credit to insurance. According to the World Bank, financial inclusion is a “key enabler in reducing poverty and boosting shared prosperity by providing the unbanked and underserved populations access to essential financial services” (World Bank, 2023).</p>
<p>A robust financial inclusion system allows individuals to manage risks, invest in education, and build sustainable livelihoods. In Tanzania, financial inclusion is especially critical for rural populations, where access to traditional banking infrastructure is limited. Many rely on informal financial services, which can hinder their ability to seize economic opportunities. The growth of digital financial services, particularly mobile money, has dramatically expanded financial inclusion across Sub-Saharan Africa, enabling millions to access financial products without needing to visit a physical bank (World Bank Group, 2024).</p>
<p>Despite significant progress, the uneven distribution of financial services between rural and urban areas underscores the need to examine the factors driving financial inclusion at a local level. Understanding these determinants is essential for enhancing access to financial services and fostering inclusive economic development. This study aims to derive a dependent variable representing financial inclusion from the FinScope dataset, focusing on key financial behaviors.</p>
</section>
<section id="deriving-the-dependent-variable---financial-inclusion-index" class="level3">
<h3 class="anchored" data-anchor-id="deriving-the-dependent-variable---financial-inclusion-index"><strong>6.1.2 Deriving The Dependent Variable - Financial Inclusion Index</strong></h3>
<p>Research by Demirgüç-Kunt and Klapper (World Bank,2018) indicates that financial inclusion is multi-dimensional, encompassing access to credit, savings, and various financial services. Composite indices, such as the Global Financial Inclusion Index, often aggregate multiple financial behaviors to capture the complexity of financial inclusion.</p>
<p>The <strong>Financial Participation and Access Index (FPAI)</strong> is a composite measure that captures the extent of financial inclusion by aggregating various financial service utilizations across multiple sources. By averaging the proportions of individuals engaged with formal banking institutions, microfinance institutions (MFIs), pension plans, insurance products, savings and credit cooperatives (SACCOs), capital market fund managers, formal investments, community-managed groups (CMGs), informal moneylenders, and social groups, the FPAI provides a holistic view of financial participation. This comprehensive approach reflects not only access to formal financial services but also the utilization of informal financial mechanisms, which are critical for households that may be underserved by traditional banking. Therefore, the FPAI effectively represents financial inclusion as it quantifies the diversity and breadth of financial engagements within the community, highlighting both formal and informal avenues that contribute to economic resilience and stability.</p>
<p><span class="math inline">\(FPAI_i=(Banked_i+MFI_i+PENSION_i+INSURANCE_i+SACCO_i+CAPITALM FUND MANAGERS_i+FORM INVESTMENTS_i+CMG_i+INFORMALMONEYLENDER_i+SOCIALGROUPS_i​)/10\)</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Banked_i\)</span> = Portion of individuals of that particular district i involved in formal banking institutions</p></li>
<li><p><span class="math inline">\(MFI​_i\)</span> = Portion of individuals of that particular district i involved in MFI</p></li>
<li><p><span class="math inline">\(PENSION_i\)</span>= Portion of individuals of that particular district i involved in pension</p></li>
<li><p><span class="math inline">\(INSURANCE_i\)</span>= Portion of individuals of that particular district i involved in insurance</p></li>
<li><p><span class="math inline">\(SACCO_i\)</span>= Portion of individuals of that particular district i involved in SACCO</p></li>
<li><p><span class="math inline">\(CAPITALMFUNDMANAGERS_i\)</span>= Portion of individuals of that particular district i involved with capital fund managers</p></li>
<li><p><span class="math inline">\(FORMINVESTMENT_i\)</span>= Portion of individuals of that particular district i involved in formal investments</p></li>
<li><p><span class="math inline">\(CMG_i\)</span>= Portion of individuals of that particular district i involved in CMG</p></li>
<li><p><span class="math inline">\(INFORMALMONEYLENDER_i\)</span>= Portion of individuals of that particular district i involved with informal money lender</p></li>
<li><p><span class="math inline">\(SOCIALGROUPS_I\)</span>= Portion of individuals of that particular district i involved in social groups</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FPAI =</span> (Banked <span class="sc">+</span> MFI <span class="sc">+</span> PENSION <span class="sc">+</span> INSURANCE <span class="sc">+</span> SACCO <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                 CAPITALM_FUND_MANAGERS <span class="sc">+</span> FORM_INVESTMENTS <span class="sc">+</span> CMG <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                 INFORMAL_MONEYLENDER <span class="sc">+</span> SOCIAL_GROUPS) <span class="sc">/</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dependent-variable-implications" class="level3">
<h3 class="anchored" data-anchor-id="dependent-variable-implications">6.1.3 Dependent Variable Implications</h3>
<ul>
<li><p><strong>Higher FPAI Values:</strong></p>
<ul>
<li><p>A higher FPAI indicates greater financial inclusion, suggesting that individuals have access to and utilize a diverse range of financial services. This can include formal banking, microfinance institutions (MFIs), pensions, insurance, savings and credit cooperatives (SACCOs), capital fund managers, formal investments, and social groups.</p></li>
<li><p>Individuals with a higher FPAI are more likely to have better financial security, increased savings, and enhanced opportunities for investment and wealth accumulation. This can also indicate a stronger ability to cope with financial shocks and increased participation in economic activities.</p></li>
</ul></li>
<li><p><strong>Lower FPAI Values:</strong></p>
<ul>
<li><p>On the other hand, a lower FPAI suggests limited access to financial services, which may reflect a higher level of financial exclusion. Individuals with lower scores may rely primarily on informal financial sources, such as informal moneylenders or social groups, which can expose them to higher risks and less favorable financial conditions.</p></li>
<li><p>Low FPAI values can indicate potential barriers to financial inclusion, such as lack of financial literacy, limited access to formal financial institutions, or socio-economic challenges. This can lead to vulnerability in managing financial needs, lower savings rates, and decreased investment opportunities, potentially perpetuating cycles of poverty.</p></li>
</ul></li>
</ul>
<hr>
</section>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1>7 Exploratory Data Analysis (EDA)</h1>
<p>Exploratory Data Analysis (EDA) is a crucial step allowing us to uncover underlying patterns and identify anomalies in our cleaned dataset. EDA not only aids in formulating hypotheses but also guides feature selection and model building, ensuring that the subsequent analysis is robust and meaningful. In this section, we will explore our dataset through descriptive statistics, visualizations, and correlation analysis to derive insights that can inform our understanding of financial inclusion in Tanzania.</p>
<section id="descriptive-statistics-and-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics-and-visualizations">7.1 Descriptive Statistics and Visualizations</h2>
<section id="visualizing-dependent-variable" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-dependent-variable">7.1.1 Visualizing Dependent Variable</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">FPAI</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-plots-of-predictor-variables" class="level3">
<h3 class="anchored" data-anchor-id="histogram-plots-of-predictor-variables">7.1.2 Histogram Plots of Predictor Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_Age</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>Registered_YesNo_Ratio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Registered_YesNo_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>Male_Female_Ratio <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Male_Female_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>Urban <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Urban</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>Formal_sector_salaried <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Formal_sector_salaried</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>FinancialEducation <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">FinancialEducation_YesNo_Ratio</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>Mean_AmountBetting <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_AmountBetting</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>Mean_AmountOwed <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Mean_AmountOwed</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>MobilePhone <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">MobilePhone</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>Total_GroupContribution <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>tanzania_cleaned, <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">Total_GroupContribution</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"light blue"</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(Age, Registered_YesNo_Ratio, Male_Female_Ratio, Urban, Formal_sector_salaried, </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>          FinancialEducation, Mean_AmountBetting, Mean_AmountOwed,MobilePhone,Total_GroupContribution,</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">7.2 Correlation Analysis</h2>
<p>Since we have around 160 variables chosen, it is hard to visualize a correlation matrix. Therefore we will just display the highly correlated(pairs of variables with absolute correlations greater than 0.8) with the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>nogeom_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">st_drop_geometry</span>(tanzania_cleaned))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>cor_data <span class="ot">&lt;-</span> nogeom_df <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FPAI,dist_name, Banked, MFI, PENSION, INSURANCE, SACCO, CAPITALM_FUND_MANAGERS, FORM_INVESTMENTS,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>            CMG,INFORMAL_MONEYLENDER,SOCIAL_GROUPS, </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>            BankMFIStatement,Subscription,InsurancePolicy,TaxIDNumber,InsuranceCard,MoneyforBusiness_BankLoan,MoneyforBusiness_SACCOSLoan,MoneyforBusiness_CMGSLoan,BusinessRegistered_Yes,BusinessRegistered_No,Pension_Income,Advice_Bank,Advice_SACCOS,Advice_SavingsGroup,Advice_Moneylender,BorrowedFromBank,BorrowedFrom_SACCO,BorrowedFrom_MFI,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>            BorrowedFrom_PensionFund,BorrowedFrom_SavingsGroup,BorrowedFromMoneyLender,BorrowedFrom_Bank,BorrowedFrom_MFI,BorrowedFrom_SACCO,BorrowedFrom_PensionFund,BorrowedFrom_SavingsGroup,BorrowedFrom_CommunityLender,Have_Insurance_Cover</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>            ))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(cor_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>high_correlations <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(cor_matrix) <span class="sc">&gt;</span> <span class="fl">0.8</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>high_cor_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var1 =</span> <span class="fu">rownames</span>(cor_matrix)[high_correlations[, <span class="dv">1</span>]],</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Var2 =</span> <span class="fu">colnames</span>(cor_matrix)[high_correlations[, <span class="dv">2</span>]],</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Correlation =</span> cor_matrix[high_correlations]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>high_cor_df <span class="ot">&lt;-</span> high_cor_df <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Var1 <span class="sc">!=</span> Var2) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(high_cor_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following table shows the correlation pairs and the excluded variables highlighted in blue.The following code chunk will be used to remove the variables.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Var1</th>
<th>Var2</th>
<th>Correlation</th>
<th>Exclude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dependents_Income</td>
<td>MobilePhone</td>
<td>0.8415763</td>
<td>Dependents_Income</td>
</tr>
<tr class="even">
<td>Advice_HouseholdMember</td>
<td>MobilePhone</td>
<td>0.8957760</td>
<td>Advice_HouseholdMember</td>
</tr>
<tr class="odd">
<td>UsedSavings</td>
<td>MobilePhone</td>
<td>0.8785228</td>
<td>UsedSavings</td>
</tr>
<tr class="even">
<td>BorrowedFromFriendFamily</td>
<td>MobilePhone</td>
<td>0.8459579</td>
<td>BorrowedFromFriendFamily</td>
</tr>
<tr class="odd">
<td>GotAssistanceFromFamily</td>
<td>MobilePhone</td>
<td>0.8835694</td>
<td>GotAssistanceFromFamily</td>
</tr>
<tr class="even">
<td>CutSpending</td>
<td>MobilePhone</td>
<td>0.8235916</td>
<td>CutSpending</td>
</tr>
<tr class="odd">
<td>Old_NoPlans</td>
<td>MobilePhone</td>
<td>0.8171885</td>
<td>Old_NoPlans</td>
</tr>
<tr class="even">
<td>ConfidentWithBanks</td>
<td>MobilePhone</td>
<td>0.8273782</td>
<td>ConfidentWithBanks</td>
</tr>
<tr class="odd">
<td>ConfidentWithMobileMoney</td>
<td>MobilePhone</td>
<td>0.8617921</td>
<td>ConfidentWithMobileMoney</td>
</tr>
<tr class="even">
<td>Used_Cash</td>
<td>MobilePhone</td>
<td>0.9620748</td>
<td>Used_Cash</td>
</tr>
<tr class="odd">
<td>Used_MobileMoney</td>
<td>MobilePhone</td>
<td>0.8079097</td>
<td>Used_MobileMoney</td>
</tr>
<tr class="even">
<td>Do_Not_Know_Where_To_Go</td>
<td>MobilePhone</td>
<td>0.8345175</td>
<td>Do_Not_Know_Where_To_Go</td>
</tr>
<tr class="odd">
<td>Trust_Insurance_Companies</td>
<td>MobilePhone</td>
<td>0.8964594</td>
<td>Trust_Insurance_Companies</td>
</tr>
<tr class="even">
<td>Insurance_Good_Idea</td>
<td>MobilePhone</td>
<td>0.9238936</td>
<td>Insurance_Good_Idea</td>
</tr>
<tr class="odd">
<td>Network_Failure</td>
<td>MobilePhone</td>
<td>0.8569155</td>
<td>Network_Failure</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>   <span class="st">"Dependents_Income"</span>, <span class="st">"Advice_HouseholdMember"</span>, <span class="st">"UsedSavings"</span>, <span class="st">"BorrowedFromFriendFamily"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GotAssistanceFromFamily"</span>, <span class="st">"CutSpending"</span>, <span class="st">"Old_NoPlans"</span>, <span class="st">"ConfidentWithBanks"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ConfidentWithMobileMoney"</span>,<span class="st">"Used_Cash"</span>,<span class="st">"Used_MobileMoney"</span>, <span class="st">"Do_Not_Know_Where_To_Go"</span>, <span class="st">"Trust_Insurance_Companies"</span>,<span class="st">"Insurance_Good_Idea"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Network_Failure"</span>, <span class="st">"Laptop"</span>, <span class="st">"Farmers_and_fishers_Inncome"</span>, <span class="st">"Old_FarmingAgricultureLivestock"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BorrowedFrom_Family_PayBack"</span>, <span class="st">"Moneylender_Access"</span>, <span class="st">"Moneylender_TreatsWell"</span>, <span class="st">"Moneylender_InfoClear"</span>,<span class="st">"Moneylender_CustomerSupport"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Moneylender_NeedsMet"</span>, <span class="st">"Moneylender_FeesReasonable"</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"BankMFIStatement"</span>,<span class="st">"Subscription"</span>,<span class="st">"InsurancePolicy"</span>,<span class="st">"TaxIDNumber"</span>,<span class="st">"InsuranceCard"</span>,<span class="st">"MoneyforBusiness_BankLoan"</span>,<span class="st">"MoneyforBusiness_SACCOSLoan"</span>,<span class="st">"MoneyforBusiness_CMGSLoan"</span>,<span class="st">"BusinessRegistered_Yes"</span>,<span class="st">"BusinessRegistered_No"</span>,<span class="st">"Pension_Income"</span>,<span class="st">"Advice_Bank"</span>,<span class="st">"Advice_SACCOS"</span>,<span class="st">"Advice_SavingsGroup"</span>,<span class="st">"Advice_Moneylender"</span>,<span class="st">"BorrowedFromBank"</span>,<span class="st">"BorrowedFrom_SACCO"</span>,<span class="st">"BorrowedFrom_MFI"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"BorrowedFrom_PensionFund"</span>,<span class="st">"BorrowedFrom_SavingsGroup"</span>,<span class="st">"BorrowedFromMoneyLender"</span>,<span class="st">"BorrowedFrom_Bank"</span>,<span class="st">"BorrowedFrom_MFI"</span>,<span class="st">"BorrowedFrom_SACCO"</span>,<span class="st">"BorrowedFrom_PensionFund"</span>,<span class="st">"BorrowedFrom_SavingsGroup"</span>,<span class="st">"BorrowedFrom_CommunityLender"</span>,<span class="st">"Have_Insurance_Cover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will also conduct a VIF test to confirm correlation after building our first linear regression model later on.</p>
<hr>
</section>
</section>
<section id="multiple-linear-regression" class="level1">
<h1>8 Multiple Linear Regression</h1>
<section id="initial-model" class="level2">
<h2 class="anchored" data-anchor-id="initial-model">8.1 Initial Model</h2>
<p>We will construct our initial model using these derived variables and use summary() to check the initial model’s explanatory power.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Summary</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>tanzania.mlr <span class="ot">&lt;-</span> <span class="fu">lm</span>(FPAI <span class="sc">~</span> Urban <span class="sc">+</span> Male_Female_Ratio <span class="sc">+</span> Registered_YesNo_Ratio <span class="sc">+</span> ComfortableBank_YesNo_Ratio <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  FinancialEducation_YesNo_Ratio <span class="sc">+</span> PayingBack_YesNo_Ratio <span class="sc">+</span> NoEdu_SomeEdu <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  Internet <span class="sc">+</span> PaySlip <span class="sc">+</span> TitleDeed <span class="sc">+</span> CertofOccupancy <span class="sc">+</span> MoneyforBusiness_FamilyFriendsLoan <span class="sc">+</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  MoneyforBusiness_FamilyFriendsGift <span class="sc">+</span> MoneyforBusiness_Inheritance <span class="sc">+</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  MoneyforBusiness_SavingsOrSalary <span class="sc">+</span> TriedButNot <span class="sc">+</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  NoTime <span class="sc">+</span> NoMoney <span class="sc">+</span> TooComplicated <span class="sc">+</span> NoBenefit  <span class="sc">+</span> NoPayment <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  DontKnowHow <span class="sc">+</span> RegistrationInProcess <span class="sc">+</span> Informal_sector_salaried <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  Traders_agricultural_products_Income <span class="sc">+</span> Traders_non_agricultural_Income <span class="sc">+</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  Service_providers_Income <span class="sc">+</span> Piece_work_casual_labor_Income <span class="sc">+</span> Rental_Income <span class="sc">+</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  Interest_from_savings_investments_stocks_unit_trusts <span class="sc">+</span> Welfare_Income <span class="sc">+</span> Gambling_Income <span class="sc">+</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  OtherIncome <span class="sc">+</span> Advice_FamilyMember <span class="sc">+</span> Advice_Employer <span class="sc">+</span> Advice_Microfinance <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  Advice_FinancialAdvisor <span class="sc">+</span> Advice_FarmersAssociation <span class="sc">+</span> Advice_BusinessAssociation <span class="sc">+</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  Advice_GovernmentOfficial <span class="sc">+</span> Advice_VillageElder <span class="sc">+</span> Advice_OtherSpecify <span class="sc">+</span> Advice_NoOne <span class="sc">+</span> </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  SoldLivestock <span class="sc">+</span> Others_CouldntMeetNeeds <span class="sc">+</span> Old_Savings <span class="sc">+</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  Old_ChildrenWillTakeCareOfMe <span class="sc">+</span> Old_MoneyFromFriendsRelatives <span class="sc">+</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  Old_OwnBusiness <span class="sc">+</span> Old_RentalIncome <span class="sc">+</span> Old_DividendsFromShares <span class="sc">+</span> Old_Pension <span class="sc">+</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  Old_InsurancePolicy <span class="sc">+</span> ConfidentWithMFIs <span class="sc">+</span> ConfidentWithSACCOs <span class="sc">+</span> ConfidentWithPensionFund <span class="sc">+</span> </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  ConfidentWithSavingsGroups <span class="sc">+</span> ConfidentWithFamilyFriends <span class="sc">+</span> ConfidentWithUTTs <span class="sc">+</span> </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  BorrowedFrom_MobileMoney <span class="sc">+</span> BorrowedFrom_Employer <span class="sc">+</span> BorrowedFrom_Family_NoPayBack <span class="sc">+</span> </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  BorrowedFrom_OtherSource <span class="sc">+</span> Used_ATM_DebitCard <span class="sc">+</span> Used_CreditCard <span class="sc">+</span> Used_Cryptocurrency <span class="sc">+</span> </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  Used_QR_Code <span class="sc">+</span> Used_POS <span class="sc">+</span> Used_AZAMPay <span class="sc">+</span> Basic_TASAF_Cash_Transfer <span class="sc">+</span> </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  Additional_Conditional_TASAF_Cash_Transfer <span class="sc">+</span> Pension_for_Elders <span class="sc">+</span> </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  Payment_Was_Late <span class="sc">+</span> Money_Didnt_Come <span class="sc">+</span> Received_Less_Money <span class="sc">+</span> </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  Household_Not_On_Register <span class="sc">+</span> Unable_To_Collection_Point <span class="sc">+</span> No_Proof_Of_Identity <span class="sc">+</span> </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  Places_Not_In_My_Area <span class="sc">+</span> Do_Not_Think_They_Care <span class="sc">+</span> Need_Insurance <span class="sc">+</span> Motor_Vehicle_Insurance <span class="sc">+</span> </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  Households_Contents_Insurance <span class="sc">+</span> Private_Health_Insurance <span class="sc">+</span> </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  TIKA_Insurance <span class="sc">+</span> Social_Health_Insurance <span class="sc">+</span> </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  Personal_Accident_Insurance <span class="sc">+</span> Life_Insurance <span class="sc">+</span> Loan_Insurance <span class="sc">+</span> Building_Insurance <span class="sc">+</span> </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  Education_Policy <span class="sc">+</span> Funeral_Cover <span class="sc">+</span> Ushirika_Afya <span class="sc">+</span> </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  Motorcycle_Insurance <span class="sc">+</span> Other_Insurance_Products <span class="sc">+</span> Agent_Absent <span class="sc">+</span> </span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  Agent_Overcharged <span class="sc">+</span> Lost_Money <span class="sc">+</span> Agent_Requested_PIN <span class="sc">+</span> Other_Problems <span class="sc">+</span> </span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  Mean_Age <span class="sc">+</span> Mean_AmountOwed <span class="sc">+</span> Mean_AmountBetting <span class="sc">+</span> Total_GroupBelong <span class="sc">+</span> Total_GroupContribution</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>, <span class="at">data =</span> tanzania_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tanzania.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = FPAI ~ Urban + Male_Female_Ratio + Registered_YesNo_Ratio + 
    ComfortableBank_YesNo_Ratio + FinancialEducation_YesNo_Ratio + 
    PayingBack_YesNo_Ratio + NoEdu_SomeEdu + Internet + PaySlip + 
    TitleDeed + CertofOccupancy + MoneyforBusiness_FamilyFriendsLoan + 
    MoneyforBusiness_FamilyFriendsGift + MoneyforBusiness_Inheritance + 
    MoneyforBusiness_SavingsOrSalary + TriedButNot + NoTime + 
    NoMoney + TooComplicated + NoBenefit + NoPayment + DontKnowHow + 
    RegistrationInProcess + Informal_sector_salaried + Traders_agricultural_products_Income + 
    Traders_non_agricultural_Income + Service_providers_Income + 
    Piece_work_casual_labor_Income + Rental_Income + Interest_from_savings_investments_stocks_unit_trusts + 
    Welfare_Income + Gambling_Income + OtherIncome + Advice_FamilyMember + 
    Advice_Employer + Advice_Microfinance + Advice_FinancialAdvisor + 
    Advice_FarmersAssociation + Advice_BusinessAssociation + 
    Advice_GovernmentOfficial + Advice_VillageElder + Advice_OtherSpecify + 
    Advice_NoOne + SoldLivestock + Others_CouldntMeetNeeds + 
    Old_Savings + Old_ChildrenWillTakeCareOfMe + Old_MoneyFromFriendsRelatives + 
    Old_OwnBusiness + Old_RentalIncome + Old_DividendsFromShares + 
    Old_Pension + Old_InsurancePolicy + ConfidentWithMFIs + ConfidentWithSACCOs + 
    ConfidentWithPensionFund + ConfidentWithSavingsGroups + ConfidentWithFamilyFriends + 
    ConfidentWithUTTs + BorrowedFrom_MobileMoney + BorrowedFrom_Employer + 
    BorrowedFrom_Family_NoPayBack + BorrowedFrom_OtherSource + 
    Used_ATM_DebitCard + Used_CreditCard + Used_Cryptocurrency + 
    Used_QR_Code + Used_POS + Used_AZAMPay + Basic_TASAF_Cash_Transfer + 
    Additional_Conditional_TASAF_Cash_Transfer + Pension_for_Elders + 
    Payment_Was_Late + Money_Didnt_Come + Received_Less_Money + 
    Household_Not_On_Register + Unable_To_Collection_Point + 
    No_Proof_Of_Identity + Places_Not_In_My_Area + Do_Not_Think_They_Care + 
    Need_Insurance + Motor_Vehicle_Insurance + Households_Contents_Insurance + 
    Private_Health_Insurance + TIKA_Insurance + Social_Health_Insurance + 
    Personal_Accident_Insurance + Life_Insurance + Loan_Insurance + 
    Building_Insurance + Education_Policy + Funeral_Cover + Ushirika_Afya + 
    Motorcycle_Insurance + Other_Insurance_Products + Agent_Absent + 
    Agent_Overcharged + Lost_Money + Agent_Requested_PIN + Other_Problems + 
    Mean_Age + Mean_AmountOwed + Mean_AmountBetting + Total_GroupBelong + 
    Total_GroupContribution, data = tanzania_cleaned)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0288098 -0.0026238  0.0001274  0.0020261  0.0212343 

Coefficients:
                                                       Estimate Std. Error
(Intercept)                                           3.598e-03  2.727e-02
Urban                                                 4.401e-02  1.134e-02
Male_Female_Ratio                                    -5.558e-03  7.995e-03
Registered_YesNo_Ratio                                2.974e-02  2.423e-02
ComfortableBank_YesNo_Ratio                           3.885e-03  1.956e-03
FinancialEducation_YesNo_Ratio                        3.583e-02  2.259e-02
PayingBack_YesNo_Ratio                                3.607e-03  1.727e-02
NoEdu_SomeEdu                                         6.636e-03  7.395e-03
Internet                                             -1.811e-04  9.789e-04
PaySlip                                               2.603e-03  3.600e-03
TitleDeed                                             1.646e-03  7.761e-04
CertofOccupancy                                       1.264e-03  1.547e-03
MoneyforBusiness_FamilyFriendsLoan                   -9.042e-04  1.976e-03
MoneyforBusiness_FamilyFriendsGift                   -4.922e-04  6.355e-04
MoneyforBusiness_Inheritance                          5.362e-04  5.537e-04
MoneyforBusiness_SavingsOrSalary                     -2.493e-04  7.397e-04
TriedButNot                                           2.159e-03  4.996e-03
NoTime                                               -2.028e-03  4.113e-03
NoMoney                                               9.121e-05  6.867e-04
TooComplicated                                        1.973e-03  1.955e-03
NoBenefit                                            -5.169e-04  8.256e-04
NoPayment                                             1.001e-03  3.938e-03
DontKnowHow                                           1.534e-03  7.769e-04
RegistrationInProcess                                -2.599e-04  2.989e-03
Informal_sector_salaried                              2.388e-04  2.161e-03
Traders_agricultural_products_Income                 -8.387e-05  2.029e-03
Traders_non_agricultural_Income                      -1.934e-03  1.034e-03
Service_providers_Income                             -1.006e-03  1.221e-03
Piece_work_casual_labor_Income                       -1.094e-04  3.967e-04
Rental_Income                                        -2.647e-03  3.863e-03
Interest_from_savings_investments_stocks_unit_trusts -8.087e-03  1.632e-02
Welfare_Income                                       -4.164e-03  3.085e-03
Gambling_Income                                       3.218e-03  1.025e-02
OtherIncome                                           4.836e-03  2.498e-03
Advice_FamilyMember                                  -5.869e-05  4.850e-04
Advice_Employer                                       4.405e-04  7.232e-03
Advice_Microfinance                                  -2.031e-04  2.112e-02
Advice_FinancialAdvisor                              -2.084e-02  1.468e-02
Advice_FarmersAssociation                            -4.170e-03  4.428e-03
Advice_BusinessAssociation                            4.459e-03  9.689e-03
Advice_GovernmentOfficial                             1.101e-02  9.836e-03
Advice_VillageElder                                   7.446e-03  4.519e-03
Advice_OtherSpecify                                  -1.078e-03  7.846e-03
Advice_NoOne                                         -3.934e-04  3.832e-04
SoldLivestock                                        -2.381e-04  4.632e-04
Others_CouldntMeetNeeds                              -7.119e-04  2.909e-03
Old_Savings                                          -6.994e-04  5.837e-04
Old_ChildrenWillTakeCareOfMe                         -8.084e-05  6.425e-04
Old_MoneyFromFriendsRelatives                        -2.403e-04  2.518e-03
Old_OwnBusiness                                       2.475e-04  8.671e-04
Old_RentalIncome                                      1.933e-03  3.483e-03
Old_DividendsFromShares                              -3.273e-03  4.697e-03
Old_Pension                                           9.706e-03  2.698e-03
Old_InsurancePolicy                                   5.647e-03  2.289e-02
ConfidentWithMFIs                                    -1.670e-03  9.968e-04
ConfidentWithSACCOs                                  -1.491e-03  9.291e-04
ConfidentWithPensionFund                              1.735e-03  1.236e-03
ConfidentWithSavingsGroups                            1.977e-03  5.809e-04
ConfidentWithFamilyFriends                           -7.203e-04  4.404e-04
ConfidentWithUTTs                                     6.368e-04  1.239e-03
BorrowedFrom_MobileMoney                              4.503e-03  1.950e-03
BorrowedFrom_Employer                                -1.907e-05  1.956e-03
BorrowedFrom_Family_NoPayBack                         8.124e-04  2.440e-03
BorrowedFrom_OtherSource                             -3.077e-03  5.504e-03
Used_ATM_DebitCard                                    4.945e-04  1.413e-03
Used_CreditCard                                       2.215e-03  3.389e-03
Used_Cryptocurrency                                  -7.663e-04  4.274e-03
Used_QR_Code                                         -2.475e-03  3.593e-03
Used_POS                                             -7.004e-03  3.251e-03
Used_AZAMPay                                          1.278e-03  1.471e-03
Basic_TASAF_Cash_Transfer                             1.812e-03  3.653e-03
Additional_Conditional_TASAF_Cash_Transfer            1.220e-03  3.944e-03
Pension_for_Elders                                    1.235e-02  9.073e-03
Payment_Was_Late                                      7.643e-05  4.743e-03
Money_Didnt_Come                                     -3.590e-03  9.927e-03
Received_Less_Money                                  -3.605e-03  5.601e-03
Household_Not_On_Register                            -2.135e-02  9.098e-03
Unable_To_Collection_Point                            1.641e-02  1.120e-02
No_Proof_Of_Identity                                  1.043e-02  3.793e-02
Places_Not_In_My_Area                                -4.722e-04  7.553e-04
Do_Not_Think_They_Care                                1.124e-03  1.465e-03
Need_Insurance                                       -5.301e-04  4.935e-04
Motor_Vehicle_Insurance                              -1.458e-03  3.322e-03
Households_Contents_Insurance                        -8.634e-03  2.813e-02
Private_Health_Insurance                              6.164e-03  5.610e-03
TIKA_Insurance                                       -8.744e-04  7.722e-03
Social_Health_Insurance                              -6.759e-03  1.587e-02
Personal_Accident_Insurance                           6.543e-03  2.419e-02
Life_Insurance                                        3.147e-02  2.900e-02
Loan_Insurance                                       -4.711e-02  4.770e-02
Building_Insurance                                    3.400e-02  1.780e-02
Education_Policy                                     -8.620e-02  3.847e-02
Funeral_Cover                                         3.728e-03  3.131e-02
Ushirika_Afya                                         6.969e-03  1.020e-02
Motorcycle_Insurance                                  5.222e-04  4.229e-03
Other_Insurance_Products                              8.091e-03  5.043e-03
Agent_Absent                                          6.396e-04  5.790e-04
Agent_Overcharged                                    -2.414e-04  1.474e-03
Lost_Money                                           -2.880e-03  2.241e-03
Agent_Requested_PIN                                  -4.328e-04  1.696e-03
Other_Problems                                        3.873e-03  6.823e-03
Mean_Age                                              8.122e-04  6.117e-04
Mean_AmountOwed                                       2.489e-08  2.268e-08
Mean_AmountBetting                                    2.962e-06  2.092e-06
Total_GroupBelong                                    -1.673e-04  2.794e-04
Total_GroupContribution                               1.239e-08  2.028e-08
                                                     t value Pr(&gt;|t|)    
(Intercept)                                            0.132 0.895549    
Urban                                                  3.881 0.000285 ***
Male_Female_Ratio                                     -0.695 0.489957    
Registered_YesNo_Ratio                                 1.227 0.225015    
ComfortableBank_YesNo_Ratio                            1.987 0.052057 .  
FinancialEducation_YesNo_Ratio                         1.586 0.118514    
PayingBack_YesNo_Ratio                                 0.209 0.835322    
NoEdu_SomeEdu                                          0.897 0.373477    
Internet                                              -0.185 0.853909    
PaySlip                                                0.723 0.472692    
TitleDeed                                              2.122 0.038483 *  
CertofOccupancy                                        0.817 0.417500    
MoneyforBusiness_FamilyFriendsLoan                    -0.458 0.649021    
MoneyforBusiness_FamilyFriendsGift                    -0.774 0.442066    
MoneyforBusiness_Inheritance                           0.968 0.337166    
MoneyforBusiness_SavingsOrSalary                      -0.337 0.737361    
TriedButNot                                            0.432 0.667275    
NoTime                                                -0.493 0.624060    
NoMoney                                                0.133 0.894832    
TooComplicated                                         1.009 0.317527    
NoBenefit                                             -0.626 0.533873    
NoPayment                                              0.254 0.800338    
DontKnowHow                                            1.975 0.053403 .  
RegistrationInProcess                                 -0.087 0.931035    
Informal_sector_salaried                               0.111 0.912420    
Traders_agricultural_products_Income                  -0.041 0.967185    
Traders_non_agricultural_Income                       -1.871 0.066834 .  
Service_providers_Income                              -0.824 0.413627    
Piece_work_casual_labor_Income                        -0.276 0.783809    
Rental_Income                                         -0.685 0.496209    
Interest_from_savings_investments_stocks_unit_trusts  -0.495 0.622313    
Welfare_Income                                        -1.350 0.182699    
Gambling_Income                                        0.314 0.754661    
OtherIncome                                            1.936 0.058077 .  
Advice_FamilyMember                                   -0.121 0.904121    
Advice_Employer                                        0.061 0.951661    
Advice_Microfinance                                   -0.010 0.992361    
Advice_FinancialAdvisor                               -1.419 0.161580    
Advice_FarmersAssociation                             -0.942 0.350499    
Advice_BusinessAssociation                             0.460 0.647195    
Advice_GovernmentOfficial                              1.119 0.268004    
Advice_VillageElder                                    1.648 0.105187    
Advice_OtherSpecify                                   -0.137 0.891217    
Advice_NoOne                                          -1.027 0.309161    
SoldLivestock                                         -0.514 0.609246    
Others_CouldntMeetNeeds                               -0.245 0.807579    
Old_Savings                                           -1.198 0.236108    
Old_ChildrenWillTakeCareOfMe                          -0.126 0.900334    
Old_MoneyFromFriendsRelatives                         -0.095 0.924322    
Old_OwnBusiness                                        0.285 0.776372    
Old_RentalIncome                                       0.555 0.581193    
Old_DividendsFromShares                               -0.697 0.488900    
Old_Pension                                            3.597 0.000698 ***
Old_InsurancePolicy                                    0.247 0.806103    
ConfidentWithMFIs                                     -1.675 0.099686 .  
ConfidentWithSACCOs                                   -1.604 0.114465    
ConfidentWithPensionFund                               1.403 0.166224    
ConfidentWithSavingsGroups                             3.404 0.001260 ** 
ConfidentWithFamilyFriends                            -1.636 0.107752    
ConfidentWithUTTs                                      0.514 0.609348    
BorrowedFrom_MobileMoney                               2.309 0.024775 *  
BorrowedFrom_Employer                                 -0.010 0.992256    
BorrowedFrom_Family_NoPayBack                          0.333 0.740518    
BorrowedFrom_OtherSource                              -0.559 0.578393    
Used_ATM_DebitCard                                     0.350 0.727678    
Used_CreditCard                                        0.654 0.516175    
Used_Cryptocurrency                                   -0.179 0.858385    
Used_QR_Code                                          -0.689 0.493885    
Used_POS                                              -2.154 0.035695 *  
Used_AZAMPay                                           0.869 0.388778    
Basic_TASAF_Cash_Transfer                              0.496 0.621911    
Additional_Conditional_TASAF_Cash_Transfer             0.309 0.758192    
Pension_for_Elders                                     1.361 0.179212    
Payment_Was_Late                                       0.016 0.987203    
Money_Didnt_Come                                      -0.362 0.719018    
Received_Less_Money                                   -0.644 0.522527    
Household_Not_On_Register                             -2.346 0.022662 *  
Unable_To_Collection_Point                             1.465 0.148689    
No_Proof_Of_Identity                                   0.275 0.784458    
Places_Not_In_My_Area                                 -0.625 0.534523    
Do_Not_Think_They_Care                                 0.767 0.446171    
Need_Insurance                                        -1.074 0.287524    
Motor_Vehicle_Insurance                               -0.439 0.662537    
Households_Contents_Insurance                         -0.307 0.760110    
Private_Health_Insurance                               1.099 0.276770    
TIKA_Insurance                                        -0.113 0.910264    
Social_Health_Insurance                               -0.426 0.671927    
Personal_Accident_Insurance                            0.270 0.787850    
Life_Insurance                                         1.085 0.282605    
Loan_Insurance                                        -0.988 0.327763    
Building_Insurance                                     1.910 0.061421 .  
Education_Policy                                      -2.241 0.029177 *  
Funeral_Cover                                          0.119 0.905661    
Ushirika_Afya                                          0.683 0.497541    
Motorcycle_Insurance                                   0.123 0.902181    
Other_Insurance_Products                               1.604 0.114458    
Agent_Absent                                           1.105 0.274215    
Agent_Overcharged                                     -0.164 0.870514    
Lost_Money                                            -1.285 0.204185    
Agent_Requested_PIN                                   -0.255 0.799554    
Other_Problems                                         0.568 0.572631    
Mean_Age                                               1.328 0.189851    
Mean_AmountOwed                                        1.097 0.277465    
Mean_AmountBetting                                     1.416 0.162446    
Total_GroupBelong                                     -0.599 0.551680    
Total_GroupContribution                                0.611 0.543587    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.012 on 54 degrees of freedom
Multiple R-squared:  0.9365,    Adjusted R-squared:  0.813 
F-statistic: 7.585 on 105 and 54 DF,  p-value: 1.521e-13</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The initial model has an adjusted R-squared value of 0.813, meaning that approximately 81% of the variation in the Financial Participation and Access Index (FPAI) is explained by these predictors.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In multiple linear regression, adjusted R-squared is prioritized over R-squared because it adjusts for the number of predictors in the model, providing a more accurate assessment of model fit. Unlike R-squared, adjusted R-squared penalizes unnecessary predictors, helping to prevent overfitting and offering a more reliable measure of predictive power.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="the-refined-model---stepwise-regression" class="level2">
<h2 class="anchored" data-anchor-id="the-refined-model---stepwise-regression">8.2 The Refined Model - Stepwise Regression</h2>
<p>In this section, we perform&nbsp;<strong>stepwise regression</strong>&nbsp;for variable selection. This method systematically includes or excludes variables based on specific criteria, such as the Akaike Information Criterion (AIC) or the Bayesian Information Criterion (BIC). Stepwise regression refines the model by retaining only those predictors that significantly contribute to explaining variations in the Financial Inclusion Index, leading to a more parsimonious and interpretable model.</p>
<p>Through this process, the multiple linear regression model is optimized to identify the key factors impacting FPAI while addressing multicollinearity and ensuring model stability. This approach ultimately enhances the model’s explanatory power, enabling more accurate and actionable insights into the drivers of financial inclusion.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Criteria for Variable Selection: Reject p-value greater than alpha value of 0.05
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>We will use the <code>olsrr</code> package to do this. The&nbsp;<code>olsrr</code>&nbsp;package in R provides a streamlined process for diagnosing multicollinearity issues, performing variable selection, and generating organized model assessment reports. This stage is critical for refining our initial model, ensuring each retained variable significantly contributes to explaining the dependent variable, the FPAI.</p>
<p>Since p value is our defined criteria, we use <strong><em>ols_step_forward_p()</em></strong> as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tanzania_vs_mlr <span class="ot">&lt;-</span> <span class="fu">ols_step_forward_p</span>(tanzania.mlr, <span class="at">p_val=</span> <span class="fl">0.05</span>, <span class="at">details=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tanzania_vs_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>The stepwise regression analysis streamlined the initial variable set to 31 significant predictors, as illustrated in the accompanying plots. This selection process resulted in an increase in the model’s adjusted R-squared value, which increased from 0.813 in the initial model to 0.830 in the final model. It suggests a greater proportion of the variance in the <strong>Financial Participation and Access Index</strong> (FPAI) explained by the chosen predictors.</p>
<p>The final model with the final variables selected by stepwise regression is represented as the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>final_tanzania.mlr<span class="ot">&lt;-</span> <span class="fu">lm</span>(FPAI <span class="sc">~</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> Total_GroupContribution <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    Old_Pension <span class="sc">+</span> BorrowedFrom_MobileMoney <span class="sc">+</span> Other_Insurance_Products <span class="sc">+</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    ConfidentWithSavingsGroups <span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    SoldLivestock <span class="sc">+</span> Mean_AmountOwed <span class="sc">+</span> Mean_Age <span class="sc">+</span> ConfidentWithSACCOs <span class="sc">+</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    ConfidentWithUTTs <span class="sc">+</span> OtherIncome <span class="sc">+</span> ConfidentWithFamilyFriends <span class="sc">+</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    Mean_AmountBetting <span class="sc">+</span> Places_Not_In_My_Area <span class="sc">+</span> DontKnowHow <span class="sc">+</span> </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    CertofOccupancy <span class="sc">+</span> Personal_Accident_Insurance <span class="sc">+</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    Agent_Absent <span class="sc">+</span> Advice_NoOne <span class="sc">+</span> Private_Health_Insurance <span class="sc">+</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    Urban <span class="sc">+</span> Traders_non_agricultural_Income <span class="sc">+</span> Used_POS <span class="sc">+</span> Used_AZAMPay <span class="sc">+</span> </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    Lost_Money <span class="sc">+</span> TooComplicated <span class="sc">+</span> Household_Not_On_Register, </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> tanzania_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variable-selected" class="level2">
<h2 class="anchored" data-anchor-id="variable-selected">8.3 Variable Selected</h2>
<p>Lastly, we will use the <strong><em>tbl_regression()</em></strong> from gtsummary package to create publication-ready summary tables in R.</p>
<p><u><em>Results of Multiple Linear Regression for Impact of Selected Variables on <strong>Financial Participation and Access Index</strong> (FPAI)</em></u></p>
<div class="cell">
<div class="cell-output-display">
<div id="vwhnkccdnk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vwhnkccdnk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vwhnkccdnk thead, #vwhnkccdnk tbody, #vwhnkccdnk tfoot, #vwhnkccdnk tr, #vwhnkccdnk td, #vwhnkccdnk th {
  border-style: none;
}

#vwhnkccdnk p {
  margin: 0;
  padding: 0;
}

#vwhnkccdnk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vwhnkccdnk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vwhnkccdnk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vwhnkccdnk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vwhnkccdnk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vwhnkccdnk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vwhnkccdnk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vwhnkccdnk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vwhnkccdnk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vwhnkccdnk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vwhnkccdnk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vwhnkccdnk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vwhnkccdnk .gt_spanner_row {
  border-bottom-style: hidden;
}

#vwhnkccdnk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vwhnkccdnk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vwhnkccdnk .gt_from_md > :first-child {
  margin-top: 0;
}

#vwhnkccdnk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vwhnkccdnk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vwhnkccdnk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vwhnkccdnk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vwhnkccdnk .gt_row_group_first td {
  border-top-width: 2px;
}

#vwhnkccdnk .gt_row_group_first th {
  border-top-width: 2px;
}

#vwhnkccdnk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwhnkccdnk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vwhnkccdnk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vwhnkccdnk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vwhnkccdnk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwhnkccdnk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vwhnkccdnk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vwhnkccdnk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vwhnkccdnk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vwhnkccdnk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vwhnkccdnk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwhnkccdnk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vwhnkccdnk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vwhnkccdnk .gt_left {
  text-align: left;
}

#vwhnkccdnk .gt_center {
  text-align: center;
}

#vwhnkccdnk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vwhnkccdnk .gt_font_normal {
  font-weight: normal;
}

#vwhnkccdnk .gt_font_bold {
  font-weight: bold;
}

#vwhnkccdnk .gt_font_italic {
  font-style: italic;
}

#vwhnkccdnk .gt_super {
  font-size: 65%;
}

#vwhnkccdnk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vwhnkccdnk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vwhnkccdnk .gt_indent_1 {
  text-indent: 5px;
}

#vwhnkccdnk .gt_indent_2 {
  text-indent: 10px;
}

#vwhnkccdnk .gt_indent_3 {
  text-indent: 15px;
}

#vwhnkccdnk .gt_indent_4 {
  text-indent: 20px;
}

#vwhnkccdnk .gt_indent_5 {
  text-indent: 25px;
}

#vwhnkccdnk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vwhnkccdnk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipDaGFyYWN0ZXJpc3RpYyoq&quot;><div class='gt_from_md'><p><strong>Characteristic</strong></p>
</div></div>"><div data-qmd-base64="KipDaGFyYWN0ZXJpc3RpYyoq"><div class="gt_from_md"><p><strong>Characteristic</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipCZXRhKio=&quot;><div class='gt_from_md'><p><strong>Beta</strong></p>
</div></div>"><div data-qmd-base64="KipCZXRhKio="><div class="gt_from_md"><p><strong>Beta</strong></p>
</div></div></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;Kio5NSUgQ0kqKg==&quot;><div class='gt_from_md'><p><strong>95% CI</strong></p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>"><div data-qmd-base64="Kio5NSUgQ0kqKg=="><div class="gt_from_md"><p><strong>95% CI</strong></p>
</div></div><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<div data-qmd-base64=&quot;KipwLXZhbHVlKio=&quot;><div class='gt_from_md'><p><strong>p-value</strong></p>
</div></div>"><div data-qmd-base64="KipwLXZhbHVlKio="><div class="gt_from_md"><p><strong>p-value</strong></p>
</div></div></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_center">-0.0019</td>
<td headers="conf.low" class="gt_row gt_center">-0.0275, 0.0237</td>
<td headers="p.value" class="gt_row gt_center">0.9</td></tr>
    <tr><td headers="label" class="gt_row gt_left">FinancialEducation_YesNo_Ratio</td>
<td headers="estimate" class="gt_row gt_center">0.0502</td>
<td headers="conf.low" class="gt_row gt_center">0.0294, 0.0710</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Total_GroupContribution</td>
<td headers="estimate" class="gt_row gt_center">0.0000</td>
<td headers="conf.low" class="gt_row gt_center">0.0000, 0.0000</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Old_Pension</td>
<td headers="estimate" class="gt_row gt_center">0.0092</td>
<td headers="conf.low" class="gt_row gt_center">0.0074, 0.0111</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">BorrowedFrom_MobileMoney</td>
<td headers="estimate" class="gt_row gt_center">0.0032</td>
<td headers="conf.low" class="gt_row gt_center">0.0016, 0.0048</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Other_Insurance_Products</td>
<td headers="estimate" class="gt_row gt_center">0.0077</td>
<td headers="conf.low" class="gt_row gt_center">0.0037, 0.0118</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ConfidentWithSavingsGroups</td>
<td headers="estimate" class="gt_row gt_center">0.0014</td>
<td headers="conf.low" class="gt_row gt_center">0.0010, 0.0019</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">SoldLivestock</td>
<td headers="estimate" class="gt_row gt_center">-0.0008</td>
<td headers="conf.low" class="gt_row gt_center">-0.0012, -0.0005</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Mean_AmountOwed</td>
<td headers="estimate" class="gt_row gt_center">0.0000</td>
<td headers="conf.low" class="gt_row gt_center">0.0000, 0.0000</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Mean_Age</td>
<td headers="estimate" class="gt_row gt_center">0.0010</td>
<td headers="conf.low" class="gt_row gt_center">0.0004, 0.0017</td>
<td headers="p.value" class="gt_row gt_center">0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ConfidentWithSACCOs</td>
<td headers="estimate" class="gt_row gt_center">-0.0021</td>
<td headers="conf.low" class="gt_row gt_center">-0.0027, -0.0014</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ConfidentWithUTTs</td>
<td headers="estimate" class="gt_row gt_center">0.0014</td>
<td headers="conf.low" class="gt_row gt_center">0.0004, 0.0024</td>
<td headers="p.value" class="gt_row gt_center">0.006</td></tr>
    <tr><td headers="label" class="gt_row gt_left">OtherIncome</td>
<td headers="estimate" class="gt_row gt_center">0.0043</td>
<td headers="conf.low" class="gt_row gt_center">0.0018, 0.0067</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">ConfidentWithFamilyFriends</td>
<td headers="estimate" class="gt_row gt_center">-0.0004</td>
<td headers="conf.low" class="gt_row gt_center">-0.0007, -0.0002</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Mean_AmountBetting</td>
<td headers="estimate" class="gt_row gt_center">0.0000</td>
<td headers="conf.low" class="gt_row gt_center">0.0000, 0.0000</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Places_Not_In_My_Area</td>
<td headers="estimate" class="gt_row gt_center">-0.0008</td>
<td headers="conf.low" class="gt_row gt_center">-0.0013, -0.0003</td>
<td headers="p.value" class="gt_row gt_center">0.002</td></tr>
    <tr><td headers="label" class="gt_row gt_left">DontKnowHow</td>
<td headers="estimate" class="gt_row gt_center">0.0018</td>
<td headers="conf.low" class="gt_row gt_center">0.0011, 0.0024</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">CertofOccupancy</td>
<td headers="estimate" class="gt_row gt_center">0.0018</td>
<td headers="conf.low" class="gt_row gt_center">0.0007, 0.0028</td>
<td headers="p.value" class="gt_row gt_center">0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Personal_Accident_Insurance</td>
<td headers="estimate" class="gt_row gt_center">0.0169</td>
<td headers="conf.low" class="gt_row gt_center">0.0003, 0.0334</td>
<td headers="p.value" class="gt_row gt_center">0.047</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Agent_Absent</td>
<td headers="estimate" class="gt_row gt_center">0.0007</td>
<td headers="conf.low" class="gt_row gt_center">0.0003, 0.0011</td>
<td headers="p.value" class="gt_row gt_center">0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Advice_NoOne</td>
<td headers="estimate" class="gt_row gt_center">-0.0007</td>
<td headers="conf.low" class="gt_row gt_center">-0.0009, -0.0004</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Private_Health_Insurance</td>
<td headers="estimate" class="gt_row gt_center">0.0086</td>
<td headers="conf.low" class="gt_row gt_center">0.0048, 0.0124</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Urban</td>
<td headers="estimate" class="gt_row gt_center">0.0301</td>
<td headers="conf.low" class="gt_row gt_center">0.0184, 0.0419</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Traders_non_agricultural_Income</td>
<td headers="estimate" class="gt_row gt_center">-0.0014</td>
<td headers="conf.low" class="gt_row gt_center">-0.0022, -0.0007</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Used_POS</td>
<td headers="estimate" class="gt_row gt_center">-0.0032</td>
<td headers="conf.low" class="gt_row gt_center">-0.0049, -0.0015</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Used_AZAMPay</td>
<td headers="estimate" class="gt_row gt_center">0.0019</td>
<td headers="conf.low" class="gt_row gt_center">0.0008, 0.0030</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Lost_Money</td>
<td headers="estimate" class="gt_row gt_center">-0.0030</td>
<td headers="conf.low" class="gt_row gt_center">-0.0047, -0.0012</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">TooComplicated</td>
<td headers="estimate" class="gt_row gt_center">0.0024</td>
<td headers="conf.low" class="gt_row gt_center">0.0006, 0.0043</td>
<td headers="p.value" class="gt_row gt_center">0.009</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Household_Not_On_Register</td>
<td headers="estimate" class="gt_row gt_center">-0.0127</td>
<td headers="conf.low" class="gt_row gt_center">-0.0225, -0.0029</td>
<td headers="p.value" class="gt_row gt_center">0.012</td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="4"><div data-qmd-base64="UsKyID0gMC44NjA7IEFkanVzdGVkIFLCsiA9IDAuODMwOyBBSUMgPSAtOTQ5OyBTdGF0aXN0aWMgPSAyOC44OyBwLXZhbHVlID0gPDAuMDAxOyDPgyA9IDAuMDEx"><div class="gt_from_md"><p>R² = 0.860; Adjusted R² = 0.830; AIC = -949; Statistic = 28.8; p-value = &lt;0.001; σ = 0.011</p>
</div></div></td>
    </tr>
  </tfoot>
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span> <div data-qmd-base64="Q0kgPSBDb25maWRlbmNlIEludGVydmFs"><div class="gt_from_md"><p>CI = Confidence Interval</p>
</div></div></td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>Interpretation of each predictor:</p>
<ul>
<li><p><strong>Intercept</strong>: This is the base FPAI value when all other predictors are zero. The nearly zero intercept suggests that FPAI could be intrinsically low when controlling for all other variables. This minimal intercept might reflect baseline conditions where limited or no access to financial resources, products, or education is common.</p></li>
<li><p><strong>FinancialEducation_YesNo_Ratio (β = 0.0502)</strong>: Strongly positive, indicating that higher financial education rates correlate with higher financial participation.</p></li>
<li><p><strong>Total_GroupContribution (β ≈ 0.0000)</strong>: Although the coefficient rounds to zero, a very small positive effect suggests that higher social group contributions might slightly increase financial access.</p></li>
<li><p><strong>Old_Pension (β = 0.0092)</strong>: Indicates that receiving a pension is associated with higher FPAI, likely due to increased financial stability.</p></li>
<li><p><strong>BorrowedFrom_MobileMoney (β = 0.0032)</strong>: Positive association suggests that borrowing through mobile money services supports financial access and participation.</p></li>
<li><p><strong>Other_Insurance_Products (β = 0.0077)</strong>: Positive, indicating that access to various insurance products promotes financial inclusion.</p></li>
<li><p><strong>ConfidentWithSavingsGroups (β = 0.0014)</strong>: Positive, implying that trust in savings groups encourages financial participation.</p></li>
<li><p><strong>SoldLivestock (β = -0.0008)</strong>: Negative, which may indicate that reliance on livestock sales for income is linked to lower access to financial products.</p></li>
<li><p><strong>Mean_AmountOwed (β ≈ 0.0000)</strong>: Small positive effect, suggesting that slightly higher amounts owed might not significantly impact FPAI.</p></li>
<li><p><strong>Mean_Age (β = 0.0010)</strong>: Small positive effect, with older individuals perhaps having better financial access due to accumulated wealth or experience.</p></li>
<li><p><strong>ConfidentWithSACCOs (β = -0.0021)</strong>: Negative, which could mean limited financial inclusion among SACCO members if these are viewed as less formal or high-risk.</p></li>
<li><p><strong>ConfidentWithUTTs (β = 0.0014)</strong>: Positive, indicating that trust in UTTs (Unit Trusts) may contribute positively to FPAI.</p></li>
<li><p><strong>OtherIncome (β = 0.0043)</strong>: Positive, showing that diversified income sources support greater financial access.</p></li>
<li><p><strong>ConfidentWithFamilyFriends (β = -0.0004)</strong>: Slightly negative, suggesting that relying on family or friends for financial guidance might limit broader financial engagement.</p></li>
<li><p><strong>Mean_AmountBetting (β ≈ 0.0000)</strong>: No meaningful impact; betting doesn’t significantly influence FPAI.</p></li>
<li><p><strong>Places_Not_In_My_Area (β = -0.0008)</strong>: Negative, implying that access to financial product is limited if financial institutions are not in areas where respondents reside, which may imply Tanzania still have room to improve infrastructure to include more financial institutions.</p></li>
<li><p><strong>DontKnowHow (β = 0.0018)</strong>: Positive, suggesting that people uncertain about financial practices might still engage with financial systems, possibly through informal means.</p></li>
<li><p><strong>CertofOccupancy (β = 0.0018)</strong>: Positive, indicating that having official occupancy certification increases financial access.</p></li>
<li><p><strong>Personal_Accident_Insurance (β = 0.0169)</strong>: Positive, showing that accident insurance coverage is associated with increased financial participation.</p></li>
<li><p><strong>Agent_Absent (β = 0.0007)</strong>: Positive; absence of agents may encourage independent financial engagement, possibly via mobile or digital channels.</p></li>
<li><p><strong>Advice_NoOne (β = -0.0007)</strong>: Negative, implying that lacking financial advice limits engagement with financial products.</p></li>
<li><p><strong>Private_Health_Insurance (β = 0.0086)</strong>: Positive, indicating that private health insurance access supports financial inclusion.</p></li>
<li><p><strong>Urban (β = 0.0301)</strong>: Strongly positive, with urban residency associated with higher FPAI, likely due to better access to financial services.</p></li>
<li><p><strong>Traders_non_agricultural_Income (β = -0.0014)</strong>: Negative, suggesting that informal trading income may limit access to formal financial services.</p></li>
<li><p><strong>Used_POS (β = -0.0032)</strong>: Negative, potentially indicating that POS usage alone does not enhance financial access.</p></li>
<li><p><strong>Used_AZAMPay (β = 0.0019)</strong>: Positive, suggesting that AZAMPay use correlates with higher financial participation.</p></li>
<li><p><strong>Lost_Money (β = -0.0030)</strong>: Negative, possibly reflecting decreased trust or resource loss, reducing financial access.</p></li>
<li><p><strong>TooComplicated (β = 0.0024)</strong>: Positive; perceiving financial processes as complex doesn’t necessarily discourage financial engagement.</p></li>
<li><p><strong>Household_Not_On_Register (β = -0.0127)</strong>: Negative, highlighting that lack of formal registration negatively impacts financial access.</p></li>
</ul>
<p>The predictors, especially those with larger positive coefficients like&nbsp;<strong>FinancialEducation_YesNo_Ratio</strong>&nbsp;(0.0502) and&nbsp;<strong>Urban</strong>&nbsp;(0.0301), reveal impactful areas where improvements could directly boost FPAI and financial inclusion. Similarly, variables with negative coefficients, like&nbsp;<strong>Household_Not_On_Register</strong>&nbsp;(-0.0127), suggest barriers that significantly limits access to financial products and would require attention to enhance inclusion.</p>
</section>
<section id="model-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnostics">8.5 Model Diagnostics</h2>
<section id="multicollinearity---vif" class="level3">
<h3 class="anchored" data-anchor-id="multicollinearity---vif"><strong>8.5.1 Multicollinearity - VIF</strong></h3>
<p>Given the large number of variables and low Adjusted R-squared, multicollinearity becomes a concern. High Variance Inflation Factor (VIF) scores indicate that some variables may be highly correlated with one another, which can distort the model’s estimates and inflate standard errors. By calculating the VIF for each predictor, we can identify those with excessive multicollinearity—typically with VIF values above 10, suggesting that they should be either removed or consolidated to improve model stability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(final_tanzania.mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         Variables Tolerance      VIF
1   FinancialEducation_YesNo_Ratio 0.4206136 2.377479
2          Total_GroupContribution 0.5296393 1.888077
3                      Old_Pension 0.3496159 2.860281
4         BorrowedFrom_MobileMoney 0.4315842 2.317045
5         Other_Insurance_Products 0.6838683 1.462270
6       ConfidentWithSavingsGroups 0.2342700 4.268579
7                    SoldLivestock 0.5333983 1.874771
8                  Mean_AmountOwed 0.6200823 1.612689
9                         Mean_Age 0.7559345 1.322866
10             ConfidentWithSACCOs 0.3184780 3.139934
11               ConfidentWithUTTs 0.3947492 2.533254
12                     OtherIncome 0.6530853 1.531194
13      ConfidentWithFamilyFriends 0.2484295 4.025287
14              Mean_AmountBetting 0.7613744 1.313414
15           Places_Not_In_My_Area 0.5799117 1.724401
16                     DontKnowHow 0.5129888 1.949360
17                 CertofOccupancy 0.6673253 1.498520
18     Personal_Accident_Insurance 0.6307898 1.585314
19                    Agent_Absent 0.4056804 2.464995
20                    Advice_NoOne 0.3103985 3.221665
21        Private_Health_Insurance 0.6804953 1.469518
22                           Urban 0.3079383 3.247404
23 Traders_non_agricultural_Income 0.2657329 3.763177
24                        Used_POS 0.3565575 2.804597
25                    Used_AZAMPay 0.4238394 2.359384
26                      Lost_Money 0.3726478 2.683499
27                  TooComplicated 0.6621347 1.510267
28       Household_Not_On_Register 0.7970949 1.254556</code></pre>
</div>
</div>
<p>After stepwise regression and significant variables were selected, we can see that there is no VIF greater than 10, indicating no multicollinearity is present in our refined model. High VIF values are only expected in the initial model because our dataframe contains numerous variables capturing related aspects of financial inclusion, such as various forms of access to financial services, borrowing behaviors, and support sources, many of which are conceptually similar and share underlying patterns.</p>
</section>
<section id="test-for-non-linearity" class="level3">
<h3 class="anchored" data-anchor-id="test-for-non-linearity">8.5.2 Test for Non Linearity</h3>
<p>Testing for non-linearity assesses whether the relationship between the predictor variables and the FPAI deviates from a straight line, as linear regression assumes a linear relationship. If non-linearity is present, the residuals will show systematic patterns rather than a random scatter. Testing for non-linearity ensures that the model captures the true relationships within the data and improves predictive accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit</span>(tanzania_vs_mlr<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can confirm that residuals are non linear.</p>
</section>
<section id="test-for-normality-assumption" class="level3">
<h3 class="anchored" data-anchor-id="test-for-normality-assumption">8.5.3 Test for Normality Assumption</h3>
<p>The normality assumption in linear regression pertains to the distribution of residuals, not the predictor variables. Residuals should follow a normal distribution for valid inference in terms of hypothesis testing and confidence intervals. If residuals are not normally distributed, transformations or robust regression techniques may be needed to satisfy the assumption, ensuring reliable and accurate estimates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_hist</span>(tanzania_vs_mlr<span class="sc">$</span>model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can confirm that residuals are normally distributed.</p>
</section>
<section id="test-for-spatial-autocorrelation" class="level3">
<h3 class="anchored" data-anchor-id="test-for-spatial-autocorrelation">8.5.3 Test for Spatial Autocorrelation</h3>
<p>Testing for spatial autocorrelation is crucial when working with geographically clustered data, as it assesses whether residuals are correlated across spatial locations. Spatial autocorrelation implies that observations close in space may influence each other, violating the independence assumption in linear regression. Moran’s I statistic will be used to detect spatial autocorrelation in residuals.</p>
<p>First we will extract the residuals from the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mlr_output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tanzania_vs_mlr<span class="sc">$</span>model<span class="sc">$</span>residuals)<span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="st">'VS_MLR_RES'</span> <span class="ot">=</span> <span class="st">'tanzania_vs_mlr$model$residuals'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we will use <strong>cbind</strong> (since there is no unique identifier) to join the newly created df of residuals with our point feature data.frame, tanzania_cleaned, to plot the distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tanzania_cleaned,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                         mlr_output<span class="sc">$</span>VS_MLR_RES) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span> (<span class="st">'MLR_RES'</span><span class="ot">=</span><span class="st">'mlr_output.VS_MLR_RES'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span> (tanzbounds) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tmap_options</span>(<span class="at">check.and.fix =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tanzania_cleaned)<span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col=</span> <span class="st">'MLR_RES'</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">style=</span> <span class="st">'quantile'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the figure above, we can see that there seem to not be a cluster and the residuals are rather random.</p>
<section id="spatially-stationary-test" class="level4">
<h4 class="anchored" data-anchor-id="spatially-stationary-test">8.5.3.1 Spatially Stationary Test</h4>
<p>To confirm this and measure the degree to which similar or dissimilar values are clustered in space, we will performing Global Moran’s I. If the indicators are independent of space, Moran’s I should show no significant spatial autocorrelation. The following is the hypothesis that we would like to test.</p>
<ul>
<li><p><strong>Null Hypothesis (H0):</strong>&nbsp;The FPAI residuals distribution is spatially independent (randomly distributed in space).</p></li>
<li><p><strong>Alternative Hypothesis (H1) :</strong>&nbsp;There is spatial dependence, indicating that similar values are clustered or dispersed.</p></li>
</ul>
<p>The 95% confident interval will be used. (Significance level of 0.05)</p>
<p>We will first compute distance based weights with <strong><em>st_knn</em></strong> and <strong><em>st_weights</em></strong> as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tanzania_cleaned <span class="ot">&lt;-</span> tanzania_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">nb =</span> <span class="fu">st_knn</span>(geometry, <span class="at">k =</span> <span class="dv">6</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">longlat=</span> <span class="cn">FALSE</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">wt =</span> <span class="fu">st_weights</span>(nb,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">style =</span> <span class="st">'W'</span>),</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we are ready to perform Global Moran I with 100 simulations using <strong><em>global_moran_perm.</em></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(tanzania_cleaned<span class="sc">$</span>MLR_RES,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                  tanzania_cleaned<span class="sc">$</span>nb,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                  tanzania_cleaned<span class="sc">$</span>wt,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">alternative =</span> <span class="st">"two.sided"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.0098019, observed rank = 53, p-value = 0.94
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Since p value (0.76) is greater than 0.05, we will not reject the null hypothesis. This implies that the residuals are randomly distributed.</p>
<p>Since observed Global Moran I is less than 0, we infer that the residuals do not resemble cluster distribution.</p>
<hr>
</section>
</section>
</section>
</section>
<section id="geographically-weighted-linear-regression" class="level1">
<h1>9 Geographically Weighted Linear Regression</h1>
</section>
<section id="hedonic-pricing-using-gwmodel" class="level1">
<h1>Hedonic Pricing using GWmodel</h1>
<section id="adaptive-bandwidth-gwr-model" class="level2">
<h2 class="anchored" data-anchor-id="adaptive-bandwidth-gwr-model">Adaptive Bandwidth GWR Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(<span class="at">formula =</span> FPAI <span class="sc">~</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> Total_GroupContribution <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    Old_Pension <span class="sc">+</span> BorrowedFrom_MobileMoney <span class="sc">+</span> Other_Insurance_Products <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    ConfidentWithSavingsGroups <span class="sc">+</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    SoldLivestock <span class="sc">+</span> Mean_AmountOwed <span class="sc">+</span> Mean_Age <span class="sc">+</span> ConfidentWithSACCOs <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    ConfidentWithUTTs <span class="sc">+</span> OtherIncome <span class="sc">+</span> ConfidentWithFamilyFriends <span class="sc">+</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    Mean_AmountBetting <span class="sc">+</span> Places_Not_In_My_Area <span class="sc">+</span> DontKnowHow <span class="sc">+</span> </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    CertofOccupancy <span class="sc">+</span> Personal_Accident_Insurance <span class="sc">+</span> </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    Agent_Absent <span class="sc">+</span> Advice_NoOne <span class="sc">+</span> Private_Health_Insurance <span class="sc">+</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    Urban <span class="sc">+</span> Traders_non_agricultural_Income <span class="sc">+</span> Used_POS <span class="sc">+</span> Used_AZAMPay <span class="sc">+</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    Lost_Money <span class="sc">+</span> TooComplicated <span class="sc">+</span> Household_Not_On_Register,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> tanzania_cleaned, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">approach=</span><span class="st">"CV"</span>, </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">kernel=</span><span class="st">"gaussian"</span>, </span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adaptive bandwidth: 106 CV score: 0.02564928 
Adaptive bandwidth: 73 CV score: 0.02608017 
Adaptive bandwidth: 126 CV score: 0.02553037 
Adaptive bandwidth: 139 CV score: 0.02551064 </code></pre>
</div>
</div>
<p>The adaptive bandwidth values (e.g., 106, 73, 126, 139) control the number of neighboring points included in each localized regression. Each bandwidth produced a Cross-Validation (CV) score, with lower scores indicating a better model fit. Here, an adaptive bandwidth of 139 neighbors provided the lowest CV score (0.02551), suggesting it best balances model accuracy with spatial variability across the regions studied.</p>
</section>
<section id="this-function-really-need-the-model-wont-work-without-model." class="level2">
<h2 class="anchored" data-anchor-id="this-function-really-need-the-model-wont-work-without-model.">This function really need the model, won’t work without model.</h2>
<p>Then we compute the GWR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> FPAI <span class="sc">~</span> FinancialEducation_YesNo_Ratio <span class="sc">+</span> Total_GroupContribution <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    Old_Pension <span class="sc">+</span> BorrowedFrom_MobileMoney <span class="sc">+</span> Other_Insurance_Products <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    ConfidentWithSavingsGroups <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    SoldLivestock <span class="sc">+</span> Mean_AmountOwed <span class="sc">+</span> Mean_Age <span class="sc">+</span> ConfidentWithSACCOs <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    ConfidentWithUTTs <span class="sc">+</span> OtherIncome <span class="sc">+</span> ConfidentWithFamilyFriends <span class="sc">+</span> </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    Mean_AmountBetting <span class="sc">+</span> Places_Not_In_My_Area <span class="sc">+</span> DontKnowHow <span class="sc">+</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    CertofOccupancy <span class="sc">+</span> Personal_Accident_Insurance <span class="sc">+</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    Agent_Absent <span class="sc">+</span> Advice_NoOne <span class="sc">+</span> Private_Health_Insurance <span class="sc">+</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    Urban <span class="sc">+</span> Traders_non_agricultural_Income <span class="sc">+</span> Used_POS <span class="sc">+</span> Used_AZAMPay <span class="sc">+</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    Lost_Money <span class="sc">+</span> TooComplicated <span class="sc">+</span> Household_Not_On_Register,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> tanzania_cleaned, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive, </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>, </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>gwr_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2024-11-01 16:36:47.84668 
   Call:
   gwr.basic(formula = FPAI ~ FinancialEducation_YesNo_Ratio + Total_GroupContribution + 
    Old_Pension + BorrowedFrom_MobileMoney + Other_Insurance_Products + 
    ConfidentWithSavingsGroups + SoldLivestock + Mean_AmountOwed + 
    Mean_Age + ConfidentWithSACCOs + ConfidentWithUTTs + OtherIncome + 
    ConfidentWithFamilyFriends + Mean_AmountBetting + Places_Not_In_My_Area + 
    DontKnowHow + CertofOccupancy + Personal_Accident_Insurance + 
    Agent_Absent + Advice_NoOne + Private_Health_Insurance + 
    Urban + Traders_non_agricultural_Income + Used_POS + Used_AZAMPay + 
    Lost_Money + TooComplicated + Household_Not_On_Register, 
    data = tanzania_cleaned, bw = bw_adaptive, kernel = "gaussian", 
    adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable:  FPAI
   Independent variables:  FinancialEducation_YesNo_Ratio Total_GroupContribution Old_Pension BorrowedFrom_MobileMoney Other_Insurance_Products ConfidentWithSavingsGroups SoldLivestock Mean_AmountOwed Mean_Age ConfidentWithSACCOs ConfidentWithUTTs OtherIncome ConfidentWithFamilyFriends Mean_AmountBetting Places_Not_In_My_Area DontKnowHow CertofOccupancy Personal_Accident_Insurance Agent_Absent Advice_NoOne Private_Health_Insurance Urban Traders_non_agricultural_Income Used_POS Used_AZAMPay Lost_Money TooComplicated Household_Not_On_Register
   Number of data points: 160
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
      Min        1Q    Median        3Q       Max 
-0.032792 -0.006249 -0.000726  0.006455  0.028469 

   Coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)                     -1.928e-03  1.294e-02  -0.149 0.881742    
   FinancialEducation_YesNo_Ratio   5.019e-02  1.050e-02   4.782 4.61e-06 ***
   Total_GroupContribution          2.356e-08  6.728e-09   3.501 0.000634 ***
   Old_Pension                      9.243e-03  9.551e-04   9.677  &lt; 2e-16 ***
   BorrowedFrom_MobileMoney         3.197e-03  8.149e-04   3.924 0.000140 ***
   Other_Insurance_Products         7.744e-03  2.049e-03   3.779 0.000238 ***
   ConfidentWithSavingsGroups       1.405e-03  2.278e-04   6.168 8.00e-09 ***
   SoldLivestock                   -8.383e-04  1.777e-04  -4.717 6.04e-06 ***
   Mean_AmountOwed                  3.032e-08  8.086e-09   3.750 0.000265 ***
   Mean_Age                         1.040e-03  3.124e-04   3.330 0.001130 ** 
   ConfidentWithSACCOs             -2.077e-03  3.403e-04  -6.103 1.10e-08 ***
   ConfidentWithUTTs                1.381e-03  4.935e-04   2.799 0.005906 ** 
   OtherIncome                      4.252e-03  1.241e-03   3.427 0.000817 ***
   ConfidentWithFamilyFriends      -4.479e-04  1.267e-04  -3.534 0.000567 ***
   Mean_AmountBetting               5.005e-06  8.707e-07   5.748 6.03e-08 ***
   Places_Not_In_My_Area           -8.253e-04  2.564e-04  -3.220 0.001619 ** 
   DontKnowHow                      1.767e-03  3.324e-04   5.314 4.48e-07 ***
   CertofOccupancy                  1.772e-03  5.344e-04   3.316 0.001180 ** 
   Personal_Accident_Insurance      1.685e-02  8.388e-03   2.009 0.046540 *  
   Agent_Absent                     6.534e-04  2.013e-04   3.246 0.001484 ** 
   Advice_NoOne                    -6.727e-04  1.296e-04  -5.191 7.77e-07 ***
   Private_Health_Insurance         8.574e-03  1.923e-03   4.458 1.76e-05 ***
   Urban                            3.014e-02  5.942e-03   5.073 1.31e-06 ***
   Traders_non_agricultural_Income -1.447e-03  3.569e-04  -4.053 8.62e-05 ***
   Used_POS                        -3.162e-03  8.552e-04  -3.697 0.000319 ***
   Used_AZAMPay                     1.900e-03  5.490e-04   3.461 0.000727 ***
   Lost_Money                      -2.959e-03  8.758e-04  -3.378 0.000961 ***
   TooComplicated                   2.444e-03  9.278e-04   2.634 0.009444 ** 
   Household_Not_On_Register       -1.266e-02  4.948e-03  -2.559 0.011641 *  

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 0.01143 on 131 degrees of freedom
   Multiple R-squared: 0.8602
   Adjusted R-squared: 0.8303 
   F-statistic: 28.79 on 28 and 131 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 0.01711363
   Sigma(hat): 0.01040741
   AIC:  -948.8283
   AICc:  -934.4097
   BIC:  -864.3179
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 139 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                                          Min.     1st Qu.      Median
   Intercept                       -4.3495e-03 -3.8893e-03 -2.3720e-03
   FinancialEducation_YesNo_Ratio   4.6328e-02  4.7060e-02  4.8469e-02
   Total_GroupContribution          2.3439e-08  2.3817e-08  2.4125e-08
   Old_Pension                      9.1322e-03  9.1660e-03  9.2719e-03
   BorrowedFrom_MobileMoney         3.0605e-03  3.0934e-03  3.1957e-03
   Other_Insurance_Products         7.2728e-03  7.3979e-03  7.5307e-03
   ConfidentWithSavingsGroups       1.3799e-03  1.3964e-03  1.4078e-03
   SoldLivestock                   -8.8819e-04 -8.8046e-04 -8.4497e-04
   Mean_AmountOwed                  2.9631e-08  3.0235e-08  3.1037e-08
   Mean_Age                         1.0155e-03  1.0361e-03  1.0541e-03
   ConfidentWithSACCOs             -2.2011e-03 -2.1849e-03 -2.1096e-03
   ConfidentWithUTTs                1.2377e-03  1.3072e-03  1.4233e-03
   OtherIncome                      4.1748e-03  4.2029e-03  4.2454e-03
   ConfidentWithFamilyFriends      -4.7641e-04 -4.5949e-04 -4.4982e-04
   Mean_AmountBetting               4.7163e-06  4.8453e-06  5.0613e-06
   Places_Not_In_My_Area           -8.9183e-04 -8.5611e-04 -8.0557e-04
   DontKnowHow                      1.6915e-03  1.7223e-03  1.7575e-03
   CertofOccupancy                  1.6647e-03  1.6854e-03  1.7305e-03
   Personal_Accident_Insurance      1.5523e-02  1.6464e-02  1.8118e-02
   Agent_Absent                     6.2667e-04  6.4292e-04  6.7661e-04
   Advice_NoOne                    -6.9901e-04 -6.9187e-04 -6.7321e-04
   Private_Health_Insurance         8.1512e-03  8.4763e-03  8.7232e-03
   Urban                            2.8425e-02  2.8850e-02  3.0144e-02
   Traders_non_agricultural_Income -1.5428e-03 -1.5287e-03 -1.4694e-03
   Used_POS                        -3.3227e-03 -3.2368e-03 -3.1707e-03
   Used_AZAMPay                     1.7993e-03  1.8203e-03  1.8679e-03
   Lost_Money                      -3.0025e-03 -2.9297e-03 -2.8612e-03
   TooComplicated                   2.1969e-03  2.2634e-03  2.3168e-03
   Household_Not_On_Register       -1.4141e-02 -1.3739e-02 -1.2795e-02
                                       3rd Qu.    Max.
   Intercept                       -1.2103e-03 -0.0009
   FinancialEducation_YesNo_Ratio   4.9507e-02  0.0507
   Total_GroupContribution          2.4376e-08  0.0000
   Old_Pension                      9.3878e-03  0.0094
   BorrowedFrom_MobileMoney         3.2988e-03  0.0033
   Other_Insurance_Products         7.7837e-03  0.0079
   ConfidentWithSavingsGroups       1.4225e-03  0.0014
   SoldLivestock                   -8.0402e-04 -0.0008
   Mean_AmountOwed                  3.1864e-08  0.0000
   Mean_Age                         1.0730e-03  0.0011
   ConfidentWithSACCOs             -2.0165e-03 -0.0020
   ConfidentWithUTTs                1.5184e-03  0.0015
   OtherIncome                      4.2802e-03  0.0043
   ConfidentWithFamilyFriends      -4.4117e-04 -0.0004
   Mean_AmountBetting               5.2411e-06  0.0000
   Places_Not_In_My_Area           -7.6570e-04 -0.0007
   DontKnowHow                      1.7983e-03  0.0018
   CertofOccupancy                  1.7946e-03  0.0018
   Personal_Accident_Insurance      1.9186e-02  0.0202
   Agent_Absent                     6.9118e-04  0.0007
   Advice_NoOne                    -6.5262e-04 -0.0006
   Private_Health_Insurance         8.8849e-03  0.0090
   Urban                            3.1653e-02  0.0319
   Traders_non_agricultural_Income -1.4160e-03 -0.0014
   Used_POS                        -3.0888e-03 -0.0030
   Used_AZAMPay                     1.9285e-03  0.0020
   Lost_Money                      -2.8148e-03 -0.0027
   TooComplicated                   2.4290e-03  0.0025
   Household_Not_On_Register       -1.1985e-02 -0.0114
   ************************Diagnostic information*************************
   Number of data points: 160 
   Effective number of parameters (2trace(S) - trace(S'S)): 38.08473 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 121.9153 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): -930.4049 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): -986.5941 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): -1008.274 
   Residual sum of squares: 0.01590606 
   R-square value:  0.8700761 
   Adjusted R-square value:  0.829154 

   ***********************************************************************
   Program stops at: 2024-11-01 16:36:47.879874 </code></pre>
</div>
</div>
</section>
<section id="visualizing-gwr-output" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-gwr-output">Visualizing GWR Output</h2>
<section id="converting-sdf-into-sf-data.frame" class="level3">
<h3 class="anchored" data-anchor-id="converting-sdf-into-sf-data.frame">Converting SDF into sf data.frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive_output <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  gwr_adaptive<span class="sc">$</span>SDF)<span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">32</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We must exclude the intercept in column number 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>gwr_sf_adaptive <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tanzania_cleaned,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                         gwr_adaptive_output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualizing-local-r2" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-local-r2">Visualizing local R2</h3>
<p>Using the localized model, the model performance goes up all the way to 0.95 for some particularly locations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(tanzbounds)<span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(gwr_sf_adaptive) <span class="sc">+</span>  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"Local_R2"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">border.col =</span> <span class="st">"gray"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">border.lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualizing-coefficient-estimates" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-coefficient-estimates">Visualizing coefficient estimates</h3>
<hr>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<hr>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Demirgüç-Kunt, A., Klapper, L., &amp; Singer, D. (2017).&nbsp;<em>Financial inclusion and inclusive growth: A review of recent empirical evidence</em>&nbsp;(WPS8040). Development Research Group, Finance and Private Sector Development Team. https://doi.org/10.1596/1813-9450-8040</p>
<p>Koomson, I., Churchill, S.A. &amp; Munyanyi, M.E. Gambling and Financial Stress.&nbsp;<em>Soc Indic Res</em><strong>163</strong>, 473–503 (2022). https://doi.org/10.1007/s11205-022-02898-6</p>
<p>United Nations Capital Development Fund (UNCDF). (2024).&nbsp;<em>Insights from Tanzania: Global data reveals financial inclusion for women</em>. Retrieved from&nbsp;<a href="https://policyaccelerator.uncdf.org/whats-new/insights-tanzania-global-data-reveals-financial-inclusion-women" class="uri">https://policyaccelerator.uncdf.org/whats-new/insights-tanzania-global-data-reveals-financial-inclusion-women</a></p>
<p>World Bank. (17 April, 2024).&nbsp;<em>Financial inclusion in Sub-Saharan Africa: Overview</em>. Retrieved from&nbsp;<a href="https://www.worldbank.org/en/publication/globalfindex/brief/financial-inclusion-in-sub-saharan-africa-overview" class="uri">https://www.worldbank.org/en/publication/globalfindex/brief/financial-inclusion-in-sub-saharan-africa-overview</a></p>
<p>World Bank. (2022).&nbsp;<em>Global financial inclusion: A comprehensive overview</em>. Retrieved from&nbsp;<a href="https://documents1.worldbank.org/curated/en/099305408252329233/pdf/SECBOS1e6ff9a00041b4261bcdc9c154a7b.pdf" class="uri">https://documents1.worldbank.org/curated/en/099305408252329233/pdf/SECBOS1e6ff9a00041b4261bcdc9c154a7b.pdf</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>