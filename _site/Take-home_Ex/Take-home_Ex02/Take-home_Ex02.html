<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sei Sar Hla Kyi">
<meta name="dcterms.date" content="2024-09-25">

<title>ISSS626-GAA - Take Home Exercise 2: Impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-Class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-Class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-Class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1 Overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">1.2 Objectives</a></li>
  <li><a href="#determining-tourism-economy-indicators" id="toc-determining-tourism-economy-indicators" class="nav-link" data-scroll-target="#determining-tourism-economy-indicators">1.3 Determining Tourism Economy Indicators</a></li>
  </ul></li>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages">2 Loading R Packages</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#the-datasets" id="toc-the-datasets" class="nav-link" data-scroll-target="#the-datasets">3.1 The Datasets</a></li>
  <li><a href="#import-the-data" id="toc-import-the-data" class="nav-link" data-scroll-target="#import-the-data">3.2 Import the Data</a>
  <ul class="collapse">
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">3.2.1 Aspatial Data</a></li>
  <li><a href="#geospatial-data---study-area" id="toc-geospatial-data---study-area" class="nav-link" data-scroll-target="#geospatial-data---study-area">3.2.2 Geospatial Data - Study Area</a></li>
  <li><a href="#creating-tourism-economy-indicators-layer" id="toc-creating-tourism-economy-indicators-layer" class="nav-link" data-scroll-target="#creating-tourism-economy-indicators-layer">3.2.3 Creating Tourism Economy Indicators Layer</a></li>
  <li><a href="#derived-tourism-economy-indicators-layer-in-spacetime" id="toc-derived-tourism-economy-indicators-layer-in-spacetime" class="nav-link" data-scroll-target="#derived-tourism-economy-indicators-layer-in-spacetime">3.2.4 Derived Tourism Economy Indicators Layer in spacetime</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#independence-of-thailands-tourism-economy-indicators-from-space" id="toc-independence-of-thailands-tourism-economy-indicators-from-space" class="nav-link" data-scroll-target="#independence-of-thailands-tourism-economy-indicators-from-space">4 Independence of Thailand’s Tourism Economy Indicators from Space</a>
  <ul class="collapse">
  <li><a href="#global-spatial-autocorrelation-analysis" id="toc-global-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis">4.1 Global Spatial Autocorrelation Analysis</a>
  <ul class="collapse">
  <li><a href="#method-overview" id="toc-method-overview" class="nav-link" data-scroll-target="#method-overview">4.1.1 Method Overview</a></li>
  <li><a href="#k-nearest-neighbors-knn" id="toc-k-nearest-neighbors-knn" class="nav-link" data-scroll-target="#k-nearest-neighbors-knn">4.1.2 K-nearest neighbors (KNN)</a></li>
  <li><a href="#performing-global-morans-i" id="toc-performing-global-morans-i" class="nav-link" data-scroll-target="#performing-global-morans-i">4.1.3 Performing Global Moran’s I</a></li>
  </ul></li>
  <li><a href="#local-spatial-autocorrelation-analysis" id="toc-local-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis">4.2 Local Spatial Autocorrelation Analysis</a>
  <ul class="collapse">
  <li><a href="#computing-local-morans-i-for-total-revenue" id="toc-computing-local-morans-i-for-total-revenue" class="nav-link" data-scroll-target="#computing-local-morans-i-for-total-revenue">4.2.1 Computing Local Moran’s I for Total Revenue</a></li>
  <li><a href="#computing-local-morans-i-for-occupancy-rate" id="toc-computing-local-morans-i-for-occupancy-rate" class="nav-link" data-scroll-target="#computing-local-morans-i-for-occupancy-rate">4.2.2 Computing Local Moran’s I for Occupancy Rate</a></li>
  <li><a href="#computing-local-morans-i-for-number-of-foreign-tourists" id="toc-computing-local-morans-i-for-number-of-foreign-tourists" class="nav-link" data-scroll-target="#computing-local-morans-i-for-number-of-foreign-tourists">4.2.3 Computing Local Moran’s I for Number of Foreign Tourists</a></li>
  <li><a href="#interpretation-of-strongest-negative-positive-morans-i-statistics" id="toc-interpretation-of-strongest-negative-positive-morans-i-statistics" class="nav-link" data-scroll-target="#interpretation-of-strongest-negative-positive-morans-i-statistics">4.2.4 Interpretation of Strongest Negative &amp; Positive Moran’s I Statistics</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#independence-of-thailands-tourism-economy-indicators-from-space-and-time-a-pre-during-and-post-covid-analysis" id="toc-independence-of-thailands-tourism-economy-indicators-from-space-and-time-a-pre-during-and-post-covid-analysis" class="nav-link" data-scroll-target="#independence-of-thailands-tourism-economy-indicators-from-space-and-time-a-pre-during-and-post-covid-analysis">5 Independence of Thailand’s Tourism Economy Indicators from Space and Time : A Pre, During, and Post-COVID Analysis</a>
  <ul class="collapse">
  <li><a href="#splitting-the-data-defining-the-temporal-terms" id="toc-splitting-the-data-defining-the-temporal-terms" class="nav-link" data-scroll-target="#splitting-the-data-defining-the-temporal-terms">5.1 Splitting the Data : Defining the Temporal Terms</a>
  <ul class="collapse">
  <li><a href="#k-nearest-neighbors-knn-on-temporal-terms" id="toc-k-nearest-neighbors-knn-on-temporal-terms" class="nav-link" data-scroll-target="#k-nearest-neighbors-knn-on-temporal-terms">5.1.1 K-nearest neighbors (KNN) on Temporal Terms</a></li>
  </ul></li>
  <li><a href="#total-revenue-1" id="toc-total-revenue-1" class="nav-link" data-scroll-target="#total-revenue-1">5.2 Total Revenue</a>
  <ul class="collapse">
  <li><a href="#global-spatial-autocorrelation-analysis-1" id="toc-global-spatial-autocorrelation-analysis-1" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis-1">5.2.1 Global Spatial Autocorrelation Analysis</a></li>
  <li><a href="#local-spatial-autocorrelation-analysis-1" id="toc-local-spatial-autocorrelation-analysis-1" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis-1">5.2.2 Local Spatial Autocorrelation Analysis</a></li>
  </ul></li>
  <li><a href="#occupancy-rate-3" id="toc-occupancy-rate-3" class="nav-link" data-scroll-target="#occupancy-rate-3">5.3 Occupancy Rate</a>
  <ul class="collapse">
  <li><a href="#global-spatial-autocorrelation-analysis-2" id="toc-global-spatial-autocorrelation-analysis-2" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis-2">5.3.1 Global Spatial Autocorrelation Analysis</a></li>
  <li><a href="#local-spatial-autocorrelation-analysis-2" id="toc-local-spatial-autocorrelation-analysis-2" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis-2">5.3.2 Local Spatial Autocorrelation Analysis</a></li>
  </ul></li>
  <li><a href="#number-of-foreign-tourists-2" id="toc-number-of-foreign-tourists-2" class="nav-link" data-scroll-target="#number-of-foreign-tourists-2">5.4 Number of Foreign Tourists</a>
  <ul class="collapse">
  <li><a href="#global-spatial-autocorrelation-analysis-3" id="toc-global-spatial-autocorrelation-analysis-3" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis-3">5.4.1 Global Spatial Autocorrelation Analysis</a></li>
  <li><a href="#local-spatial-autocorrelation-analysis-3" id="toc-local-spatial-autocorrelation-analysis-3" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis-3">5.4.2 Local Spatial Autocorrelation Analysis</a></li>
  </ul></li>
  <li><a href="#overall-results-and-policy-suggestions-from-space-time-analysis" id="toc-overall-results-and-policy-suggestions-from-space-time-analysis" class="nav-link" data-scroll-target="#overall-results-and-policy-suggestions-from-space-time-analysis">5.5 Overall Results and Policy Suggestions from Space &amp; Time Analysis</a></li>
  </ul></li>
  <li><a href="#emerging-hotspot-analysis" id="toc-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#emerging-hotspot-analysis">6 Emerging Hotspot Analysis</a>
  <ul class="collapse">
  <li><a href="#method-overview-1" id="toc-method-overview-1" class="nav-link" data-scroll-target="#method-overview-1">6.1 Method Overview</a></li>
  <li><a href="#computing-gi-statistics" id="toc-computing-gi-statistics" class="nav-link" data-scroll-target="#computing-gi-statistics">6.1 Computing Gi* Statistics</a></li>
  <li><a href="#mann-kendall-test" id="toc-mann-kendall-test" class="nav-link" data-scroll-target="#mann-kendall-test">6.2 Mann-Kendall Test</a>
  <ul class="collapse">
  <li><a href="#revenue-3" id="toc-revenue-3" class="nav-link" data-scroll-target="#revenue-3">6.2.1 Revenue</a></li>
  <li><a href="#occupancy-rate-4" id="toc-occupancy-rate-4" class="nav-link" data-scroll-target="#occupancy-rate-4">6.2.2 Occupancy Rate</a></li>
  <li><a href="#number-of-foreign-tourists-4" id="toc-number-of-foreign-tourists-4" class="nav-link" data-scroll-target="#number-of-foreign-tourists-4">6.2.3 Number of Foreign Tourists</a></li>
  </ul></li>
  <li><a href="#performing-emerging-hotspot-analysis" id="toc-performing-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#performing-emerging-hotspot-analysis">6.3 Performing Emerging Hotspot Analysis</a></li>
  <li><a href="#visualizing-emerging-hotspot-analysis" id="toc-visualizing-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#visualizing-emerging-hotspot-analysis">6.4 Visualizing Emerging Hotspot Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">7 Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 2: Impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sei Sar Hla Kyi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 25, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1 Overview</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.1 Background</h2>
<p>Tourism has long been one of the key pillars of Thailand’s economy, contributing significantly to the country’s gross domestic product (GDP). In 2019, prior to the COVID-19 pandemic, the tourism sector generated approximately 90 billion US dollars from domestic and international visitors, representing around 20% of the nation’s GDP. However, the pandemic severely impacted global travel and tourism, leading to a dramatic revenue decline to just 24 billion US dollars in 2020. The recovery of the tourism industry began gradually around September 2021, driven by both domestic reopening and the resumption of international travel.</p>
<p>Despite this gradual recovery, tourism income is not evenly distributed across the country. Thailand’s tourism economy is heavily concentrated in a few key provinces—Bangkok, Phuket, Chiang Mai, Sukhothai, and Phetchaburi—due to their cultural significance, economic importance, and tourism infrastructure. These provinces attract the bulk of visitors, while other areas benefit less from tourism activities. This uneven distribution raises questions about the spatial dependence and clustering of tourism-related economic indicators, which are of great interest to policymakers, economists, and urban planners aiming to foster more inclusive economic development through tourism.</p>
<p>With advancements in geospatial analytics, we can examine how economic patterns shift regionally and temporally. Understanding the spatial and spatio-temporal dynamics of tourism is critical for promoting equitable growth, improving infrastructure, and enhancing the resilience of local economies. By investigating these patterns, it becomes possible to detect clusters of tourism activity, emerging hot spots, and potential cold spots, allowing for more targeted interventions in the tourism sector.</p>
<hr>
</section>
<section id="objectives" class="level2">
<h2 class="anchored" data-anchor-id="objectives">1.2 Objectives</h2>
<p>The primary goal of this analysis is to explore whether the key indicators of Thailand’s tourism economy demonstrate space and space and time dependence. Specifically, the objectives of this study are as follows:</p>
<ol type="1">
<li><p><strong>Assess Space and Space and Time Independence</strong>: Investigate whether the tourism economy is independent of geographic space and time, or if there is significant clustering of economic activity in certain regions over specific time periods.</p></li>
<li><p><strong>Identify Clusters and Outliers</strong>: If space and space and time dependence exists, detect the locations of clusters and outliers, identifying areas where tourism-related economic activity is abnormally high or low compared to neighboring regions.</p></li>
<li><p><strong>Detect Emerging Hot Spots and Cold Spots</strong>: Conduct emerging hotspot analysis to determine areas where tourism activity is intensifying or declining over time, highlighting regions that may be experiencing rapid growth or a downturn in tourism-driven economic development.</p></li>
</ol>
</section>
<section id="determining-tourism-economy-indicators" class="level2">
<h2 class="anchored" data-anchor-id="determining-tourism-economy-indicators">1.3 Determining Tourism Economy Indicators</h2>
<p><u><strong>Total Revenue</strong></u></p>
<p>We chose to use total revenue from the tourism sector (denoted as <code>revenue_all</code>) as our one of our indicator of interest because it serves as a comprehensive indicator of the economic impact of tourism on a region. Revenue from tourism is a direct reflection of the sector’s contribution to the local economy, by including spending from both domestic and international tourists across various services. By focusing on total revenue, we capture the aggregate demand generated by tourism, which is a critical driver of economic growth, employment, and infrastructure development within a province. Furthermore, revenue is a more stable and reliable measure compared to other variables like visitor count, as it accounts for variations in the types of tourists and the value of their spending. This makes it a more appropriate and meaningful variable to assess the overall economic benefits that tourism brings to the regions in our study.</p>
<p><u><strong>Occupancy Rate</strong></u></p>
<p>The occupancy rate (denoted as <code>ratio_tourist_stay</code>)is a critical indicator of tourism economy as it measures the percentage of available accommodations (e.g., hotels, guesthouses) that are occupied by tourists at a given time. A high occupancy rate suggests strong demand for tourist services and indicates a thriving tourism sector, which can positively affect related industries like hospitality, transportation, and local businesses. Tracking this variable allows for assessing seasonal variations in tourist flow.</p>
<p><u><strong>Number of foreign tourists</strong></u></p>
<p>The number of foreign tourists (denoted as <code>no_tourist_foreign)</code> visiting a province is another valuable indicator of tourism’s contribution to the economy. Foreign tourists typically bring in foreign currency, contributing to the province’s overall economic growth. They may also have different spending behaviors compared to domestic tourists, which could stimulate demand for luxury goods, international cuisine, or premium tourist experiences. Understanding the volume of foreign tourists also allows us to understand the impact of COVID-19 clearly.</p>
<hr>
</section>
</section>
<section id="loading-r-packages" class="level1">
<h1>2 Loading R Packages</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Packages Used</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The following packages were used for this study:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Package</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tidyverse</td>
<td>For non-spatial data wrangling</td>
</tr>
<tr class="even">
<td>corrplot</td>
<td>For correlation analysis among chosen variables</td>
</tr>
<tr class="odd">
<td>sf</td>
<td>For importing, managing, and handling geospatial data</td>
</tr>
<tr class="even">
<td>sfdep</td>
<td>To derive tourism economy indicator layer</td>
</tr>
<tr class="odd">
<td>tmap</td>
<td>For visualizing maps</td>
</tr>
<tr class="even">
<td>ggplot2</td>
<td>To visualize other statistics</td>
</tr>
<tr class="odd">
<td>plotly</td>
<td>For interactive mapping</td>
</tr>
<tr class="even">
<td>Kendall</td>
<td>For performing Mann Kendall test for emerging hotspot analysis</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,corrplot, sf, sfdep, tmap, ggplot2, plotly, Kendall)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<hr>
</section>
<section id="data-preparation" class="level1">
<h1>3 Data Preparation</h1>
<section id="the-datasets" class="level2">
<h2 class="anchored" data-anchor-id="the-datasets">3.1 The Datasets</h2>
<p>For the purpose of this analysis, two datasets are utilized to explore the spatial and spatio-temporal patterns of Thailand’s tourism economy.</p>
<ol type="1">
<li><strong>Thailand Domestic Tourism Statistics (version 2)</strong> from Kaggle, provides detailed tourism-related data such as monthly revenue receipts and visitor counts at the provincial level. This dataset is critical for analyzing economic trends within the tourism sector and identifying regional disparities in tourism activities across different provinces in Thailand.</li>
<li><strong>Thailand - Subnational Administrative Boundaries</strong> from the Humanitarian Data Exchange (HDX), provides geographic boundary data at the provincial level. This dataset offers the spatial context required for mapping and conducting spatial autocorrelation and hotspot analysis, linking tourism statistics to specific geographic regions across Thailand.</li>
</ol>
<p>These datasets together enable a comprehensive geospatial analysis of the tourism economy, facilitating both spatial and temporal investigations into tourism clusters, outliers, and emerging hot spots or cold spots across Thailand’s provinces.</p>
</section>
<section id="import-the-data" class="level2">
<h2 class="anchored" data-anchor-id="import-the-data">3.2 Import the Data</h2>
<section id="aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="aspatial-data">3.2.1 Aspatial Data</h3>
<p>The <em>Thailand Domestic Tourism Statistics</em> dataset from 2019-2023, was imported by using <em>read_csv()</em> package.</p>
<p>Then, the data was prepared for analysis with the following steps:</p>
<ul>
<li><strong><code>pivot_wider()</code></strong> function was used to reshape the dataset by transforming the long format (multiple rows per&nbsp;<code>date</code> &amp; <code>province_eng</code>) into a wide format (one row per&nbsp;<code>date</code>&amp; <code>province_eng</code>&nbsp;combination). This transposes the variables and assign corresponding values in the cells.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We visualize which province contributes the highest tourism revenue to roughly understand areas where tourism is a key economic driver, providing more relevant insights into spatial and temporal tourism trends.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, we noted that revenue is quite skewed and unevenly distributed.</p>
<p>We will also see if there is any correlation among our three chosen tourism economy indicators.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From viewing the correlation analysis, we see that <code>revenue_all</code> and <code>no_tourist_foreign</code> have a high correlation of 0.96. However, we will still choose <code>no_tourist_foreign</code> as one of our tourism economy indicators because the number of foreign tourists provides direct insights into international tourism demand and its influence on local economies. While highly correlated with revenue, <code>no_tourist_foreign</code> captures the volume of international visitors, which is crucial for understanding trends in foreign market engagement, the potential for tourism-driven economic policies, and the impact of external factors such as global travel restrictions.</p>
<p>We are now ready to select relevant rows in our dataset using <strong><em>select()</em></strong> as shown in code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, province_eng, ratio_tourist_stay, no_tourist_foreign, revenue_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use <strong><em>glimpse()</em></strong> to quickly check the attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,850
Columns: 5
$ date               &lt;date&gt; 2019-01-01, 2019-01-01, 2019-01-01, 2019-01-01, 20…
$ province_eng       &lt;chr&gt; "Bangkok", "Lopburi", "Phra Nakhon Si Ayutthaya", "…
$ ratio_tourist_stay &lt;dbl&gt; 93.37, 61.32, 73.37, 67.33, 79.31, 71.70, 64.65, 71…
$ no_tourist_foreign &lt;dbl&gt; 2425014, 2363, 168776, 5836, 559, 11699, 248, 5281,…
$ revenue_all        &lt;dbl&gt; 81926490000, 457240000, 1438730000, 347790000, 1017…</code></pre>
</div>
</div>
<p>Lastly, we will save the prepared dataframe into rds format.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tourism, <span class="st">"data/rds/tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="geospatial-data---study-area" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-data---study-area">3.2.2 Geospatial Data - Study Area</h3>
<p>The <em>Thailand - Subnational Administrative Boundaries</em> dataset, was imported by using <em>st_read()</em> package.</p>
<p>The dataset was prepared for analysis with the following steps:</p>
<ul>
<li><p>From a quick review of the dataset, variable <strong><em>ADM1_EN</em></strong> contains the provinces in Thailand. Since our analysis for this study is on provincial level, we will use this variable as a common variable to join with the tourism dataset. Therefore, we need to change the name of this variable to ‘province_eng’ to make it a common variable with the Tourism Statistics dataset.</p></li>
<li><p>We will use st_transform to reproject coordinate reference system to EPSG: 32647 for Thailand.</p></li>
<li><p>Change the spelling of some provinces such as Chon Buri to “Chonburi” to be the same as the way it was spelled in Tourism Statistics dataset.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>thaibounds <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/rawdata/"</span>, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">layer =</span> <span class="st">"tha_admbnda_adm2_rtsd_20220121"</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">32647</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">province_eng =</span> ADM1_EN) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>date)<span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Chon Buri"</span>, <span class="st">"Chonburi"</span>, province_eng)) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Lop Buri"</span>, <span class="st">"Lopburi"</span>, province_eng)) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Chai Nat"</span>, <span class="st">"Chainat"</span>, province_eng)) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Prachin Buri"</span>, <span class="st">"Prachinburi"</span>, province_eng))<span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Buri Ram"</span>, <span class="st">"Buriram"</span>, province_eng))<span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Si Sa Ket"</span>, <span class="st">"Sisaket"</span>, province_eng))<span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Nong Bua Lam Phu"</span>, <span class="st">"Nong Bua Lamphu"</span>, province_eng))<span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">ifelse</span>(province_eng <span class="sc">==</span> <span class="st">"Phangnga"</span>, <span class="st">"Phang Nga"</span>, province_eng))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(thaibounds, <span class="st">"data/rds/thaibounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>thaibounds <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/thaibounds.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="creating-tourism-economy-indicators-layer" class="level3">
<h3 class="anchored" data-anchor-id="creating-tourism-economy-indicators-layer">3.2.3 Creating Tourism Economy Indicators Layer</h3>
<p>Next, we will create a tourism economy indicators layer by left joining the geospatial dataframe (thaibounds) to the attribute dataframe (tourism) by using <strong><em>left_join()</em></strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
To perform a left_join(), we must ensure that there is a common column between the two. For our case, the common column is ‘province_eng’
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>thai_tourism <span class="ot">&lt;-</span> <span class="fu">left_join</span>(thaibounds,tourism)<span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">19</span><span class="sc">:</span><span class="dv">23</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, to check whether the correct columns are present and the output thai_tourism is properly joined, we will be viewing the data content using <strong><em>glimpse()</em></strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(thai_tourism)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 46,400
Columns: 8
$ Shape_Leng         &lt;dbl&gt; 0.08541733, 0.08541733, 0.08541733, 0.08541733, 0.0…
$ Shape_Area         &lt;dbl&gt; 0.0004504685, 0.0004504685, 0.0004504685, 0.0004504…
$ province_eng       &lt;chr&gt; "Bangkok", "Bangkok", "Bangkok", "Bangkok", "Bangko…
$ date               &lt;date&gt; 2019-01-01, 2020-01-01, 2021-01-01, 2022-01-01, 20…
$ ratio_tourist_stay &lt;dbl&gt; 93.37, 89.36, 7.54, 26.34, 75.02, 89.19, 68.37, 9.9…
$ no_tourist_foreign &lt;dbl&gt; 2425014, 2473725, 49154, 137591, 2122201, 2291482, …
$ revenue_all        &lt;dbl&gt; 81926490000, 88202890000, 9539730000, 11823610000, …
$ geometry           &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((662263.2 15..., MULTIP…</code></pre>
</div>
</div>
<p>Now that we see the dataset is prepared, we will save it in rds format.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Save</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Load</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(thai_tourism, <span class="st">"data/rds/thai_tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>thai_tourism <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/thai_tourism.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="derived-tourism-economy-indicators-layer-in-spacetime" class="level3">
<h3 class="anchored" data-anchor-id="derived-tourism-economy-indicators-layer-in-spacetime">3.2.4 Derived Tourism Economy Indicators Layer in spacetime</h3>
<p>Lastly, for our emerging hotspot analysis in later sections, we will have to derive a study area layer in <strong>spacetime s3 class of sfdep.</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
We use the <code>sfdep</code> package over <code>spdep</code> in this study due to its enhanced functionality and flexibility in handling modern spatial data formats, particularly <code>sf</code> (simple features) objects. Unlike <code>spdep</code>, which requires more manual steps to manage spatial objects and coordinate systems, <code>sfdep</code> seamlessly integrates spatial data processing with <code>sf</code> objects, making it more appropriate for our study’s workflow.
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>To convert the data into&nbsp;<code>spacetime</code>&nbsp;format, we will take the following steps:</p>
<ol type="1">
<li><p>We need to convert date field to integer, lubridated with the format YYYYMM as ‘201901’.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tourism <span class="ot">&lt;-</span> tourism <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date_int =</span> <span class="fu">year</span>(date) <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fu">month</span>(date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Since each province should only have&nbsp;<strong>one</strong>&nbsp;geometry (e.g., one polygon representing the whole province) we will aggregate thaibounds dataframe using <strong><em>st_union()</em></strong> and to convert all geometry types to be POLYGON in unison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>thaibounds_agg <span class="ot">&lt;-</span> thaibounds <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry))<span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geometry =</span> <span class="fu">st_cast</span>(geometry, <span class="st">"POLYGON"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(thaibounds_agg, <span class="st">"data/rds/thaibounds_agg.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Lastly, we convert it into a&nbsp;<code>spacetime</code>&nbsp;structure with <strong><em>spacetime()</em></strong> from&nbsp;<code>sfdep</code> with the following code chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tourism_spt <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.data =</span> tourism, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.geometry =</span> thaibounds_agg, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.loc_col =</span> <span class="st">"province_eng"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">.time_col =</span> <span class="st">"date_int"</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>To verify if tourism_spt is space-time cube object we use the <strong><em>is_spacetime_cube()</em></strong> code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(tourism_spt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div></li>
</ol>
<hr>
</section>
</section>
</section>
<section id="independence-of-thailands-tourism-economy-indicators-from-space" class="level1">
<h1>4 Independence of Thailand’s Tourism Economy Indicators from Space</h1>
<section id="global-spatial-autocorrelation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis">4.1 Global Spatial Autocorrelation Analysis</h2>
<p>Global Spatial Autocorrelation Analysis is a crucial method for examining the spatial dependence of economic variables, such as tourism revenue, across different regions. It tests whether the distribution of variables such as total revenue, is randomly dispersed, clustered, or exhibits a pattern based on the geographical arrangement of locations.</p>
<p>In this study, we apply Global Spatial Autocorrelation, specifically Moran’s I, to investigate whether the tourism economy in Thailand is spatially independent or if neighboring provinces tend to have similar or dissimilar levels of tourism activity for the three economy indicators. A significant positive spatial autocorrelation would indicate clustering of similar tourism levels across provinces, while negative autocorrelation suggests dissimilar values are adjacent to one another.</p>
<section id="method-overview" class="level3">
<h3 class="anchored" data-anchor-id="method-overview">4.1.1 Method Overview</h3>
<p>We will use the <strong>K-nearest neighbors (KNN) approach</strong> for computing distance-based spatial weights in our analysis of tourism economy indicators across provinces because it is the most suitable to capture local interactions among neighboring provinces, especially since the data from our chosen economy indicators are skewed. By selecting a fixed number of nearest neighbors, KNN allows us to identify patterns and relationships within the tourism data that are particularly relevant to local contexts.</p>
<p>On the other hand, contiguity weights, which focus on shared borders between regions, are not appropriate in this scenario because the provinces in Thailand may have significant tourism interactions even if they are not geographically adjacent. Given that tourism flows can transcend physical boundaries and depend on accessibility rather than mere contiguity, KNN provides a more relevant method for capturing the spatial relationships critical to our analysis of the tourism economy.</p>
<p>Lastly, we will use the computed KNN weights to test for independence and perform Moran I’s on our chosen indicators of tourism economy.</p>
</section>
<section id="k-nearest-neighbors-knn" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-knn">4.1.2 K-nearest neighbors (KNN)</h3>
<p>To find the K-nearest neighbor distance we will take the following steps:</p>
<ol type="1">
<li><p>First, we will extract the centroids of the&nbsp;<code>thai_tourism</code>&nbsp;for each province to get the coordinates for distance calculation. To overcome the issue of having multiple points for each location in the&nbsp;<code>thai_tourism</code>&nbsp;dataset (since it is a result of left join), we will now aggregate the data grouped by only province since we are not interested in time aspect here; just distance. We average ratio_tourist_stay since it is in percentage.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>agg_tourism_prov <span class="ot">&lt;-</span> thai_tourism <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_tourist_foreign =</span> <span class="fu">sum</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>We extract unique locations by using the&nbsp;<code>province_eng</code>&nbsp;column to ensure each province has a single point (centroid). Then, we compute centroids for the unique provinces using <code>st_centroid()</code> with the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>province_centroids <span class="ot">&lt;-</span> agg_tourism_prov <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, geometry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>To ensure the centroids are in proper locations and not located in the water</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaibounds) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span>  </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(province_centroids) <span class="sc">+</span>  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">title =</span> <span class="st">"Province Centroids"</span>) <span class="sc">+</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>, <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">just =</span> <span class="st">"top"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Province Centroids of Thai Tourism"</span>, <span class="at">main.title.size =</span> <span class="fl">0.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div></li>
<li><p>After ensuring the centroids are in proper locations,we convert centroids to coordinates.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(province_centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Compute adaptive distance weight matrix with k set at 6 neighbors using <strong><em>st_knn()</em></strong> from sfdep and view the structure of the matrix</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Calculation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Structure</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>knn <span class="ot">&lt;-</span> <span class="fu">st_knn</span>(province_centroids, <span class="at">k =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(knn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 77
 $ : int [1:6] 14 25 54 62 72 77
 $ : int [1:6] 7 37 46 60 63 66
 $ : int [1:6] 27 36 37 46 57 58
 $ : int [1:6] 14 28 34 35 56 73
 $ : int [1:6] 24 29 54 55 62 68
 $ : int [1:6] 3 12 26 49 53 57
 $ : int [1:6] 2 22 30 63 66 74
 $ : int [1:6] 17 22 24 29 34 42
 $ : int [1:6] 6 12 49 53 55 71
 $ : int [1:6] 11 19 20 23 41 47
 $ : int [1:6] 10 19 20 32 41 47
 $ : int [1:6] 3 6 9 49 53 57
 $ : int [1:6] 18 31 39 50 51 67
 $ : int [1:6] 17 24 25 54 56 77
 $ : int [1:6] 30 44 45 65 69 74
 $ : int [1:6] 2 7 27 52 66 74
 $ : int [1:6] 8 14 24 34 54 73
 $ : int [1:6] 31 39 40 48 67 70
 $ : int [1:6] 10 20 41 47 65 75
 $ : int [1:6] 10 19 23 47 65 69
 $ : int [1:6] 34 35 42 45 73 75
 $ : int [1:6] 2 7 26 46 60 63
 $ : int [1:6] 10 11 19 20 41 47
 $ : int [1:6] 5 14 17 54 68 77
 $ : int [1:6] 1 14 28 54 56 77
 $ : int [1:6] 3 6 37 46 49 60
 $ : int [1:6] 3 36 37 46 58 59
 $ : int [1:6] 4 14 25 56 73 77
 $ : int [1:6] 5 8 22 26 49 60
 $ : int [1:6] 7 15 22 44 63 74
 $ : int [1:6] 18 39 40 48 67 70
 $ : int [1:6] 11 19 21 41 47 75
 $ : int [1:6] 38 40 61 64 70 76
 $ : int [1:6] 8 14 17 21 35 73
 $ : int [1:6] 4 14 21 34 56 73
 $ : int [1:6] 3 27 37 46 57 58
 $ : int [1:6] 3 26 27 36 46 57
 $ : int [1:6] 33 40 61 64 70 76
 $ : int [1:6] 18 31 48 51 67 70
 $ : int [1:6] 18 31 38 61 64 70
 $ : int [1:6] 10 11 19 32 47 75
 $ : int [1:6] 8 21 22 30 44 45
 $ : int [1:6] 27 36 50 52 58 59
 $ : int [1:6] 7 15 30 42 45 65
 $ : int [1:6] 15 21 42 44 65 75
 $ : int [1:6] 2 3 27 36 37 60
 $ : int [1:6] 19 20 32 41 65 75
 $ : int [1:6] 18 31 39 40 67 70
 $ : int [1:6] 6 12 26 37 55 60
 $ : int [1:6] 13 43 52 57 58 59
 $ : int [1:6] 13 18 31 39 48 67
 $ : int [1:6] 3 27 36 43 58 59
 $ : int [1:6] 3 6 9 12 57 71
 $ : int [1:6] 1 14 24 25 68 77
 $ : int [1:6] 5 6 9 26 29 49
 $ : int [1:6] 4 14 25 28 35 73
 $ : int [1:6] 3 12 27 36 37 58
 $ : int [1:6] 3 27 36 52 57 59
 $ : int [1:6] 3 27 36 43 52 58
 $ : int [1:6] 2 22 26 37 46 63
 $ : int [1:6] 31 38 40 64 70 76
 $ : int [1:6] 1 5 54 68 72 77
 $ : int [1:6] 2 7 22 46 60 66
 $ : int [1:6] 33 38 40 61 70 76
 $ : int [1:6] 15 19 45 47 69 75
 $ : int [1:6] 2 7 16 27 46 63
 $ : int [1:6] 13 18 31 39 48 51
 $ : int [1:6] 5 24 54 62 72 77
 $ : int [1:6] 15 20 30 44 65 74
 $ : int [1:6] 18 31 40 48 61 64
 $ : int [1:6] 6 9 12 49 53 55
 $ : int [1:6] 1 25 54 62 68 77
 $ : int [1:6] 4 14 17 34 35 56
 $ : int [1:6] 7 15 16 30 63 66
 $ : int [1:6] 19 21 32 45 47 65
 $ : int [1:6] 33 38 40 61 64 70
 $ : int [1:6] 1 14 25 54 62 72
 - attr(*, "region.id")= chr [1:77] "1" "2" "3" "4" ...
 - attr(*, "call")= language spdep::knearneigh(x = pnts, k = k)
 - attr(*, "sym")= logi FALSE
 - attr(*, "type")= chr "knn"
 - attr(*, "knn-k")= num 6
 - attr(*, "class")= chr [1:2] "nb" "list"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Lastly we compute the KNN distance matrix weights using <strong><em>st_weights()</em></strong> from sfdep with the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>knn_weights <span class="ot">&lt;-</span> <span class="fu">st_weights</span>(knn, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="performing-global-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="performing-global-morans-i">4.1.3 Performing Global Moran’s I</h3>
<p>Now that we have the KNN weights ready, we can perform global spatial autocorrelation analysis.</p>
<p>To measure the degree to which similar or dissimilar values are clustered in space, we will performing Global Moran’s I. If the indicators are independent of space, Moran’s I should show no significant spatial autocorrelation. The following is the hypothesis that we would like to test.</p>
<ul>
<li><p><strong>Null Hypothesis (H0):</strong>&nbsp;The tourism economy indicators are spatially independent (randomly distributed in space).</p></li>
<li><p><strong>Alternative Hypothesis (H1) :</strong>&nbsp;There is spatial dependence, indicating that similar values are clustered or dispersed.</p></li>
</ul>
<p>The 95% confident interval will be used. (Significance level of 0.05)</p>
<p>We will use <code>global_moran()</code> function from <strong><em>sfdep</em></strong> package to compute the Global Moran’s I value for our three chosen indicator of tourism economy.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Total Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Occupancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Number of Foreign Tourists</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran</span>(agg_tourism_prov<span class="sc">$</span>revenue_all, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$I
[1] -0.02579891

$K
[1] 73.48954</code></pre>
</div>
</div>
<p>The Moran’s I value is negative and close to zero, indicating a slight tendency toward spatial dispersion or randomness. However, since the value is small, this suggests that the revenue distribution does not show strong evidence of spatial clustering or dispersion. It is likely that revenue values are fairly random across provinces.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran</span>(agg_tourism_prov<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$I
[1] -0.08109265

$K
[1] 10.7366</code></pre>
</div>
</div>
<p>The Moran’s I value is also negative, meaning that areas with high occupancy rates tend to be randomn. The value is slightly higher than revenue’s indicating a slightly higher spatial autocorrelation.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran</span>(agg_tourism_prov<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$I
[1] -0.01733206

$K
[1] 73.06272</code></pre>
</div>
</div>
<p>The Moran’s I value for the number of foreign tourists is also negative but very close to zero, indicating little spatial autocorrelation. This suggests that the spatial distribution of foreign tourists across provinces is relatively random, with no strong evidence of clustering or dispersion.</p>
</div>
</div>
</div>
<p>Then Moran’s I test will be performed using <code>global_moran_test()</code> to understand deeper with a p-value.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Occupancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Number of Foreign Tourist</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_test</span>(agg_tourism_prov<span class="sc">$</span>revenue_all, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = -1.2705, p-value = 0.898
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
    -2.579891e-02     -1.315789e-02      9.900216e-05 </code></pre>
</div>
</div>
<p>Since the p-value (0.898) is greater than 0.05, we&nbsp;<strong>fail to reject the null hypothesis</strong>.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_test</span>(agg_tourism_prov<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = -1.2199, p-value = 0.8887
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     -0.081092653      -0.013157895       0.003101321 </code></pre>
</div>
</div>
<p>Since the p-value (0.8887) is greater than 0.05, we&nbsp;<strong>fail to reject the null hypothesis</strong>, meaning that it is spatially independent (randomly distributed in space) for occupancy rate as well.</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_test</span>(agg_tourism_prov<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = -0.38197, p-value = 0.6488
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
    -0.0173320551     -0.0131578947      0.0001194228 </code></pre>
</div>
</div>
<p>Since the p-value (0.6488) is greater than 0.05, we&nbsp;<strong>fail to reject the null hypothesis</strong>.</p>
</div>
</div>
</div>
<p>This indicates that there is no significant spatial autocorrelation in all three chosen indicators and the distribution is random.</p>
<p>To confirm this conclusion, we will perform the statistical test with Monte Carlo simulation, using the <code>global_moran_perm()</code> as shown in the code chunk below.</p>
<p>First, we will set the seed at a random number.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Occupancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Number of Foreign Tourists</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(agg_tourism_prov<span class="sc">$</span>revenue_all, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.025799, observed rank = 7, p-value = 0.14
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Since the p-value (0.14) is greater than 0.05, we&nbsp;<strong>fail to reject the null hypothesis</strong>.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(agg_tourism_prov<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.081093, observed rank = 10, p-value = 0.2
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The p-value (0.2) is also greater than 0.05, leading us to&nbsp;<strong>fail to reject the null hypothesis</strong>.</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(agg_tourism_prov<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                       knn, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.017332, observed rank = 36, p-value = 0.72
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The p-value (0.72) is substantially greater than 0.05, resulting in a&nbsp;<strong>failure to reject the null hypothesis</strong>.</p>
</div>
</div>
</div>
<p>For all the indicators, the Monte Carlo simulations reinforce the earlier conclusions, showing no significant spatial autocorrelation. This suggests that for all three variables, there is no significant spatial autocorrelation present, and their distributions appear to be random rather than clustered or dispersed.</p>
<hr>
</section>
</section>
<section id="local-spatial-autocorrelation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis">4.2 Local Spatial Autocorrelation Analysis</h2>
<p><strong>Local Moran’s I</strong>, also known as <strong>Local Indicator of Spatial Association (LISA)</strong>, is a spatial statistical measure used to identify clusters or spatial autocorrelation at a local level (provinces), rather than globally. While Global Moran’s I evaluates the overall spatial autocorrelation across a dataset, Local Moran’s I detects significant pockets of clustering (high-high or low-low) or outliers (high-low or low-high) by evaluating each individual observation and its relationship to neighboring observations. This test helps pinpoint areas where spatial autocorrelation may differ significantly from the global trend.</p>
<ul>
<li><p>N<strong>ull hypothesis (H0)</strong>: there is <strong>no local spatial autocorrelation</strong>, meaning the observed value at each province is independent of the values at neighboring provinces.</p></li>
<li><p><strong>Alternative hypothesis (H1)</strong> is that there is <strong>local spatial autocorrelation</strong>, indicating that similar values are spatially clustered together or dispersed in specific areas.</p></li>
</ul>
<section id="computing-local-morans-i-for-total-revenue" class="level3">
<h3 class="anchored" data-anchor-id="computing-local-morans-i-for-total-revenue">4.2.1 Computing Local Moran’s I for Total Revenue</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Visualize Local Moran’s I and p-value</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>rev_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(agg_tourism_prov<span class="sc">$</span>revenue_all, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                                   knn,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>rev_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rev_local_moranI)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>rev_tourism_lisa <span class="ot">&lt;-</span> agg_tourism_prov <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> rev_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> rev_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> rev_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> rev_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>Local Moran’s I of Revenue: Bangkok exhibit the strongest negative spatial autocorrelation for revenue, suggesting it is the spatial outlier in comparison to its neighbors. The majority of the provinces have values closer to zero, indicating a more neutral or weak spatial correlation for revenue. Chonburi has the strongest positive spatial autocorrelation. This is explained further in <strong><em>section 4.2.4</em></strong>.</p></li>
<li><p>P-value of Local Moran: The p-values of all provinces are not significant for most part of the country except for some central provinces such as Samut Sakhon, Ratchaburi, Phra Nakhon Si Ayutthaya, Samut Songkhram, Nonthaburi and Chonburi. Since their&nbsp;p-value is less than our level of significance at 0.05, we <strong>reject the null hypothesis</strong> for these provinces. This means that there is <strong>local spatial autocorrelation in these provinces</strong>, indicating that similar values of total revenue are spatially clustered together.</p></li>
</ul>
<p>We can also plot the LISA map.</p>
<p>A <strong>LISA map</strong> is a categorical representation highlighting clusters and outliers in spatial data. The map identifies two types of outliers: High-Low, where areas with high values are surrounded by areas with low values, and Low-High, where areas with low values are surrounded by high-value areas. Similarly, it identifies two types of clusters: High-High clusters, where areas with high values are surrounded by other high-value areas, and Low-Low clusters, where low-value areas are surrounded by other low-value areas. The LISA map is derived by combining the local Moran’s I statistic for each geographical area with its corresponding p-values, providing an interpreted spatial pattern of association.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> rev_tourism_lisa  <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_tourism_lisa) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"LISA Map"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.5</span>,  </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.5</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa_sig) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basic,plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Low-Low (Nakhon Sawan, Roi Et, Ubon Ratchathani)</strong>: These provinces are classified as “Low-Low,” meaning that they have low values of revenue, and they are surrounded by neighboring provinces that also exhibit low revenue values. This suggests a localized cluster of low revenue in these regions, where both the province and its neighbors show poor performance in generating tourism-related revenue.</p></li>
<li><p><strong>Low-High (Rayong, Chachoengsao)</strong>: These provinces are classified as “Low-High,” meaning that they have relatively low revenue values but are surrounded by provinces with high revenue. This suggests that Rayong and Chachoengsao may be underperforming relative to their neighboring regions, indicating potential issues or challenges in these specific provinces that result in lower tourism revenue compared to nearby areas.</p></li>
</ul>
</section>
<section id="computing-local-morans-i-for-occupancy-rate" class="level3">
<h3 class="anchored" data-anchor-id="computing-local-morans-i-for-occupancy-rate">4.2.2 Computing Local Moran’s I for Occupancy Rate</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Visualize</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>or_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(agg_tourism_prov<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                   knn, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>or_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(or_local_moranI)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>or_tourism_lisa <span class="ot">&lt;-</span> agg_tourism_prov <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> or_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> or_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> or_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> or_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>Local Moran’s I of Occupancy Rate: Bangkok and Nakhon Ratchasima exhibit the strongest negative spatial autocorrelation for revenue, suggesting they are the spatial outlier in comparison to its neighbors,while the rest of the provinces have values closer to zero. Chiang Rai has the highest positive spatial autocorrelation.</p></li>
<li><p>P-value of Local Moran: The p-values of all provinces are not significant, indicating that <strong>null hypothesis should not be rejected</strong>. For occupancy rate, there is <strong>no local spatial autocorrelation.</strong></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>or_lisa_sig <span class="ot">&lt;-</span> or_tourism_lisa  <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>or_plot4 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(or_tourism_lisa) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"LISA Map"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.5</span>,  </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(or_lisa_sig) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basic,or_plot4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>High-Low (Nakhon Sawan, Nakhon Ratchasima)</strong>: Provinces classified as “High-Low” indicate that these provinces have relatively high occupancy rates, but they are surrounded by provinces with low occupancy rates. This pattern suggests that Nakhon Sawan and Nakhon Ratchasima have stronger hotel occupancy despite being located near provinces where occupancy rates are lower. This could be due to local attractions, tourism infrastructure, or other factors that make these provinces more appealing to tourists, even though neighboring regions are less successful in attracting or accommodating tourists.</p>
</section>
<section id="computing-local-morans-i-for-number-of-foreign-tourists" class="level3">
<h3 class="anchored" data-anchor-id="computing-local-morans-i-for-number-of-foreign-tourists">4.2.3 Computing Local Moran’s I for Number of Foreign Tourists</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Visualize</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ft_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(agg_tourism_prov<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                   knn, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>ft_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ft_local_moranI)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>ft_tourism_lisa <span class="ot">&lt;-</span> agg_tourism_prov <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> ft_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> ft_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> ft_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> ft_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>Local Moran’s I of Occupancy Rate: Similarly as occupancy rate, Bangkok and Nakhon Ratchasima exhibit the strongest negative spatial autocorrelation for revenue, suggesting they are the spatial outlier in comparison to its neighbors. Again, Chiang Rai has the highest positive spatial autocorrelation. The rest of the provinces have values closer to zero.</p></li>
<li><p>P-value of Local Moran: The p-values of all provinces are not significant, indicating that <strong>null hypothesis should not be rejected</strong>. For number of foreign tourist, there is <strong>no local spatial autocorrelation.</strong></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ft_lisa_sig <span class="ot">&lt;-</span> ft_tourism_lisa  <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii_sim <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>ft_plot3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(ft_tourism_lisa) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"LISA Map"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.5</span>,  </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text.size =</span> <span class="fl">0.5</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ft_lisa_sig) <span class="sc">+</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>) <span class="sc">+</span> </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(basic,ft_plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>High-Low (Nakhon Sawan, Nakhon Ratchasima)</strong>: Same as occupancy rate, this classification indicates that Nakhon Sawan and Nakhon&nbsp;Ratchasima have a high number of foreign tourists relative to its neighboring provinces, which have a lower number of foreign tourists. This could imply that these regioins has a unique attraction or infrastructure that draws foreign tourists, while its neighbors are not as successful in attracting international visitors. This is notable because these two provinces stands out in the region despite a general lack of foreign tourist inflow in nearby provinces.</p>
</section>
<section id="interpretation-of-strongest-negative-positive-morans-i-statistics" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-of-strongest-negative-positive-morans-i-statistics">4.2.4 Interpretation of Strongest Negative &amp; Positive Moran’s I Statistics</h3>
<p><u><strong>Bangkok- Highest Negative For All Indicators</strong></u></p>
<p>Bangkok has the&nbsp;most negative Local Moran’s I statistic consistently for all three tourism economy indicators&nbsp;suggesting that, despite its high tourism revenue, the spatial pattern of tourism revenue in Bangkok is more&nbsp;out of sync&nbsp;with its neighboring provinces. This could happen for the following reasons:</p>
<ol type="1">
<li><p><strong>High Concentration of Tourism Activity</strong>: Bangkok’s tourism revenue may be extremely concentrated within a few key areas, while surrounding provinces generate much less revenue. This creates a situation where Bangkok stands out significantly compared to its neighbors, resulting in a negative Local Moran’s I.</p></li>
<li><p><strong>Uneven Distribution of Tourism</strong>: While Bangkok itself is a tourism hotspot, the neighboring provinces may not benefit equally from the tourism flow, leading to spatial dispersion. This contrast in tourism revenue between Bangkok and its neighbors drives the negative spatial autocorrelation.</p></li>
</ol>
<p><u><strong>Chonburi - Highest Positive Moran’s I for Revenue</strong></u></p>
<ol type="1">
<li><p><strong>Tourism and Economic Hub</strong>: Chonburi’s high positive Moran’s I for revenue means that Chonburi, along with its neighboring provinces, is part of a cluster where tourism revenue is consistently high. Chonburi’s strong attractions like&nbsp;Pattaya&nbsp;and its proximity to Bangkok draw significant tourist spending.</p></li>
<li><p><strong>Coastal Appeal</strong>: Chonburi is a popular destination for both international and domestic tourists, particularly for its beach resorts and recreational activities. This translates into higher spending on hotels, restaurants, and entertainment, contributing to its high tourism revenue (Tourism Authority of Thailand).</p></li>
</ol>
<p><u><strong>Chiang Rai - Highest Positive Moran’s I for Occupancy Rate and Number of Foreign Tourists</strong></u></p>
<ol type="1">
<li><p><strong>Niche International Appeal</strong>:&nbsp;Chiang Rai, located in northern Thailand, is less commercially developed compared to Chonburi but has a strong appeal to foreign tourists interested in cultural experiences, eco-tourism, and the scenic landscapes of the Golden Triangle (Betgem, n.d.). This could explain its high positive Moran’s I for the&nbsp;number of foreign tourists. Chiang Rai is often visited by tourists seeking a more tranquil and unique experience compared to the coastal resorts.</p></li>
<li><p><strong>High Occupancy Rate</strong>: The high Moran’s I for&nbsp;occupancy rate&nbsp;suggests that&nbsp;hotels in Chiang Rai are consistently full&nbsp;compared to surrounding provinces. This could be because Chiang Rai has a more limited supply of accommodations relative to demand, especially during peak travel seasons when foreign tourists flock to the area for cultural and nature-based tourism.</p></li>
</ol>
<hr>
</section>
</section>
</section>
<section id="independence-of-thailands-tourism-economy-indicators-from-space-and-time-a-pre-during-and-post-covid-analysis" class="level1">
<h1>5 Independence of Thailand’s Tourism Economy Indicators from Space and Time : A Pre, During, and Post-COVID Analysis</h1>
<p>The tourism economy of Thailand has undergone significant transformations across various temporal phases, particularly pre, during, and post-COVID-19. Before the pandemic, Thailand’s tourism industry flourished, characterized by robust growth and geographical concentration in aforementioned key areas. However, the onset of COVID-19 brought disruptions, leading to a drastic decline in both domestic and international travel, which raised questions about the space and time dependencies of tourism-related indicators. As the world transitions into a post-pandemic phase, the focus shifts towards understanding whether the key indicators of Thailand’s tourism economy, such as foreign visitor numbers, revenue, and the rate of occupancy, are influenced by spatial dimensions and time variables, or if they exhibit independence from these factors. Now that we have uncovered independence of Thailand’s tourism economy with space, this analysis aims to uncover its intricate relationship in both space and time context.</p>
<section id="splitting-the-data-defining-the-temporal-terms" class="level2">
<h2 class="anchored" data-anchor-id="splitting-the-data-defining-the-temporal-terms">5.1 Splitting the Data : Defining the Temporal Terms</h2>
<p>Since our analysis is focused on impact of COVID-19 to the tourism industry in Thailand, we will split the dataset to different temporal terms: pre, during and post COVID-19 to understand the impacts of the pandemic. We determine the splitting points from the viewing the histogram below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the histogram, we noted that there are three temporal terms:</p>
<ul>
<li><p>Pre Covid: <strong>Before Jan 2020</strong> (i.e.&nbsp;Dec 2019 and earlier) aligned with announcement about first few covid cases from Thailand’s Ministry of Public Health (Cheung, 2020)</p></li>
<li><p>During Covid: <strong>Jan 2020 - Sep 2021</strong></p></li>
<li><p>Post Covid: <strong>After Sep 2021</strong></p></li>
</ul>
<p>Therefore,we will be our splitting our thai_tourism dataframe into these three cross sectional terms to conduct our analysis acrocss.</p>
<section id="k-nearest-neighbors-knn-on-temporal-terms" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors-knn-on-temporal-terms">5.1.1 K-nearest neighbors (KNN) on Temporal Terms</h3>
<p>We will now compute the weight matrix for each temporal term with the following steps:</p>
<ol type="1">
<li>First, to find centroids, we will aggregate the data; now for both space and time.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>agg_tourism_provtime <span class="ot">&lt;-</span> thai_tourism <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng, date_int) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_tourist_foreign =</span> <span class="fu">sum</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>We will split the aggregated data for each temporal term.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>pre_covid <span class="ot">&lt;-</span> <span class="fu">filter</span>(agg_tourism_provtime, date_int <span class="sc">&lt;</span> <span class="st">"202001"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>during_covid <span class="ot">&lt;-</span> <span class="fu">filter</span>(agg_tourism_provtime, date_int <span class="sc">&gt;=</span> <span class="st">"202001"</span> <span class="sc">&amp;</span> date_int <span class="sc">&lt;</span> <span class="st">"202109"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>post_covid <span class="ot">&lt;-</span> <span class="fu">filter</span>(agg_tourism_provtime, date_int <span class="sc">&gt;=</span> <span class="st">"202109"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Then we can now compute centroids and KNN for each of the temporal terms subsets using the code chunk below.</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>We will aggregate the data to find the unique centroids for each temporal term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>pre_covid_agg <span class="ot">&lt;-</span> pre_covid <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_tourist_foreign =</span> <span class="fu">sum</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>pre_covid_centroids <span class="ot">&lt;-</span> pre_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, geometry)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>coords_pre_covid <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(pre_covid_centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then compute 6th nearest neighbour distance using KNN approach.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>knn_pre_covid <span class="ot">&lt;-</span> <span class="fu">st_knn</span>(pre_covid_centroids, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>knn_weights_pre_covid <span class="ot">&lt;-</span> <span class="fu">st_weights</span>(knn_pre_covid, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check whether centroids are appropriate and not in the water, we will visualize them. tmap_mode(‘view’) was used to check carefully but for the purpose of publishing it will now be set as ‘plot’</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaibounds) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span>  </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(pre_covid_centroids) <span class="sc">+</span>  </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">title =</span> <span class="st">"Province Centroids"</span>) <span class="sc">+</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">just =</span> <span class="st">"top"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Province Centroids of Thai Tourism"</span>, <span class="at">main.title.size =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>during_covid_agg <span class="ot">&lt;-</span> during_covid <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_tourist_foreign =</span> <span class="fu">sum</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>during_covid_centroids <span class="ot">&lt;-</span> during_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, geometry)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>coords_during_covid <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(during_covid_centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>knn_during_covid <span class="ot">&lt;-</span> <span class="fu">st_knn</span>(during_covid_centroids, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>knn_weights_during_covid <span class="ot">&lt;-</span> <span class="fu">st_weights</span>(knn_during_covid, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaibounds) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span>  </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(during_covid_centroids) <span class="sc">+</span>  </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">title =</span> <span class="st">"Province Centroids"</span>) <span class="sc">+</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">just =</span> <span class="st">"top"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Province Centroids of Thai Tourism"</span>, <span class="at">main.title.size =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>post_covid_agg <span class="ot">&lt;-</span> post_covid <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">revenue_all =</span> <span class="fu">sum</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">no_tourist_foreign =</span> <span class="fu">sum</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geometry =</span> <span class="fu">st_union</span>(geometry)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>post_covid_centroids <span class="ot">&lt;-</span> post_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, geometry)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>coords_post_covid <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(post_covid_centroids)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>knn_post_covid <span class="ot">&lt;-</span> <span class="fu">st_knn</span>(post_covid_centroids, <span class="at">k =</span> <span class="dv">6</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>knn_weights_post_covid <span class="ot">&lt;-</span> <span class="fu">st_weights</span>(knn_post_covid, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thaibounds) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"lightgrey"</span>) <span class="sc">+</span>  </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(post_covid_centroids) <span class="sc">+</span>  </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">title =</span> <span class="st">"Province Centroids"</span>) <span class="sc">+</span> </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"province_eng"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">just =</span> <span class="st">"top"</span>, <span class="at">col =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Province Centroids of Thai Tourism"</span>, <span class="at">main.title.size =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="total-revenue-1" class="level2">
<h2 class="anchored" data-anchor-id="total-revenue-1">5.2 Total Revenue</h2>
<section id="global-spatial-autocorrelation-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis-1">5.2.1 Global Spatial Autocorrelation Analysis</h3>
<p>We will perform <strong><em>global_moran_perm()</em></strong> test on each of our three temporal terms with 100 Monte Carlo simulations using the code chunks below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(pre_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                       knn_pre_covid, </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_pre_covid,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.024998, observed rank = 11, p-value = 0.22
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The slightly negative Moran’s I statistic suggests weak spatial dispersion in tourism revenue, though the magnitude is very close to zero, indicating an almost random distribution.The p-value of 0.22 suggests that we <strong>fail to reject the null hypothesis</strong> of spatial independence, meaning that the revenue distribution during the pre-COVID period does not show significant spatial autocorrelation.</p>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(during_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                       knn_during_covid, </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_during_covid,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.030922, observed rank = 4, p-value = 0.08
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Similar to pre-COVID, this negative value suggests weak spatial dispersion, but again, the magnitude is very close to zero, indicating an almost random distribution. The p-value of 0.08, again, suggests that we <strong>fail to reject the null hypothesis</strong> of spatial independence.</p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(post_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                       knn_post_covid, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_post_covid,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.0259, observed rank = 15, p-value = 0.3
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The results are comparable to those of the pre-COVID period, with a negative Moran’s I statistic indicating spatial dispersion. With the p-value of 0.3, we <strong>fail to reject the null hypothesis</strong> of spatial independence. This is very similar to the pre-COVID period, with a near-random distribution. The p-value is higher, suggesting even weaker evidence of spatial autocorrelation.</p>
</div>
</div>
</div>
<p>Across all three periods, the consistent negative values of the Moran’s I statistic indicate a trend towards spatial dispersion rather than clustering. The p-values in the all three periods remain above the common significance level (0.05), indicating a lack of evidence to reject the null hypothesis of spatial independence.</p>
<p>Overall, these findings support the conclusion that the revenue variable exhibits independence from space across the specified time periods.</p>
</section>
<section id="local-spatial-autocorrelation-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis-1">5.2.2 Local Spatial Autocorrelation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>rev_pre_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(pre_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                                   knn_pre_covid, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_pre_covid,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>rev_pre_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rev_pre_local_moranI)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>rev_pre_tourism_lisa <span class="ot">&lt;-</span> pre_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> rev_pre_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> rev_pre_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> rev_pre_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> rev_pre_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><strong>Bangkok</strong> shows the strongest negative spatial autocorrelation for revenue, identifying it as a spatial outlier compared to its neighboring provinces. This suggests that the revenue generated from tourism in Bangkok is significantly different from adjacent areas.</li>
</ul>
<p><strong>P-value</strong>:</p>
<ul>
<li>Most provinces across the country do not show significant spatial autocorrelation. However, several central provinces, such as Samut Prakan, Samut Sakhon, Ratchaburi, Phra Nakhon Si Ayutthaya, Samut Songkhram, Nonthaburi, and Chonburi, have p-values less than 0.05. For these provinces, we reject the null hypothesis, indicating significant local spatial autocorrelation and suggesting that tourism revenue values are spatially clustered in these areas.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><p><strong>Low-High (Chachoengsao, Nakhon Nayok, Nakhon Pathom, Nonthaburi, Pathum Thani, Phra Nakhon Si Ayutthaya, Ratchaburi, Rayong, Samut Prakan, Samut Sakhon, Samut Songkhram)</strong>: These provinces are classified as “Low-High,” indicating that their revenue values are low compared to neighboring provinces, which show high revenue. This suggests that while their surrounding areas thrive economically in terms of tourism revenue, these provinces might face specific challenges or structural issues preventing them from benefiting equally from tourism.</p></li>
<li><p><strong>High-High (Chonburi)</strong>: Chonburi is categorized as “High-High,” indicating a cluster of high tourism revenue, both within the province and its neighboring regions. This suggests that Chonburi is a significant tourism hub, not only performing well itself but also likely contributing to the economic strength of surrounding areas.</p></li>
</ul>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>rev_during_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(during_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                                   knn_during_covid, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_during_covid, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>rev_during_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(rev_during_local_moranI)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>rev_during_tourism_lisa <span class="ot">&lt;-</span> during_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> rev_during_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> rev_during_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> rev_during_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> rev_during_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li>Similar to pre-COVID, Bangkok continues to exhibit the strongest negative spatial autocorrelation, indicating it remains a spatial outlier in terms of tourism revenue. Additionally, some provinces experienced no tourist visits during the pandemic, leading to missing values for those regions.</li>
<li>Chonburi consistenly has the strongest positive spatial autocorrelation indicating revenue is highly clustered&nbsp;spatially. This means that provinces&nbsp;near Chonburi&nbsp;also tend to have similar high values of tourism revenue. In other words, Chonburi’s neighboring provinces are also performing similarly well in terms of tourism revenue.</li>
</ul>
<p><strong>P-value</strong>:</p>
<ul>
<li>The p-values remain consistent with pre-COVID results, with significant local spatial autocorrelation in the central provinces mentioned earlier (Samut Prakan, Samut Sakhon, Ratchaburi, Phra Nakhon Si Ayutthaya, Samut Songkhram, Nonthaburi, and Chonburi). For these provinces, we still reject the null hypothesis, meaning that revenue values remain spatially clustered.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><p>The pattern of&nbsp;<strong>Low-High</strong>&nbsp;clusters remains unchanged from the pre-COVID period, with the same provinces (Chachoengsao, Nakhon Nayok, etc.) showing low revenue while surrounded by high-revenue provinces. This continuity may suggest that the COVID-19 pandemic did not drastically change the spatial relationships in revenue across these provinces. The persistence of these clusters indicates that economic disparities in tourism remained stable during the pandemic.</p></li>
<li><p><strong>High-High (Chonburi)</strong>: Like the pre-COVID period, Chonburi maintains its “High-High” status, continuing to be a central hub of tourism activity and revenue, even during the pandemic. This suggests resilience in Chonburi’s tourism sector despite the significant disruptions caused by COVID-19.</p></li>
</ul>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>post_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(post_covid_agg<span class="sc">$</span>revenue_all, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                   knn_post_covid, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_post_covid, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>post_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(post_local_moranI)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>post_tourism_lisa <span class="ot">&lt;-</span> post_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> post_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> post_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> post_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> post_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li>Bangkok continues to exhibit the strongest negative spatial autocorrelation for revenue, suggesting it remains a spatial outlier compared to its neighboring regions.</li>
<li>Chonburi continues to exhibit strongest positive spatial autocorrelation.</li>
</ul>
<p><strong>P-value</strong>:</p>
<ul>
<li>The post-COVID period shows the same trend as pre- and during-COVID. Significant spatial autocorrelation is observed in the central provinces of Samut Prakan, Samut Sakhon, Ratchaburi, Phra Nakhon Si Ayutthaya, Samut Songkhram, Nonthaburi, and Chonburi, where p-values are below the 0.05 threshold. This indicates that these provinces still exhibit spatial clustering in tourism revenue.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><p>The&nbsp;<strong>Low-High</strong>&nbsp;clusters again mirror the previous periods, indicating a prolonged trend of low revenue in these provinces relative to their high-performing neighbors. This suggests that the provinces in this category did not recover or gain the same momentum in tourism revenue as their surrounding regions, even after the pandemic.</p></li>
<li><p><strong>High-High (Chonburi)</strong>: Chonburi continues to be a strong performer in the post-COVID period, indicating sustained high tourism revenue both in the province and its neighbors. This demonstrates the region’s ability to attract tourists and maintain its position as a key tourism destination in Thailand, despite the disruptions from COVID-19.</p></li>
</ul>
</div>
</div>
</div>
<p>Across all three periods—pre, during, and post-COVID—the LISA maps reveal a consistent pattern in the spatial autocorrelation of tourism revenue. The&nbsp;<strong>Low-High</strong>&nbsp;provinces (e.g., Chachoengsao, Nakhon Nayok, and Rayong) show persistent economic underperformance in tourism revenue despite being located near high-revenue provinces. This pattern highlights ongoing economic disparities in tourism performance across these regions. Meanwhile,&nbsp;<strong>Chonburi</strong> maintains its status as a&nbsp;<strong>High-High</strong>&nbsp;cluster, resilient even during the pandemic. The consistent LISA patterns suggest that while COVID-19 may have impacted overall tourism activity, the spatial dynamics of tourism revenue remained stable, with the same provinces continuing to underperform or thrive relative to their neighbors.</p>
</section>
</section>
<section id="occupancy-rate-3" class="level2">
<h2 class="anchored" data-anchor-id="occupancy-rate-3">5.3 Occupancy Rate</h2>
<section id="global-spatial-autocorrelation-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis-2">5.3.1 Global Spatial Autocorrelation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(pre_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                       knn_pre_covid, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_pre_covid,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.16557, observed rank = 99, p-value = 0.02
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The negative Moran’s I statistic indicates a tendency toward spatial dispersion of the&nbsp;<code>ratio_tourist_stay</code>&nbsp;values rather than clustering. The p-value of 0.02 is less than the significance level (0.05), suggesting that we <strong>reject the null hypothesis</strong> of spatial independence.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(during_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                       knn_during_covid, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_during_covid,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.24708, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The negative value of the Moran’s I statistic once again suggests spatial dispersion. The exceptionally low p-value indicates that there is <strong>strong evidence</strong> to suggest spatial dependence in the data during the COVID period. The very low p-value suggests that the spatial distribution of occupancy rates is not random. Instead, there is a significant pattern in how occupancy rates are distributed across the provinces.</p>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(post_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                       knn_post_covid, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_post_covid,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.21328, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Similar to the previous periods, the negative Moran’s I statistic indicates spatial dispersion. The very low p-value also suggests that <strong>we will reject the null hypothesis</strong> of spatial independence. This indicates that the occupancy rates exhibit significant spatial clustering,</p>
</div>
</div>
</div>
<p>Across all three periods, the consistently negative values of the Moran’s I statistic for&nbsp;<code>ratio_tourist_stay</code>&nbsp;imply a trend toward spatial dispersion, rather than clustering. The p-values in the pre-COVID, during COVID, and post-COVID periods all are less the standard significance level (0.05), indicating a evidence to reject the null hypothesis of spatial independence.</p>
<p>The ratio of tourist occupancy rate is dependent on space throughout the specified time periods, showing significant spatial autocorrelation that provinces with high occupancy rates are clustered together.</p>
</section>
<section id="local-spatial-autocorrelation-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis-2">5.3.2 Local Spatial Autocorrelation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>or_pre_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(pre_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                                   knn_pre_covid, </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_pre_covid, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>or_pre_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(or_pre_local_moranI)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>or_pre_tourism_lisa <span class="ot">&lt;-</span> pre_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> or_pre_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> or_pre_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> or_pre_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> or_pre_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><strong>Chiang Mai</strong>&nbsp;shows the strongest negative spatial autocorrelation for occupancy rate, indicating it is a spatial outlier compared to its neighboring provinces.</li>
</ul>
<p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li>The p-values for all provinces are not significant, except for&nbsp;<strong>Tak, Rayong, Samut Prakan, Chiang Mai, Ratchaburi, Nakhon Si Thammarat, Pathum Thani, and Kalasin</strong>. With a p-value below 0.05, we reject the null hypothesis for these regions, confirming the presence of local spatial autocorrelation. This indicates that similar occupancy rate values are spatially clustered in these regions and its neighboring areas.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><strong>Low-low(Kalasin):</strong> Kalasin exhibits low occupancy rates and is surrounded by other provinces with similarly low rates. This indicates a region that may be facing challenges in attracting tourists, suggesting a potential need for development strategies or marketing efforts to enhance its appeal and occupancy rates.</li>
<li><strong>High-low(Chiang Mai, Tak</strong>): Both Chiang Mai and Tak have high occupancy rates but are surrounded by provinces with low occupancy rates. This suggests that these provinces are successful in attracting tourists independently, but their high occupancy does not influence the neighboring low-occupancy areas. It highlights opportunities for further regional tourism development to connect these successful areas with their less successful neighbors.</li>
<li><strong>Low-High (Chachoengsao, Nakhon Si Thammarat, Pathum Thani, Ratchaburi)</strong>: These provinces have low occupancy rates while being surrounded by high occupancy provinces. This situation suggests that they are potentially missing out on tourism opportunities that their successful neighbors enjoy. There may be opportunities for tourism development, promotion, or infrastructure improvement to increase their occupancy rates and tap into the benefits of their geographic location.</li>
<li><strong>High-High (Rayong, Samut Prakan)</strong>: Rayong and Samut Prakan have high occupancy rates and are surrounded by other provinces with high occupancy rates. This indicates a strong tourism environment.</li>
</ul>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>or_during_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(during_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>                                   knn_during_covid, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_during_covid, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>or_during_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(or_during_local_moranI)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>or_during_tourism_lisa <span class="ot">&lt;-</span> during_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> or_during_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> or_during_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> or_during_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> or_during_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><strong>Nakhon&nbsp;Si&nbsp;Thammarat</strong>&nbsp;exhibit the strongest negative spatial autocorrelation for occupancy rates, indicating that this provinces is a spatial outlier compared to their neighbors.</li>
</ul>
<p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li>The p-values are significant for some souther provinces, such as&nbsp;<strong>Phang Nga</strong>&nbsp;and&nbsp;<strong>Surat Thani</strong>. With p-values below 0.05, we reject the null hypothesis for these provinces, indicating the presence of local spatial autocorrelation. This suggests that they experienced spatial clustering of occupancy rates, likely forming a high-rate cluster with surrounding provinces.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><strong>Low-Low (Bangkok, Nonthaburi, Phang Nga, Ranong, Samut Prakan, Surat Thani):</strong>The provinces in the Low-Low category, including major urban centers like Bangkok and Nonthaburi, experienced low occupancy rates during COVID. This situation suggests that even populous and popular areas struggled to attract tourists during the pandemic. Factors such as travel restrictions, health concerns, and changes in tourist behavior may have significantly impacted their occupancy levels.</li>
</ul>
<!-- -->
<ul>
<li><p><strong>High-Low(Nakhon Si Thammarat)</strong>: Nakhon Si Thammarat, while having a high occupancy rate, is surrounded by provinces with low occupancy. This suggests that it successfully attracted tourists independently during COVID, potentially due to its local attractions or outdoor tourism opportunities that aligned with pandemic travel preferences. However, the isolation from neighboring low-occupancy provinces indicates that these benefits are not being shared or are not affecting the surrounding areas, meaning there is a potential for developing stronger regional tourism networks.</p></li>
<li><p><strong>Low-High( Mae Hong Son)</strong>: Mae Hong Son is characterized by low occupancy rates but is surrounded by high-occupancy provinces. This indicates a missed opportunity for Mae Hong Son, as it could leverage the tourism successes of its neighbors. The province may need to enhance its visibility and attractiveness to tourists or develop infrastructure to connect better with high-occupancy areas.</p></li>
<li><p><strong>High-High (Chiang Rai, Lamphun, Phayao, Phrae, Uttaradit):</strong> The provinces in the High-High category experienced high occupancy rates and are surrounded by other high-occupancy provinces. This suggests that these areas formed a robust tourism network. Their success during the pandemic may provide a foundation for future growth, and strategies could be developed to sustain and further enhance tourism in these interconnected areas.</p></li>
</ul>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>or_post_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(post_covid_agg<span class="sc">$</span>ratio_tourist_stay, </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>                                   knn_post_covid, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_post_covid, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>or_post_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(or_post_local_moranI)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>or_post_tourism_lisa <span class="ot">&lt;-</span> post_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> or_post_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> or_post_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> or_post_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> or_post_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><p><strong>There is no strongly negative Moran’s I values</strong>.</p></li>
<li><p>However, Chiang Rai has a strong positive Moran’s I value indicating the neigboring provinces might also have high values of occupancy rates.</p></li>
</ul>
<p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li>The p-values are not significant for most provinces, except for northern provinces like &nbsp;<strong>Chiang Mai</strong>. We reject the null hypothesis for these provinces as their p-values are below 0.05. This confirms local spatial autocorrelation, indicating spatial clustering of similar occupancy rates in these provinces and their surrounding areas.</li>
</ul>
<p><strong>LISA Map:</strong></p>
<ul>
<li><strong>High-High (Chiang Mai, Chiang Rai, Mae Hong Son, Nan, Phayao)</strong>: The provinces in the High-High category experienced high occupancy rates and are characterized by strong tourism performance. This suggests that these areas successfully attracted tourists post-COVID. Their status as high-occupancy provinces indicates a robust recovery and possibly a growing appeal as safe travel destinations.</li>
</ul>
</div>
</div>
</div>
<p>The analysis of occupancy rates across provinces during pre-COVID, during COVID, and post-COVID periods reveals significant trends in tourism dynamics. Pre-COVID, occupancy rates in various provinces were generally robust, driven by strong domestic and international tourism. During COVID, a new pattern emerged, with provinces like Bangkok and Nonthaburi experiencing low occupancy rates due to travel restrictions, while Nakhon Si Thammarat demonstrated a unique resilience with higher occupancy despite neighboring low rates. In the post-COVID landscape, provinces such as Chiang Mai, Chiang Rai, Mae Hong Son, Nan, and Phayao emerged as high performers with strong occupancy rates, likely benefiting from effective recovery strategies.</p>
</section>
</section>
<section id="number-of-foreign-tourists-2" class="level2">
<h2 class="anchored" data-anchor-id="number-of-foreign-tourists-2">5.4 Number of Foreign Tourists</h2>
<section id="global-spatial-autocorrelation-analysis-3" class="level3">
<h3 class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis-3">5.4.1 Global Spatial Autocorrelation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(pre_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                       knn_pre_covid, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_pre_covid,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.014812, observed rank = 50, p-value = 1
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The negative Moran’s I statistic indicates a tendency toward spatial dispersion of the number of foreign tourists, suggesting that areas with a high number of foreign tourists are not clustered together. The p-value of 1 is greater than the level of signifcants, therefore <strong>we fail to reject</strong> <strong>null hypothesis</strong> of spatial independence.</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(during_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                       knn_during_covid, </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_during_covid,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.018951, observed rank = 26, p-value = 0.52
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Again, the negative value of the Moran’s I statistic suggests spatial dispersion. The p-value of 0.52 indicates that we also <strong>fail to reject the null hypothesis</strong> during the COVID period.</p>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(post_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                       knn_post_covid, </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                       knn_weights_post_covid,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.022147, observed rank = 18, p-value = 0.36
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>The negative Moran’s I statistic indicates spatial dispersion, consistent with previous findings. The p-value of 0.36 is also significantly higher than the conventional significance level, leading us to <strong>fail to reject the null hypothesis</strong> of spatial independence.</p>
</div>
</div>
</div>
<p>Across all three periods, the consistently negative values of the Moran’s I statistic for&nbsp;<code>no_tourist_foreign</code>&nbsp;indicate a trend toward spatial dispersion rather than clustering. The p-values across all peroids all exceed the standard significance level (0.05), indicating a lack of evidence to reject the null hypothesis of spatial independence.</p>
<p>The number of foreign tourists is independent from space throughout the specified time periods, showing no significant spatial autocorrelation.</p>
</section>
<section id="local-spatial-autocorrelation-analysis-3" class="level3">
<h3 class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis-3">5.4.2 Local Spatial Autocorrelation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">Pre Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">During Covid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">Post Covid</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>ft_pre_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(pre_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                                   knn_pre_covid, </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_pre_covid, </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>ft_pre_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ft_pre_local_moranI)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>ft_pre_tourism_lisa <span class="ot">&lt;-</span> pre_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> ft_pre_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> ft_pre_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> ft_pre_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> ft_pre_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><p><strong>Bangkok</strong> shows the strongest negative spatial autocorrelation.</p></li>
<li><p><strong>Chonburi</strong> has the strongest positive spatial autocorrelation, indicating that Chonburi and its neighboring provinces might be a popular foreign tourist destination.</p></li>
</ul></li>
<li><p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li><p>The p-values for all provinces except&nbsp;<strong>Nonthaburi</strong>,&nbsp;<strong>Nakhon Nayok</strong>,&nbsp;<strong>Samut Sakhon</strong>,&nbsp;<strong>Chachoengsao</strong>,&nbsp;<strong>Chonburi</strong>,&nbsp;<strong>Rayong</strong>,&nbsp;<strong>Nakhon Pathom</strong>,&nbsp;<strong>Samut Prakan</strong>,&nbsp;<strong>Pathum Thani</strong>,&nbsp;<strong>Phra Nakhon Si Ayutthaya</strong>,&nbsp;<strong>Ratchaburi</strong>, and&nbsp;<strong>Samut Songkhram</strong>&nbsp;are not significant.</p></li>
<li><p>For these 12 provinces, we reject the null hypothesis at the 0.05 significance level, indicating the presence of local spatial autocorrelation. This means that these provinces exhibit significant patterns in foreign tourist numbers, either clustering with similar values or differing significantly from their neighbors.</p></li>
</ul></li>
<li><p><strong>LISA Map</strong>:</p>
<ul>
<li><p><strong>Low-High</strong> clusters are seen in several provinces, including <strong>Nonthaburi</strong>, <strong>Nakhon Nayok</strong>, <strong>Samut Sakhon</strong>, <strong>Chachoengsao</strong>, <strong>Rayong</strong>, and others. This suggests that these provinces experienced lower numbers of foreign tourists compared to their neighbors, possibly due to less developed tourism infrastructure or less attraction to foreign tourists.</p></li>
<li><p><strong>High-High</strong>&nbsp;clusters are observed in&nbsp;<strong>Chonburi</strong>&nbsp;and&nbsp;<strong>Phra Nakhon Si Ayutthaya</strong>, indicating that these provinces had significantly higher foreign tourist numbers, likely due to their established reputation as major tourist destinations.</p></li>
</ul></li>
</ul>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>ft_during_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(during_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                                   knn_during_covid, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_during_covid, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>ft_during_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ft_during_local_moranI)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>ft_during_tourism_lisa <span class="ot">&lt;-</span> during_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> ft_during_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> ft_during_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> ft_during_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> ft_during_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><p>Similar to the pre-COVID period,&nbsp;<strong>Bangkok</strong>&nbsp;exhibits the strongest negative spatial autocorrelation.</p></li>
<li><p><strong>Chonburi</strong>&nbsp;continues to show the strongest positive spatial autocorrelation, implying it maintained higher foreign tourist numbers than surrounding provinces, even during the pandemic.</p></li>
</ul></li>
<li><p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li>The significance patterns remain the same, with only the 12 provinces mentioned above showing significant p-values. This suggests that local spatial autocorrelation persists in these areas during the pandemic, indicating that their patterns of foreign tourist distribution remained consistent.</li>
</ul></li>
<li><p><strong>LISA Map</strong>:</p>
<ul>
<li><p>Many of the same&nbsp;<strong>Low-High</strong>&nbsp;clusters are still present, such as in&nbsp;<strong>Samut Prakan</strong>,&nbsp;<strong>Samut Songkhram</strong>,&nbsp;<strong>Chachoengsao</strong>,&nbsp;<strong>Nakhon Pathom</strong>, and others. This suggests that the pandemic did not change the relative distribution of foreign tourists in these areas—they remained low compared to their neighbors.</p></li>
<li><p><strong>High-High</strong>&nbsp;cluster persists in&nbsp;<strong>Chonburi</strong> and <strong>Phra&nbsp;Nakhon&nbsp;Si&nbsp;Ayutthaya</strong>, which likely maintained relatively higher foreign tourist numbers during the pandemic due to its international connections, despite overall global declines in tourism.</p></li>
</ul></li>
</ul>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>ft_post_local_moranI <span class="ot">&lt;-</span> <span class="fu">local_moran</span>(post_covid_agg<span class="sc">$</span>no_tourist_foreign, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                                   knn_post_covid, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                                   knn_weights_post_covid, </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>ft_post_lisa_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ft_post_local_moranI)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>ft_post_tourism_lisa <span class="ot">&lt;-</span> post_covid_agg <span class="sc">%&gt;%</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ii =</span> ft_post_lisa_df<span class="sc">$</span>ii, </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii_sim =</span> ft_post_lisa_df<span class="sc">$</span>p_ii_sim,</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_ii =</span> ft_post_lisa_df<span class="sc">$</span>p_ii,</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> ft_post_lisa_df<span class="sc">$</span>mean,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Local Moran’s I</strong>:</p>
<ul>
<li><p>Once again,&nbsp;<strong>Bangkok</strong>&nbsp;exhibits the strongest negative spatial autocorrelation.</p></li>
<li><p><strong>Chonburi</strong>&nbsp;retains the strongest positive spatial autocorrelation, suggesting that even after the pandemic, it has recovered and continues to attract more foreign tourists than neighboring provinces.</p></li>
</ul></li>
<li><p><strong>P-value of Local Moran</strong>:</p>
<ul>
<li>Similar to pre- and during-COVID results, only the same 12 provinces have significant p-values. The persistence of this pattern post-COVID indicates that these areas exhibit consistent spatial patterns in foreign tourist numbers, either clustering or diverging from neighboring provinces</li>
</ul></li>
<li><p><strong>LISA Map</strong>:</p>
<ul>
<li><p><strong>Low-High</strong>&nbsp;clusters remain in many of the same provinces as pre- and during-COVID periods, including&nbsp;<strong>Pathum Thani</strong>,&nbsp;<strong>Ratchaburi</strong>,&nbsp;<strong>Chachoengsao</strong>,&nbsp;<strong>Samut Prakan</strong>, and&nbsp;<strong>Nakhon Nayok</strong>, indicating continued challenges in attracting foreign tourists in these provinces relative to their neighbors.</p></li>
<li><p><strong>High-High</strong>&nbsp;cluster in&nbsp;<strong>Chonburi</strong>&nbsp;remains post-COVID, showing resilience in recovering foreign tourism after the pandemic, likely due to strong international appeal.</p></li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>Throughout the pre, during, and post-COVID periods, we observe a consistent pattern where&nbsp;Chonburi&nbsp;stands out as a&nbsp;High-High&nbsp;cluster, attracting large numbers of foreign tourists. In contrast, provinces such as&nbsp;Nonthaburi,&nbsp;Samut Prakan,&nbsp;Nakhon Nayok, and&nbsp;Chachoengsao&nbsp;consistently form&nbsp;Low-High&nbsp;clusters, indicating that foreign tourism in these areas has lagged behind their neighbors. The pandemic had a limited impact on shifting these clusters, though foreign tourist numbers likely decreased across the board.</p>
</section>
</section>
<section id="overall-results-and-policy-suggestions-from-space-time-analysis" class="level2">
<h2 class="anchored" data-anchor-id="overall-results-and-policy-suggestions-from-space-time-analysis">5.5 Overall Results and Policy Suggestions from Space &amp; Time Analysis</h2>
<p>The three variables—revenue, occupancy rate, and number of foreign tourists—show consistent patterns of local spatial autocorrelation. Across all three periods,&nbsp;<strong>Bangkok</strong>&nbsp;consistently shows negative spatial autocorrelation for foreign tourist numbers, suggesting that it stands out among the neighbours.&nbsp;<strong>Chonburi</strong>, on the other hand, consistently exhibits positive spatial autocorrelation, confirming its strength as a foreign tourist hotspot and maintaining high revenue, occupancy, and foreign tourist numbers across all periods</p>
<p>Although there are some shifts in occupancy rate clusters during the pandemic, the broader spatial patterns remain generally consistent across pre, during, and post-COVID periods.</p>
<p>With these results from the space and time study, the following are some policy suggestions for the sustainability of tourism economy in Thailand.</p>
<ul>
<li><p><strong>Targeted Support for Main Tourist Hubs</strong>:</p>
<ul>
<li><p><strong>Bangkok</strong>: Given its persistent negative spatial autocorrelation, although Bangkok has the highest tourism revenue, policymakers should explore why Bangkok consistently stands out and consider targeted strategies, such as infrastructure investment or promotional campaigns, to ensure its tourism sector remains competitive in the neighboring provinces to benefit equally from the tourism flow.</p></li>
<li><p><strong>Chonburi</strong>: With lots of tourist destinations and beautiful beaches like Pattaya in the Chonburi province, policymakers should maintain and market more attractions in this province.</p></li>
</ul></li>
<li><p><strong>Pandemic Recovery Support</strong>:</p>
<ul>
<li><strong>Recovery Plans</strong>: During COVID, several provinces saw no tourist activity, which may have resulted in long-term damage to their local economies. A robust recovery plan focused on revitalizing tourism in these regions is essential. Policymakers could introduce incentives like tax breaks for tourism businesses, grants for tourism-related infrastructure, and marketing campaigns to rebuild tourism appeal post-pandemic.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="emerging-hotspot-analysis" class="level1">
<h1>6 Emerging Hotspot Analysis</h1>
<p>Having analyzed the spatial autocorrelation of the selected tourism economy indicators, we will now proceed to incorporate temporal trends and conduct an Emerging Hot Spot Analysis. This next phase aims to identify dynamic patterns in tourism data, revealing how hot spots and cold spots evolve over time. By integrating both spatial and temporal dimensions, we can gain deeper insights into the factors influencing tourism trends and their implications for economic development.</p>
<section id="method-overview-1" class="level2">
<h2 class="anchored" data-anchor-id="method-overview-1">6.1 Method Overview</h2>
<p>Emerging Hot Spot Analysis (EHSA) is a comprehensive approach to understanding spatial patterns by incorporating temporal trends, revealing how hot spots (areas with high values) and cold spots (areas with low values) evolve over time. Below are the primary steps and methodology for this analysis:</p>
<ol type="1">
<li><p><strong>Building a Space-Time Cube</strong><br>
The first step in EHSA is constructing a space-time cube, which organizes spatial data by time slices (bins). Each location in the spatial dataset is represented by a series of time-stamped values, creating a 3D structure. This cube allows for the simultaneous analysis of both spatial and temporal dimensions, capturing how a phenomenon changes over time across different locations. In this analysis, each time slice corresponds to a specific period (month-year for our case), and the values at each location represent the attribute being studied (e.g., tourist revenue, occupancy rate, number of foreign tourists).</p></li>
<li><p><strong>Calculating the Getis-Ord Gi&nbsp;Statistic*</strong><br>
Once the space-time cube is built, the&nbsp;<strong>Getis-Ord Gi</strong>* statistic is computed for each bin (location at a specific time). This statistic measures the degree to which high or low values cluster spatially. By applying an FDR (False Discovery Rate) correction, the analysis adjusts for multiple testing, ensuring that the identification of significant hot spots and cold spots is statistically valid.</p></li>
<li><p><strong>Evaluating Hot and Cold Spot Trends Using the Mann-Kendall Trend Test</strong><br>
To assess how these hot and cold spots evolve over time, the&nbsp;<strong>Mann-Kendall trend test</strong>&nbsp;is applied to the space-time cube data. This non-parametric test evaluates whether there is a statistically significant upward or downward trend in the hot or cold spot patterns over the period analyzed. The test helps determine whether the spatial clusters of high or low values are increasing, decreasing, or remaining stable over time.</p></li>
<li><p><strong>Categorizing Study Area Locations</strong><br>
Based on the trend analysis, each study area location is categorized according to its temporal trend. This categorization is achieved by combining the z-scores and p-values from both the Mann-Kendall trend test and the Getis-Ord Gi* statistic. Locations are classified depending on whether the clusters of high or low values show significant changes over time. The categorization highlights areas with growing or fading clusters.</p></li>
</ol>
</section>
<section id="computing-gi-statistics" class="level2">
<h2 class="anchored" data-anchor-id="computing-gi-statistics">6.1 Computing Gi* Statistics</h2>
<p>We will need to derive a spatial weight matrix before we can compute local Gi* statistics using the include_self() code below.</p>
<p>Although we used KNN for spatial autocorrelation analysis to capture relationships among a fixed number of neighboring provinces, inverse distance weights are appropriate for emerging hotspot analysis because this method captures the spatial decay of influence, where closer locations have a stronger impact on each other than those further apart. By using inverse distance weighting, we account for the fact that the influence of one region on another diminishes with increasing distance, reflecting a more realistic spatial interaction model. This approach allows us to better identify emerging hotspots where tourism dynamics are more likely influenced by nearby regions, providing a better understanding of how tourism patterns evolve over time in relation to spatial proximity.</p>
<p>The following code chunk will be used to identify neighbors and to derive an inverse distance weights matrix.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Explanation</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>tourism_nb <span class="ot">&lt;-</span> tourism_spt <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neighbours =</span> <span class="fu">include_self</span>(<span class="fu">st_knn</span>(geometry, <span class="at">k =</span> <span class="dv">6</span>)),  <span class="co"># Find 6 nearest neighbors and include self</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">weights =</span> <span class="fu">st_inverse_distance</span>(neighbours, geometry, <span class="at">scale =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"neighbours"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"weights"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(tourism_nb, <span class="st">"data/rds/tourism_nb.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>tourism_nb <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/tourism_nb.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<ul>
<li><p><strong>activate(“geometry”)</strong>: The&nbsp;<code>activate()</code>&nbsp;function from the&nbsp;<code>dplyr</code>&nbsp;package is used to activate the geometry context within the&nbsp;<code>tourism_spt</code>&nbsp;object. This focuses the operations on the spatial (geometric) data rather than the temporal data.</p></li>
<li><p><strong>mutate()</strong>: Within the geometry context, two new columns,&nbsp;<code>neighbours</code>&nbsp;and&nbsp;<code>weights</code>, are created:</p>
<ul>
<li><p>neighbours: The&nbsp;<code>include_self()</code>&nbsp;function is used with&nbsp;<code>st_knn(geometry)</code>. <code>st_knn()</code>&nbsp;is used here because it ensures that each spatial feature (province) has a fixed number of neighbors, regardless of the geographic distribution of the data.</p></li>
<li><p>weights: The&nbsp;<code>st_inverse_distance()</code>&nbsp;function computes inverse distance weights for the neighbors using the&nbsp;<code>nb</code>&nbsp;column and&nbsp;<code>geometry</code>. These weights are scaled by a factor of 1, and the distance is raised to the power of&nbsp;<code>alpha</code>(which is set to 1).</p></li>
</ul></li>
<li><p><strong>set_nbs(“<strong>neighbours</strong>”)</strong>&nbsp;and&nbsp;<strong>set_wts(“<strong>weights</strong>”)</strong>: After activating the data context again (automatically done by&nbsp;<code>%&gt;%</code>), the&nbsp;<code>set_nbs()</code>and&nbsp;<code>set_wts()</code>&nbsp;functions are used to copy over the neighbours and weights columns to each time slice of the spatio-temporal data.</p></li>
</ul>
</div>
</div>
</div>
<p>We can use these new columns to calculate the local Gi* for each location for each of the tourism economy indicators. We can do this by grouping by <em>date_int</em> and using <code>local_gstar_perm()</code> of sfdep package. Finally, we will use <code>unnest()</code> to unnest <em>gi_star</em> column of the newly created <em>gi_starts</em> data.frame.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Occpancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false">Number of Foreign Tourists</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>rev_gi_stars <span class="ot">&lt;-</span> tourism_nb <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_int) <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    revenue_all, neighbours, weights)) <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>or_gi_stars <span class="ot">&lt;-</span> tourism_nb <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_int) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    ratio_tourist_stay, neighbours, weights)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>ft_gi_stars <span class="ot">&lt;-</span> tourism_nb <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_int) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    no_tourist_foreign, neighbours, weights)) <span class="sc">%&gt;%</span> </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="mann-kendall-test" class="level2">
<h2 class="anchored" data-anchor-id="mann-kendall-test">6.2 Mann-Kendall Test</h2>
<p>The <strong>Mann-Kendall test</strong> is a non-parametric statistical method commonly used in time series analysis to detect trends in data, making it particularly useful in the context of EHSA. It is applied to evaluate the significance of trends in hot spots or cold spots, helping determine whether these patterns are random or systematic.</p>
<p>The following is the hypothesis we would like to test:</p>
<ul>
<li><p><strong>Null hypothesis(H0)</strong>: There is no trend in the data, meaning the observed values are independent and randomly ordered.</p></li>
<li><p><strong>Alternative hypothesis (H1):</strong> A trend exists (either positive, negative, or non-null)</p></li>
</ul>
<p>Rejecting the null hypothesis indicates the presence of a significant trend, either positive (increasing over time) or negative (decreasing over time).</p>
<section id="revenue-3" class="level3">
<h3 class="anchored" data-anchor-id="revenue-3">6.2.1 Revenue</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">Bangkok</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Chonburi</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>bkk_rev <span class="ot">&lt;-</span> rev_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Bangkok"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-790171f8b3bf5763008a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-790171f8b3bf5763008a">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[4.5364168131763876,4.6319632797051371,4.3994656756224293,5.2876457134664543,5.3544314367575438,5.229813602811956,5.8742004180786447,5.9047055360791783,5.854380528151534,5.0724072550499955,5.140875196068051,5.0692924256700058,4.5129512526709989,4.7962159496535257,4.8242705993900872,6.1170389407306889,6.1290213371988216,5.6832011909917739,5.1588891245900319,5.7553789380277482,5.7000245032506252,4.7961921551159286,4.7577608744801978,4.7980115317647556,5.8173767956082472,5.7145645422900646,5.5861056276597383,4.9624116599954675,5.5156458945887081,5.1956907314235767,2.6908603755110665,3.1085703481966549,3.217557937007685,3.2537034626366768,2.4812337571205734,4.3641374333669001,4.1371738801770492,4.2682597996462333,4.7184108214811218,4.8081327090457071,4.7673721331494656,4.8805198589573617,4.7374099976689612,4.7978287106271438,4.8028464458904487,5.0452775589462169,4.9803980890382382,5.066914926536624,5.0836180321457602,4.9742515271317451],"text":["date_int: 201901<br />gi_star: 4.536417","date_int: 201902<br />gi_star: 4.631963","date_int: 201903<br />gi_star: 4.399466","date_int: 201904<br />gi_star: 5.287646","date_int: 201905<br />gi_star: 5.354431","date_int: 201906<br />gi_star: 5.229814","date_int: 201907<br />gi_star: 5.874200","date_int: 201908<br />gi_star: 5.904706","date_int: 201909<br />gi_star: 5.854381","date_int: 201910<br />gi_star: 5.072407","date_int: 201911<br />gi_star: 5.140875","date_int: 201912<br />gi_star: 5.069292","date_int: 202001<br />gi_star: 4.512951","date_int: 202002<br />gi_star: 4.796216","date_int: 202003<br />gi_star: 4.824271","date_int: 202004<br />gi_star: 6.117039","date_int: 202005<br />gi_star: 6.129021","date_int: 202006<br />gi_star: 5.683201","date_int: 202007<br />gi_star: 5.158889","date_int: 202008<br />gi_star: 5.755379","date_int: 202009<br />gi_star: 5.700025","date_int: 202010<br />gi_star: 4.796192","date_int: 202011<br />gi_star: 4.757761","date_int: 202012<br />gi_star: 4.798012","date_int: 202101<br />gi_star: 5.817377","date_int: 202102<br />gi_star: 5.714565","date_int: 202103<br />gi_star: 5.586106","date_int: 202104<br />gi_star: 4.962412","date_int: 202105<br />gi_star: 5.515646","date_int: 202106<br />gi_star: 5.195691","date_int: 202107<br />gi_star: 2.690860","date_int: 202108<br />gi_star: 3.108570","date_int: 202109<br />gi_star: 3.217558","date_int: 202110<br />gi_star: 3.253703","date_int: 202111<br />gi_star: 2.481234","date_int: 202112<br />gi_star: 4.364137","date_int: 202201<br />gi_star: 4.137174","date_int: 202202<br />gi_star: 4.268260","date_int: 202203<br />gi_star: 4.718411","date_int: 202204<br />gi_star: 4.808133","date_int: 202205<br />gi_star: 4.767372","date_int: 202206<br />gi_star: 4.880520","date_int: 202207<br />gi_star: 4.737410","date_int: 202208<br />gi_star: 4.797829","date_int: 202209<br />gi_star: 4.802846","date_int: 202210<br />gi_star: 5.045278","date_int: 202211<br />gi_star: 4.980398","date_int: 202212<br />gi_star: 5.066915","date_int: 202301<br />gi_star: 5.083618","date_int: 202302<br />gi_star: 4.974252"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":31.415525114155255},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2.298844378116661,6.311410716202734],"tickmode":"array","ticktext":["3","4","5","6"],"tickvals":[3,4,5,6],"categoryorder":"array","categoryarray":["3","4","5","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86cd592fcf":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86cd592fcf","visdat":{"e86cd592fcf":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Increase:</strong> <em>The Gi</em>&nbsp;values start around&nbsp;4 and goes slightly higher, suggesting <strong>this is a</strong> periods where tourism revenue patterns are higher in Bangkok. This could indicate that certain regions of the city were performing well in terms of earning revenue from tourism.</p></li>
<li><p><strong>Sharp Drop to Negative Values (Mid-2021)</strong>: Around&nbsp;mid-2021 (07-11), the Gi* statistic drops sharply to a Gi value of 2.5. This indicates the revenue was significantly lower than before. This sharp decline correlates with the COVID-19 and the resulting lowest point of tourism revenue.</p></li>
<li><p><strong>Slow Recovery (2022 onwards)</strong>: The Gi* statistic sharply rises back up into 2022. Although the Gi* statistic stays below 5 (what it used to be pre-covid) for some time, there is an upward trend. This may reflect a slow recovery in revenue as tourism and business travel began to resume. Going into 2023, it has recovered back beyond 5.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>bkk_rev <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
     tau     sl     S     D   varS
   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 -0.174 0.0762  -213  1225 14292.</code></pre>
</div>
</div>
<p>In the results, sl is the p-value. Since it is slightly greater than our level of significance (0.05), we <strong>fail to reject they null hypothesis</strong> for Bangkok. There is no trend in the data, meaning the observed values are independent and randomly ordered.</p>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>cbr_rev <span class="ot">&lt;-</span> rev_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Chonburi"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b4368f0841dd06d6138d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b4368f0841dd06d6138d">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[3.7066519640063502,3.8104283291882224,3.7313430459371002,4.1521485817714314,4.2739410878395212,4.1050963204204907,3.5039298661628457,3.5342864358007073,3.4716176530793583,4.0232941608609414,4.1182838231217049,3.6583584742324948,3.5113086800073128,3.0954093901498805,3.520009635631705,3.3098777151044216,3.3125174177972498,3.7252338925409676,3.5104481379704349,3.5833331310433874,3.5653972909469327,3.972759083503254,4.3020813690056636,4.024070480832922,2.588598860404034,2.6767568326628783,2.6778685291402806,2.718740946234492,2.9982908360635014,3.2345300896187288,1.7495139667956365,1.8328732598023112,2.4129116757581839,3.0392566195601232,4.0845583981204809,3.7220123262311393,4.2586158993891186,4.1468281977680483,4.0941573897561012,4.0242255704730514,3.7121066729482011,3.551556048763111,3.2930557045692601,3.3478815742904962,3.2390224684126814,3.5522932122048463,3.742066589679089,3.9540668578179519,3.9074081344945815,3.6139673285138567],"text":["date_int: 201901<br />gi_star: 3.706652","date_int: 201902<br />gi_star: 3.810428","date_int: 201903<br />gi_star: 3.731343","date_int: 201904<br />gi_star: 4.152149","date_int: 201905<br />gi_star: 4.273941","date_int: 201906<br />gi_star: 4.105096","date_int: 201907<br />gi_star: 3.503930","date_int: 201908<br />gi_star: 3.534286","date_int: 201909<br />gi_star: 3.471618","date_int: 201910<br />gi_star: 4.023294","date_int: 201911<br />gi_star: 4.118284","date_int: 201912<br />gi_star: 3.658358","date_int: 202001<br />gi_star: 3.511309","date_int: 202002<br />gi_star: 3.095409","date_int: 202003<br />gi_star: 3.520010","date_int: 202004<br />gi_star: 3.309878","date_int: 202005<br />gi_star: 3.312517","date_int: 202006<br />gi_star: 3.725234","date_int: 202007<br />gi_star: 3.510448","date_int: 202008<br />gi_star: 3.583333","date_int: 202009<br />gi_star: 3.565397","date_int: 202010<br />gi_star: 3.972759","date_int: 202011<br />gi_star: 4.302081","date_int: 202012<br />gi_star: 4.024070","date_int: 202101<br />gi_star: 2.588599","date_int: 202102<br />gi_star: 2.676757","date_int: 202103<br />gi_star: 2.677869","date_int: 202104<br />gi_star: 2.718741","date_int: 202105<br />gi_star: 2.998291","date_int: 202106<br />gi_star: 3.234530","date_int: 202107<br />gi_star: 1.749514","date_int: 202108<br />gi_star: 1.832873","date_int: 202109<br />gi_star: 2.412912","date_int: 202110<br />gi_star: 3.039257","date_int: 202111<br />gi_star: 4.084558","date_int: 202112<br />gi_star: 3.722012","date_int: 202201<br />gi_star: 4.258616","date_int: 202202<br />gi_star: 4.146828","date_int: 202203<br />gi_star: 4.094157","date_int: 202204<br />gi_star: 4.024226","date_int: 202205<br />gi_star: 3.712107","date_int: 202206<br />gi_star: 3.551556","date_int: 202207<br />gi_star: 3.293056","date_int: 202208<br />gi_star: 3.347882","date_int: 202209<br />gi_star: 3.239022","date_int: 202210<br />gi_star: 3.552293","date_int: 202211<br />gi_star: 3.742067","date_int: 202212<br />gi_star: 3.954067","date_int: 202301<br />gi_star: 3.907408","date_int: 202302<br />gi_star: 3.613967"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.6218855966851351,4.4297097391161646],"tickmode":"array","ticktext":["2.0","2.5","3.0","3.5","4.0"],"tickvals":[2,2.5,3,3.5,4],"categoryorder":"array","categoryarray":["2.0","2.5","3.0","3.5","4.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c2629d92c":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c2629d92c","visdat":{"e86c2629d92c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Trend:</strong> <em>The Gi</em>&nbsp;values starts lower than revenue, around&nbsp;4, suggesting this is a periods where tourism revenue patterns are like pre covid in Chonburi. This could indicate that Chonburi has slighly weaker hotspots and stronger clustering of high values in certain areas compared to Bangkok.</p></li>
<li><p><strong>Sharp Drop to Negative Values (Mid-2021)</strong>: Around&nbsp;mid-2021 (07), the Gi* statistic drops sharply to a Gi value of 1.5. This indicates the revenue was significantly lower than before, similar to Bangkok.</p></li>
<li><p><strong>Slow Recovery (2022 onwards)</strong>: The Gi* statistic sharply rises back up into 2022 with higher Gi* statistic than pre-covid. This may reflect a faster recovery in revenue as tourism and business travel began to resume in Chonburi than in Bangkok.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>cbr_rev <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
      tau    sl     S     D   varS
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 -0.0824 0.403  -101  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is greater than our level of significance (0.05), we also <strong>fail to reject they null hypothesis</strong> for Chonburi. This means that there is the no presence of a significant trend.</p>
</div>
</div>
</div>
<p>We can also see the results of the all provinces by using group_by() as in the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>allprov_rev <span class="ot">&lt;-</span> rev_gi_stars <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(allprov_rev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng      tau     sl     S     D   varS
  &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Amnat Charoen -0.205  0.0365  -251  1225 14292.
2 Ang Thong      0.0302 0.763     37  1225 14292.
3 Bangkok       -0.174  0.0762  -213  1225 14292.
4 Bueng Kan     -0.133  0.175   -163  1225 14292.
5 Buriram       -0.0498 0.616    -61  1225 14292.
6 Chachoengsao  -0.174  0.0762  -213  1225 14292.</code></pre>
</div>
</div>
<p>Then , we can sort this dataframe to see significant emerging hot/cold spots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>emerging_rev <span class="ot">&lt;-</span> allprov_rev <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sl, <span class="fu">abs</span>(tau)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(emerging_rev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng           tau           sl     S     D   varS
  &lt;chr&gt;                &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Nakhon Si Thammarat -0.540 0.0000000337  -661  1225 14292.
2 Nan                  0.461 0.00000238     565  1225 14292.
3 Phatthalung         -0.450 0.00000421    -551  1225 14292.
4 Chumphon            -0.429 0.0000117     -525  1225 14292.
5 Chiang Rai           0.373 0.000136       457  1225 14292.
6 Narathiwat          -0.365 0.000191      -447  1225 14292.</code></pre>
</div>
</div>
<p>sl (p-values):</p>
<ul>
<li><p>6 provinces, namely Nakhon&nbsp;Si&nbsp;Thammarat, Nan, Phatthalung,Chumphon, Chiang Rai, Narathiwat, Pattani, Yala, Phayao, and Mae&nbsp;Hong&nbsp;Son, are the top hotspot/coldspot provinces in terms of total revenue generated from tourism.</p></li>
<li><p>Provinces with very small sl values (e.g.&nbsp;Nan) indicate&nbsp;<strong>high statistical significance</strong>, suggesting that the observed trend is unlikely to be due to random variation.</p></li>
<li><p>Provinces with higher absoulate tau values (e.g.&nbsp;Nakhon Si Thammarat) indicate <strong>stronger trend</strong> whether it is decreasing or increasing.</p></li>
</ul>
<p>Tau values:</p>
<ul>
<li><p><strong>Negative tau values</strong>&nbsp;(e.g., Nakhon Si Thammarat, Phatthalung, and Chumphon) suggest a&nbsp;<strong>decreasing trend</strong>&nbsp;in tourism revenue. Their hot spots are becoming weaker&nbsp;or less frequent over time.</p></li>
<li><p><strong>Positive tau values</strong>&nbsp;(e.g., Nan and Chiang Rai) indicate an&nbsp;increasing trend, meaning that these provinces are potential hotspots for development since there has been growth in tourism revenue overtime.</p></li>
</ul>
</section>
<section id="occupancy-rate-4" class="level3">
<h3 class="anchored" data-anchor-id="occupancy-rate-4">6.2.2 Occupancy Rate</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Bangkok</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Khon Kaen</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false">Chiang Rai</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<p>the province that has the strongest negative local autocorrelation consistently</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>bkk_or <span class="ot">&lt;-</span> or_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Bangkok"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-284c5ae9d4cabeadbb39" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-284c5ae9d4cabeadbb39">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[1.5311751342424935,1.6614623381106575,1.5655069694605175,1.8648602284433973,2.6215190710506224,2.2081147536907442,2.49840791545114,2.6882443487586674,1.7290591411370957,0.98601227619929677,1.8276182809862473,1.3770268886555428,1.2748293641480049,0.58102225094173154,-1.8581944703316313,4.0549961408329516,0.76529864415175497,-0.84977706727115587,-2.3624734316468983,-1.9251145429392835,-1.8535848004423388,-2.6169535464346119,-1.9717085397828673,-2.658890896273677,-2.6254391561997292,-3.2444197876659282,-3.4309655683203095,-2.3908564774404977,-0.089985592483701596,-0.3521465668982306,-1.3942222219293985,-1.19939285363555,1.1130268040069429,0.015196263622058248,-0.51683414374393166,-1.2356577059909615,-2.0483088111881109,-1.8667503219331452,-1.6977221389783044,-1.8824195369266161,-1.8906651324791679,-1.5798832521471928,-1.3811583397240421,-0.88917660477737936,-0.75601174650609559,-1.4434163784880523,-0.11037949623480421,-0.86223786090749477,-0.63644751528672383,-0.56900916571223714],"text":["date_int: 201901<br />gi_star:  1.53117513","date_int: 201902<br />gi_star:  1.66146234","date_int: 201903<br />gi_star:  1.56550697","date_int: 201904<br />gi_star:  1.86486023","date_int: 201905<br />gi_star:  2.62151907","date_int: 201906<br />gi_star:  2.20811475","date_int: 201907<br />gi_star:  2.49840792","date_int: 201908<br />gi_star:  2.68824435","date_int: 201909<br />gi_star:  1.72905914","date_int: 201910<br />gi_star:  0.98601228","date_int: 201911<br />gi_star:  1.82761828","date_int: 201912<br />gi_star:  1.37702689","date_int: 202001<br />gi_star:  1.27482936","date_int: 202002<br />gi_star:  0.58102225","date_int: 202003<br />gi_star: -1.85819447","date_int: 202004<br />gi_star:  4.05499614","date_int: 202005<br />gi_star:  0.76529864","date_int: 202006<br />gi_star: -0.84977707","date_int: 202007<br />gi_star: -2.36247343","date_int: 202008<br />gi_star: -1.92511454","date_int: 202009<br />gi_star: -1.85358480","date_int: 202010<br />gi_star: -2.61695355","date_int: 202011<br />gi_star: -1.97170854","date_int: 202012<br />gi_star: -2.65889090","date_int: 202101<br />gi_star: -2.62543916","date_int: 202102<br />gi_star: -3.24441979","date_int: 202103<br />gi_star: -3.43096557","date_int: 202104<br />gi_star: -2.39085648","date_int: 202105<br />gi_star: -0.08998559","date_int: 202106<br />gi_star: -0.35214657","date_int: 202107<br />gi_star: -1.39422222","date_int: 202108<br />gi_star: -1.19939285","date_int: 202109<br />gi_star:  1.11302680","date_int: 202110<br />gi_star:  0.01519626","date_int: 202111<br />gi_star: -0.51683414","date_int: 202112<br />gi_star: -1.23565771","date_int: 202201<br />gi_star: -2.04830881","date_int: 202202<br />gi_star: -1.86675032","date_int: 202203<br />gi_star: -1.69772214","date_int: 202204<br />gi_star: -1.88241954","date_int: 202205<br />gi_star: -1.89066513","date_int: 202206<br />gi_star: -1.57988325","date_int: 202207<br />gi_star: -1.38115834","date_int: 202208<br />gi_star: -0.88917660","date_int: 202209<br />gi_star: -0.75601175","date_int: 202210<br />gi_star: -1.44341638","date_int: 202211<br />gi_star: -0.11037950","date_int: 202212<br />gi_star: -0.86223786","date_int: 202301<br />gi_star: -0.63644752","date_int: 202302<br />gi_star: -0.56900917"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.8052636537779727,4.4292942262906143],"tickmode":"array","ticktext":["-2","0","2","4"],"tickvals":[-2,0,1.9999999999999996,3.9999999999999996],"categoryorder":"array","categoryarray":["-2","0","2","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c7c6c6d6a":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c7c6c6d6a","visdat":{"e86c7c6c6d6a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Positives:</strong> <em>The Gi</em>&nbsp;values start around&nbsp;2 or slightly higher, suggesting that we can see some patterns of temporal clustering&nbsp;(periods where occupancy rates are higher precovid), meaning areas in Bangkok had significantly higher occupancy rates than expected based on the overall distribution. This could indicate that certain regions of the city were performing well in terms of hotel occupancy before the pandemic.</p></li>
<li><p><strong>Sharp Drop to Negative Values (Mid-2020)</strong>: Unlike revenue which only decreased sharply in 2021, for occupancy rate, the Gi* statistic drops sharply to negative values, close to&nbsp;-2 around&nbsp;mid-2020. This indicates the emergence of&nbsp;cold spots, where the occupancy rate was significantly lower than expected. This sharp decline correlates exactly with the COVID-19 timeline and the resulting collapse in tourism and hospitality demand, leading to widespread low occupancy in Bangkok hotels.</p></li>
<li><p><strong>Slow Recovery (2021 onwards)</strong>: The Gi* statistic gradually rises from the negative values during&nbsp;late 2021&nbsp;and into&nbsp;2022. Although the Gi* statistic stays below 0 for some time, the upward trend suggests a&nbsp;weakening of cold spots. This may reflect a slow recovery in occupancy rates as tourism and business travel began to pick up post-pandemic, but the values remain below their pre-pandemic levels.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>bkk_or <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
     tau      sl     S     D   varS
   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 -0.313 0.00140  -383  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is less than our level of significance, we <strong>will reject the null hypothesis</strong> for Bangkok, indicating that there is might be montonic trend in the data.From the tau value we see that the temporal trend is negative over the period of 2019 to 2023. If the tau is negative in conjunction with Gi* statistics, it could imply that there is a&nbsp;decline in spatial clustering&nbsp;of high occupancy rates over time.</p>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<p>the province that has the strongest positive local autocorrelation pre-covid</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>kk_or <span class="ot">&lt;-</span> or_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Khon Kaen"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f0bfaad072558b439a66" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f0bfaad072558b439a66">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[-1.8378687583888651,-2.7093835006734719,-1.5443167261279345,-1.4070960040457645,-1.7426351083537575,-0.58891011442093733,0.0044544320987438797,-0.44598123146691371,-0.024677278740795297,-0.9201886475766522,-1.5610416119449257,-2.2826930253069451,-1.9709697338171768,-1.1535869340498843,-2.6828097261382871,-1.4477304797441086,-0.49210505619284461,-1.715787710498343,0.15257566850337761,0.59503017849082684,0.5285869072099898,0.73205685631289819,0.34376198638792227,1.0701519030285405,1.1935088674043108,0.17813741729744142,0.68666271054308103,-1.9793882423772757,-1.2165149644623929,-1.2595592538794245,-0.78284006102839621,-0.91045034372569478,-2.0872288742812817,-1.2355237714227476,-1.3516359318102968,-0.78344959549893067,-1.3182820388038963,-1.498318580552608,-1.3413736060537864,-0.029659474613908342,-0.43495083096617204,-0.26828001459868839,-0.62571037109897631,-0.13814089716822595,-0.78960663595225322,-1.0054994741778147,-1.4177444462245392,-1.4914377048042524,-0.93334443289091173,-1.2366295099417421],"text":["date_int: 201901<br />gi_star: -1.837868758","date_int: 201902<br />gi_star: -2.709383501","date_int: 201903<br />gi_star: -1.544316726","date_int: 201904<br />gi_star: -1.407096004","date_int: 201905<br />gi_star: -1.742635108","date_int: 201906<br />gi_star: -0.588910114","date_int: 201907<br />gi_star:  0.004454432","date_int: 201908<br />gi_star: -0.445981231","date_int: 201909<br />gi_star: -0.024677279","date_int: 201910<br />gi_star: -0.920188648","date_int: 201911<br />gi_star: -1.561041612","date_int: 201912<br />gi_star: -2.282693025","date_int: 202001<br />gi_star: -1.970969734","date_int: 202002<br />gi_star: -1.153586934","date_int: 202003<br />gi_star: -2.682809726","date_int: 202004<br />gi_star: -1.447730480","date_int: 202005<br />gi_star: -0.492105056","date_int: 202006<br />gi_star: -1.715787710","date_int: 202007<br />gi_star:  0.152575669","date_int: 202008<br />gi_star:  0.595030178","date_int: 202009<br />gi_star:  0.528586907","date_int: 202010<br />gi_star:  0.732056856","date_int: 202011<br />gi_star:  0.343761986","date_int: 202012<br />gi_star:  1.070151903","date_int: 202101<br />gi_star:  1.193508867","date_int: 202102<br />gi_star:  0.178137417","date_int: 202103<br />gi_star:  0.686662711","date_int: 202104<br />gi_star: -1.979388242","date_int: 202105<br />gi_star: -1.216514964","date_int: 202106<br />gi_star: -1.259559254","date_int: 202107<br />gi_star: -0.782840061","date_int: 202108<br />gi_star: -0.910450344","date_int: 202109<br />gi_star: -2.087228874","date_int: 202110<br />gi_star: -1.235523771","date_int: 202111<br />gi_star: -1.351635932","date_int: 202112<br />gi_star: -0.783449595","date_int: 202201<br />gi_star: -1.318282039","date_int: 202202<br />gi_star: -1.498318581","date_int: 202203<br />gi_star: -1.341373606","date_int: 202204<br />gi_star: -0.029659475","date_int: 202205<br />gi_star: -0.434950831","date_int: 202206<br />gi_star: -0.268280015","date_int: 202207<br />gi_star: -0.625710371","date_int: 202208<br />gi_star: -0.138140897","date_int: 202209<br />gi_star: -0.789606636","date_int: 202210<br />gi_star: -1.005499474","date_int: 202211<br />gi_star: -1.417744446","date_int: 202212<br />gi_star: -1.491437705","date_int: 202301<br />gi_star: -0.933344433","date_int: 202302<br />gi_star: -1.236629510"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.9045281190773609,1.3886534858082],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c4d9c207f":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c4d9c207f","visdat":{"e86c4d9c207f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Negatives:</strong> <em>The Gi</em>&nbsp;values start around&nbsp;-2 and not passing 0 , suggesting that Khon Kaen is already identified as a&nbsp;cold spot, where the measured variable occupancy rate is&nbsp;significantly lower than in surrounding areas pre covid.</p></li>
<li><p><strong>Increase to Positive Values (2020-2021)</strong>: The sharp increase in Khon Kaen’s&nbsp;Gi*&nbsp;statistic during&nbsp;2020–2021&nbsp;could indicate that while the province may not have seen substantial growth, its&nbsp;performance relative to surrounding regions improved significantly, likely due to the&nbsp;uneven impacts of COVID-19. Major tourist hubs suffered more during this period, while&nbsp;smaller or less tourist-reliant provinces&nbsp;like Khon Kaen may have experienced&nbsp;less negative impact, leading to a positive spatial clustering of values.</p></li>
<li><p><strong>Sharp drop (mid-2021) and Recovery (2022 onwards)</strong>: The Gi* statistic drops again mid 2021 as with Bangkok. After an initial adjustment to COVID-19,&nbsp;2021&nbsp;could have brought new challenges as lockdowns and restrictions continued or were reinstated. This could have impacted local businesses, occupancy rates, and tourism again, causing a&nbsp;temporary decline&nbsp;in the Gi* statistic.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>kk_or <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
     tau    sl     S     D   varS
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0.0873 0.375   107  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is greater than our level of significance, we <strong>fail to reject the null hypothesis</strong> for Khon Kaen, there is no montonic trend.</p>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<p>the province that has the strongest positive local autocorrelation post-covid</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>cr_or <span class="ot">&lt;-</span> or_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Chiang Rai"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f3ee1de60e73128aa4e6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f3ee1de60e73128aa4e6">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[2.0312225724964725,0.26255047799971587,-2.6661459360679927,-2.0497341885594444,-1.635954114469196,-2.0859851090854704,-2.1418570505439241,-1.9532175118125492,-1.6484833556789713,-1.1801806198910234,0.70211590331325102,1.8641436103252089,2.2083714496274363,-0.015902397679950036,2.326830226217957,1.9747679146802732,4.4252804721045376,2.5475129799318128,2.5280502222513421,2.3004848664838713,2.2625463332979465,2.747731943927668,4.0067999452850733,3.3395312467941118,1.1209546772056638,1.1450645594246198,0.29404915420562594,-0.89223275437253291,3.4459535750793058,3.0517364311556276,4.3977246611945118,4.7270692789720146,4.3991165561058336,4.1972642948702852,4.9683010343122307,5.1309895925334486,5.3683060136723277,5.7842718435068363,4.5423513344081003,4.1019560718545005,3.548317050940113,3.5829880905596441,3.1676782555058143,2.6536790565307755,2.877675486255642,3.3926688087274894,4.9323138822970289,5.3736638924490236,5.0151060588592005,3.6751914290717416],"text":["date_int: 201901<br />gi_star:  2.0312226","date_int: 201902<br />gi_star:  0.2625505","date_int: 201903<br />gi_star: -2.6661459","date_int: 201904<br />gi_star: -2.0497342","date_int: 201905<br />gi_star: -1.6359541","date_int: 201906<br />gi_star: -2.0859851","date_int: 201907<br />gi_star: -2.1418571","date_int: 201908<br />gi_star: -1.9532175","date_int: 201909<br />gi_star: -1.6484834","date_int: 201910<br />gi_star: -1.1801806","date_int: 201911<br />gi_star:  0.7021159","date_int: 201912<br />gi_star:  1.8641436","date_int: 202001<br />gi_star:  2.2083714","date_int: 202002<br />gi_star: -0.0159024","date_int: 202003<br />gi_star:  2.3268302","date_int: 202004<br />gi_star:  1.9747679","date_int: 202005<br />gi_star:  4.4252805","date_int: 202006<br />gi_star:  2.5475130","date_int: 202007<br />gi_star:  2.5280502","date_int: 202008<br />gi_star:  2.3004849","date_int: 202009<br />gi_star:  2.2625463","date_int: 202010<br />gi_star:  2.7477319","date_int: 202011<br />gi_star:  4.0067999","date_int: 202012<br />gi_star:  3.3395312","date_int: 202101<br />gi_star:  1.1209547","date_int: 202102<br />gi_star:  1.1450646","date_int: 202103<br />gi_star:  0.2940492","date_int: 202104<br />gi_star: -0.8922328","date_int: 202105<br />gi_star:  3.4459536","date_int: 202106<br />gi_star:  3.0517364","date_int: 202107<br />gi_star:  4.3977247","date_int: 202108<br />gi_star:  4.7270693","date_int: 202109<br />gi_star:  4.3991166","date_int: 202110<br />gi_star:  4.1972643","date_int: 202111<br />gi_star:  4.9683010","date_int: 202112<br />gi_star:  5.1309896","date_int: 202201<br />gi_star:  5.3683060","date_int: 202202<br />gi_star:  5.7842718","date_int: 202203<br />gi_star:  4.5423513","date_int: 202204<br />gi_star:  4.1019561","date_int: 202205<br />gi_star:  3.5483171","date_int: 202206<br />gi_star:  3.5829881","date_int: 202207<br />gi_star:  3.1676783","date_int: 202208<br />gi_star:  2.6536791","date_int: 202209<br />gi_star:  2.8776755","date_int: 202210<br />gi_star:  3.3926688","date_int: 202211<br />gi_star:  4.9323139","date_int: 202212<br />gi_star:  5.3736639","date_int: 202301<br />gi_star:  5.0151061","date_int: 202302<br />gi_star:  3.6751914"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.088666825046734,6.2067927324855781],"tickmode":"array","ticktext":["-2","0","2","4","6"],"tickvals":[-2,0,2,4,5.9999999999999991],"categoryorder":"array","categoryarray":["-2","0","2","4","6"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c4d9dd84c":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c4d9dd84c","visdat":{"e86c4d9dd84c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Negatives:</strong> <em>The Gi</em>&nbsp;values start around&nbsp;2 and stays below 0 initially , suggesting that Chiang Rai is might have seasonality trends, where the measured variable occupancy rate is&nbsp;significantly lower than in surrounding areas. It only increases back in December to positive values.</p></li>
<li><p><strong>Sharp drop (mid-2021)</strong>: The sharp decrease in Chiang Rai’s&nbsp;Gi*&nbsp;statistic during&nbsp;2020–2021. This drop in occupancy rate is seen throughout the other provinces so it may be due to new lockdowns and restrictions.</p></li>
<li><p><strong>Recovery (2022 onwards)</strong>: After the one month of drop in April 2021, The Gi* statistic drastically increases again into 2023 unlike Khon Kaen, much higher than the initial pre-covid time. This means that hotspots are beginning to emerge in Chiang Rai quickly.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>cr_or <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
    tau    sl     S     D   varS
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0.584     0   715  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is less than our level of significance, we <strong>will reject the null hypothesis</strong> for Chiang Rai as well, indicating that there is might be montonic trend in the data. From the tau value we see that the temporal trend is positive over the period of 2019 to 2023. The tau value of Chiang Rai is much higher than that of Khon Kaen, implying that there is an increase in spatial clustering&nbsp;of high occupancy rates and it is growing over time in Chiang Rai.</p>
</div>
</div>
</div>
<p>Now we view the emerging hotspots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|echo: False</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>allprov_or <span class="ot">&lt;-</span> or_gi_stars <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(allprov_or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng     tau          sl     S     D   varS
  &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Amnat Charoen -0.208 0.0336       -255  1225 14292.
2 Ang Thong     -0.512 0.000000164  -627  1225 14292.
3 Bangkok       -0.313 0.00140      -383  1225 14292.
4 Bueng Kan      0.167 0.0879        205  1225 14292.
5 Buriram        0.311 0.00148       381  1225 14292.
6 Chachoengsao  -0.373 0.000137     -457  1225 14292.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>emerging_or <span class="ot">&lt;-</span> allprov_or <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sl, <span class="fu">abs</span>(tau)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(emerging_or)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng    tau           sl     S     D   varS
  &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Nan           0.540 0              661  1225 14292.
2 Chiang Rai    0.584 0              715  1225 14292.
3 Suphan Buri  -0.543 0.0000000279  -665  1225 14292.
4 Phayao        0.528 0.000000119    647  1225 14292.
5 Ang Thong    -0.512 0.000000164   -627  1225 14292.
6 Chainat      -0.497 0.000000366   -609  1225 14292.</code></pre>
</div>
</div>
<p>sl (p-values):</p>
<ul>
<li><p>10 provinces, namely Nan, Chiang Rai, Suphan&nbsp;Buri, Chiang Rai, Phayao, Ang Thong, Chainat, Nakhon Pathom, Samut Songkhram, Samut Sakhon and Chiang Mai, are the top hotspot/coldspot provinces in terms of tourist occupancy rate.</p></li>
<li><p>Provinces with very small sl values (e.g., Nan and Chiang Rai) indicate&nbsp;<strong>high statistical significance</strong>, suggesting that the observed trend is unlikely to be due to random variation.</p></li>
</ul>
<p>Tau values:</p>
<ul>
<li><p><strong>Negative tau values</strong>&nbsp;(e.g., Suphan&nbsp;Buri, Ang Thong, Chainat, Nakhon Pathom, Samut Songkhram, Samut Sakhon) suggest a&nbsp;<strong>decreasing trend</strong>&nbsp;in the occupancy rate.Their hot spots are becoming weaker over time.</p></li>
<li><p><strong>Positive tau values</strong>&nbsp;(e.g., Chiang Mai, Phayao, Nan and Chiang Rai) indicate an&nbsp;<strong>increasing trend</strong>, meaning that these provinces are potential hotspots for development of hotels, motels and other tourist infratstructure since there has been growth in tourism occupancy.</p></li>
</ul>
</section>
<section id="number-of-foreign-tourists-4" class="level3">
<h3 class="anchored" data-anchor-id="number-of-foreign-tourists-4">6.2.3 Number of Foreign Tourists</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Bangkok</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Chonburi</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<p>the province that has the strongest negative local autocorrelation consistently</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>bkk_ft <span class="ot">&lt;-</span> ft_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Bangkok"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-10ef9a283e08251d6d01" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-10ef9a283e08251d6d01">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[5.0528804460648438,5.3099441018538061,4.9873696179266345,5.1769914434966813,5.1584206206841881,5.1451115514813202,5.6932365985369344,5.8588445958399191,5.591276816324406,4.4653650967969591,4.5281516508890354,4.8389504028901298,5.0239803155536507,5.3308841396512188,5.559050056744443,6.1248923884973543,6.1351690561662942,5.9918970853041751,5.8524718452547067,5.8600265117584938,5.9310294541746691,5.970115118770134,5.9094167665695023,6.1468814793876811,6.1699432422818141,6.1617678630070705,6.2833361374271508,6.1803963282940995,6.180384205854569,6.1977469190919949,4.8377151948335948,4.8419761314510401,4.1584621635576955,5.3068618328141932,5.5909117861916515,5.4511075502548261,4.7059549290664222,5.1670141774234164,5.4671603908464848,5.3647937346747305,5.829397121638606,5.8054203075816373,5.7388002880591058,5.7083354899962595,5.6101516494110779,5.6916568552819129,5.727159435363423,5.7033791962919675,5.6572788090464847,5.4939308399865645],"text":["date_int: 201901<br />gi_star: 5.052880","date_int: 201902<br />gi_star: 5.309944","date_int: 201903<br />gi_star: 4.987370","date_int: 201904<br />gi_star: 5.176991","date_int: 201905<br />gi_star: 5.158421","date_int: 201906<br />gi_star: 5.145112","date_int: 201907<br />gi_star: 5.693237","date_int: 201908<br />gi_star: 5.858845","date_int: 201909<br />gi_star: 5.591277","date_int: 201910<br />gi_star: 4.465365","date_int: 201911<br />gi_star: 4.528152","date_int: 201912<br />gi_star: 4.838950","date_int: 202001<br />gi_star: 5.023980","date_int: 202002<br />gi_star: 5.330884","date_int: 202003<br />gi_star: 5.559050","date_int: 202004<br />gi_star: 6.124892","date_int: 202005<br />gi_star: 6.135169","date_int: 202006<br />gi_star: 5.991897","date_int: 202007<br />gi_star: 5.852472","date_int: 202008<br />gi_star: 5.860027","date_int: 202009<br />gi_star: 5.931029","date_int: 202010<br />gi_star: 5.970115","date_int: 202011<br />gi_star: 5.909417","date_int: 202012<br />gi_star: 6.146881","date_int: 202101<br />gi_star: 6.169943","date_int: 202102<br />gi_star: 6.161768","date_int: 202103<br />gi_star: 6.283336","date_int: 202104<br />gi_star: 6.180396","date_int: 202105<br />gi_star: 6.180384","date_int: 202106<br />gi_star: 6.197747","date_int: 202107<br />gi_star: 4.837715","date_int: 202108<br />gi_star: 4.841976","date_int: 202109<br />gi_star: 4.158462","date_int: 202110<br />gi_star: 5.306862","date_int: 202111<br />gi_star: 5.590912","date_int: 202112<br />gi_star: 5.451108","date_int: 202201<br />gi_star: 4.705955","date_int: 202202<br />gi_star: 5.167014","date_int: 202203<br />gi_star: 5.467160","date_int: 202204<br />gi_star: 5.364794","date_int: 202205<br />gi_star: 5.829397","date_int: 202206<br />gi_star: 5.805420","date_int: 202207<br />gi_star: 5.738800","date_int: 202208<br />gi_star: 5.708335","date_int: 202209<br />gi_star: 5.610152","date_int: 202210<br />gi_star: 5.691657","date_int: 202211<br />gi_star: 5.727159","date_int: 202212<br />gi_star: 5.703379","date_int: 202301<br />gi_star: 5.657279","date_int: 202302<br />gi_star: 5.493931"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[4.0522184648642225,6.3895798361206237],"tickmode":"array","ticktext":["4.5","5.0","5.5","6.0"],"tickvals":[4.5,5,5.5,6],"categoryorder":"array","categoryarray":["4.5","5.0","5.5","6.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c47e4372f":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c47e4372f","visdat":{"e86c47e4372f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Initial Increase:</strong> <em>The Gi</em>&nbsp;values start at a high value of around&nbsp;5 and goes slightly higher, suggesting <strong>this is a</strong> periods where patterns of foreign tourist are higher in Bangkok. This could indicate that certain regions of the city were tourist attractions.</p></li>
<li><p><strong>Sharp Drop to Negative Values (Mid-2021)</strong>: Around&nbsp;September 2021, the Gi* statistic drops sharply to a Gi value of 4. This indicates the number of tourists was significantly lower than before. This sharp decline correlates with the COVID-19 and the resulting lowest point of foreign tourist arriving in Bangkok.</p></li>
<li><p><strong>Fast Recovery (2022 onwards)</strong>: The Gi* statistic sharply rises back up by November 2021. The Gi* statistic went back to its original status at around 5.5 meaning that Bangkok has fully recovered and welcoming foreign tourists as usual or even more than usual.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>bkk_ft <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
    tau    sl     S     D   varS
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0.140 0.155   171  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is greater than our level of significance, we <strong>fail to reject the null hypothesis</strong> for Bangkok, there is no montonic trend.</p>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>cbr_ft <span class="ot">&lt;-</span> ft_gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(province_eng <span class="sc">==</span> <span class="st">"Chonburi"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date_int, gi_star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f9ffb9521747c0cbc56d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f9ffb9521747c0cbc56d">{"x":{"data":[{"x":[201901,201902,201903,201904,201905,201906,201907,201908,201909,201910,201911,201912,202001,202002,202003,202004,202005,202006,202007,202008,202009,202010,202011,202012,202101,202102,202103,202104,202105,202106,202107,202108,202109,202110,202111,202112,202201,202202,202203,202204,202205,202206,202207,202208,202209,202210,202211,202212,202301,202302],"y":[4.2179757880071991,4.2763049483063247,4.2334146722161172,4.4003352577263799,4.5009876993643099,4.2482268439161661,4.33940190128612,4.3136870026650209,4.2474081963427857,4.6824909046671905,4.6861603998545789,4.101742086803168,4.2042358645442173,3.6918690239778496,3.7501429602501264,3.3257898486427502,3.3456681051101991,4.0924534824879339,4.1475985986051143,3.9860467676236753,3.9636746224408408,3.9264724303382277,4.1765843865803571,3.572760531140736,3.0514063814551564,3.0823586433067889,3.0225510234631314,2.9897844196130179,3.0419689363242211,3.088099284635426,2.3085376527203136,2.314971710072697,1.9608136795732987,2.4558110744368031,3.351475863432543,2.8966773369304941,4.3951200509558701,4.0705117924245364,3.3911152010256469,3.3057657877465108,3.3657090378247032,3.4556215608765011,3.3443417461675953,3.4442669601478832,3.3484607640371,3.6565763581641919,3.93285664449744,4.1051197791159408,4.2764404684163146,4.3407141732758268],"text":["date_int: 201901<br />gi_star: 4.217976","date_int: 201902<br />gi_star: 4.276305","date_int: 201903<br />gi_star: 4.233415","date_int: 201904<br />gi_star: 4.400335","date_int: 201905<br />gi_star: 4.500988","date_int: 201906<br />gi_star: 4.248227","date_int: 201907<br />gi_star: 4.339402","date_int: 201908<br />gi_star: 4.313687","date_int: 201909<br />gi_star: 4.247408","date_int: 201910<br />gi_star: 4.682491","date_int: 201911<br />gi_star: 4.686160","date_int: 201912<br />gi_star: 4.101742","date_int: 202001<br />gi_star: 4.204236","date_int: 202002<br />gi_star: 3.691869","date_int: 202003<br />gi_star: 3.750143","date_int: 202004<br />gi_star: 3.325790","date_int: 202005<br />gi_star: 3.345668","date_int: 202006<br />gi_star: 4.092453","date_int: 202007<br />gi_star: 4.147599","date_int: 202008<br />gi_star: 3.986047","date_int: 202009<br />gi_star: 3.963675","date_int: 202010<br />gi_star: 3.926472","date_int: 202011<br />gi_star: 4.176584","date_int: 202012<br />gi_star: 3.572761","date_int: 202101<br />gi_star: 3.051406","date_int: 202102<br />gi_star: 3.082359","date_int: 202103<br />gi_star: 3.022551","date_int: 202104<br />gi_star: 2.989784","date_int: 202105<br />gi_star: 3.041969","date_int: 202106<br />gi_star: 3.088099","date_int: 202107<br />gi_star: 2.308538","date_int: 202108<br />gi_star: 2.314972","date_int: 202109<br />gi_star: 1.960814","date_int: 202110<br />gi_star: 2.455811","date_int: 202111<br />gi_star: 3.351476","date_int: 202112<br />gi_star: 2.896677","date_int: 202201<br />gi_star: 4.395120","date_int: 202202<br />gi_star: 4.070512","date_int: 202203<br />gi_star: 3.391115","date_int: 202204<br />gi_star: 3.305766","date_int: 202205<br />gi_star: 3.365709","date_int: 202206<br />gi_star: 3.455622","date_int: 202207<br />gi_star: 3.344342","date_int: 202208<br />gi_star: 3.444267","date_int: 202209<br />gi_star: 3.348461","date_int: 202210<br />gi_star: 3.656576","date_int: 202211<br />gi_star: 3.932857","date_int: 202212<br />gi_star: 4.105120","date_int: 202301<br />gi_star: 4.276440","date_int: 202302<br />gi_star: 4.340714"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":31.415525114155255},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[201880.95000000001,202322.04999999999],"tickmode":"array","ticktext":["201900","202000","202100","202200","202300"],"tickvals":[201900,202000,202100,202200,202300],"categoryorder":"array","categoryarray":["201900","202000","202100","202200","202300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"date_int","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.8245463435592346,4.8224277358686427],"tickmode":"array","ticktext":["2","3","4"],"tickvals":[2,3,4],"categoryorder":"array","categoryarray":["2","3","4"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e86c20e85e":{"x":{},"y":{},"type":"scatter"}},"cur_data":"e86c20e85e","visdat":{"e86c20e85e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ul>
<li><p><strong>Gradual Decline:</strong> <em>The Gi</em>&nbsp;values start at a high value of around&nbsp;4 and gradually decreases even pre-covid suggesting this is a periods where patterns of foreign tourist are high but getting lower in Chonburi.</p></li>
<li><p><strong>Sharp Drop to Negative Values (Mid-2021)</strong>: Around&nbsp;September 2021, the Gi* statistic drops sharply to a Gi value of 2 as with Bangkok. This indicates the number of tourists was significantly lower than before in this specific month which may be due to COVID-19 restrictions.</p></li>
<li><p><strong>Fast Recovery (2022 onwards)</strong>: The Gi* statistic sharply rises back up by November 2021. Then the Gi* statistic went back to its original status at around 4.2 meaning that Chonburi also has fully recovered and welcoming foreign tourists.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>cbr_ft <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
     tau      sl     S     D   varS
   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 -0.306 0.00176  -375  1225 14292.</code></pre>
</div>
</div>
<p>Since p-value is less than our level of significance, we <strong>will reject the null hypothesis</strong> for Chonburi indicating that there is might be montonic trend in the data. From the tau value we see that the temporal trend is negative over the period of 2019 to 2023, suggesting that there might me a decreasing trend of foreign tourist visitng Chonburi.</p>
</div>
</div>
</div>
<p>Now we view the emerging hotspots.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng      tau      sl     S     D   varS
  &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Amnat Charoen  0.125  0.204     153  1225 14292.
2 Ang Thong     -0.0188 0.854     -23  1225 14292.
3 Bangkok        0.140  0.155     171  1225 14292.
4 Bueng Kan      0.273  0.00521   335  1225 14292.
5 Buriram        0.169  0.0849    207  1225 14292.
6 Chachoengsao   0.143  0.146     175  1225 14292.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>emerging_ft <span class="ot">&lt;-</span> allprov_ft <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sl, <span class="fu">abs</span>(tau)) <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(emerging_ft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  province_eng           tau        sl     S     D   varS
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Trat                -0.406 0.0000334  -497  1225 14292.
2 Chanthaburi         -0.383 0.0000905  -469  1225 14292.
3 Prachuap Khiri Khan -0.378 0.000111   -463  1225 14292.
4 Rayong              -0.360 0.000233   -441  1225 14292.
5 Chumphon            -0.355 0.000283   -435  1225 14292.
6 Nong Khai            0.327 0.000820    401  1225 14292.</code></pre>
</div>
</div>
<p>sl (p-values):</p>
<ul>
<li><p>10 provinces, namely Trat, Chanthaburi, Prachuap Khiri Kahn,Rayong, Chumphon, Nong Khai, Udon Thani, Phatthalung, Chonburi, and Sakhon Nakhon, are the top hotspot/coldspot provinces in terms of foreign tourist visitors.</p></li>
<li><p>Provinces with very small sl values (e.g., Trat and Chanthaburi) indicate&nbsp;<strong>high statistical significance</strong>, suggesting that the observed trend is unlikely to be due to random variation.</p></li>
</ul>
<p>Tau values:</p>
<ul>
<li><p><strong>Negative tau values</strong>&nbsp;(e.g., Trat, Chanthaburi, Prachuap Khiri Kahn,Rayong, Chumphon,Phatthalung, and Chonburi) suggest a&nbsp;<strong>decreasing trend</strong>&nbsp;in the number of tourist visitors likely since they are already coldspots.</p></li>
<li><p><strong>Positive tau values</strong>&nbsp;(e.g., Sakhon Nakhon, Udon Thani and Nong Khai) indicate an&nbsp;<strong>increasing trend</strong>, meaning that these provinces are potential hotspots for foreign visitors.<br>
</p></li>
</ul>
</section>
</section>
<section id="performing-emerging-hotspot-analysis" class="level2">
<h2 class="anchored" data-anchor-id="performing-emerging-hotspot-analysis">6.3 Performing Emerging Hotspot Analysis</h2>
<p>Since we have observed Gi* statistics, we will now perform EHSA analysis by using <strong><em>emerging_hotspot_analysis()</em></strong> of sfdep package with the code chunk below.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">Occupancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false">Number of Foreign Tourist</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>rev_ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tourism_spt, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"revenue_all"</span>, </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(rev_ehsa, <span class="st">"data/rds/rev_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>rev_ehsa <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/rev_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Sporadic cold spots</strong>: There are 36 provinces, including&nbsp;Amnat Charoen,&nbsp;Bueng Kan,&nbsp;Chumphon,&nbsp;Phatthalung, and&nbsp;Surat Thani, which are characterized by fluctuating patterns of cold spots. These provinces experienced periods where tourism revenue was significantly lower than expected, but these cold spots were not consistent over time. The sporadic nature of cold spots suggests that while there are dips in revenue, they are not long enough to show a consistent downward trend.</p></li>
<li><p><strong>Sporadic hot spots</strong>: Only 9 provinces, such as&nbsp;Bangkok,&nbsp;Chonburi, and&nbsp;Phuket, were identified as sporadic hot spots. These provinces had periods of significantly higher tourism revenue, but these peaks were inconsistent. The “on-again, off-again” nature of these hot spots might reflect seasonal tourism fluctuations or external factors such as short-term policy changes, events, or market dynamics that temporarily boosted tourism in these areas.</p></li>
<li><p><strong>No pattern detected</strong>: A total of 32 provinces, such as&nbsp;Ang Thong,&nbsp;Khon Kaen, and&nbsp;Rayong, showed no clear spatial pattern in tourism revenue. This suggests that tourism revenue in these provinces did not follow any detectable trend, either positive or negative, over 2019-2023. These provinces may be subject to a range of influences that prevent clear emerging patterns from forming or may not have much tourist activities.</p></li>
</ul>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>or_ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tourism_spt, </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"ratio_tourist_stay"</span>, </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(or_ehsa, <span class="st">"data/rds/or_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>or_ehsa <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/or_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Oscillating hotspots</strong>: A total of 33 provinces, including&nbsp;Chiang Mai,&nbsp;Nakhon Phanom, and&nbsp;Prachuap Khiri Khan, were identified as oscillating hotspots. These provinces experienced recurring periods where occupancy rates were significantly higher than expected, indicating a consistent rebound in demand for accommodations. The oscillating nature of these hotspots suggests that while there are strong peaks in occupancy rates, these trends are followed by periods of lower demand, likely driven by seasonal tourism, festivals, or regional events that create fluctuations in visitor numbers.</p></li>
<li><p><strong>Oscillating cold spots</strong>: 10 provinces, such as&nbsp;Nonthaburi,&nbsp;Pathum Thani, and&nbsp;Samut Sakhon, were marked as oscillating cold spots. These areas consistently saw periods of lower-than-expected occupancy rates, yet these patterns were not sustained over time. The intermittent nature of these cold spots may reflect localized challenges or temporary downturns in tourism, but without indicating a long-term decline in accommodation demand.</p></li>
<li><p><strong>Sporadic cold spots</strong>: Two provinces,&nbsp;Chanthaburi&nbsp;and&nbsp;Ranong, were classified as sporadic cold spots. In these areas, there were brief periods of significantly lower occupancy rates, but these cold spots did not persist long enough to suggest an enduring downward trend in tourism-related accommodation. These provinces may have experienced temporary challenges that caused short-term dips in accommodation demand.</p></li>
<li><p><strong>No pattern detected</strong>: A large number of provinces, 33 in total, such as&nbsp;Bangkok,&nbsp;Krabi,&nbsp;Suphan Buri, and&nbsp;Ang Thong, showed no significant spatial pattern in occupancy rates. This lack of detectable trends indicates that these provinces do not follow a consistent trajectory of either increased or decreased accommodation demand over time. The absence of clear patterns suggests that these areas might be subject to a variety of influencing factors, such as unpredictable shifts in local tourism, preventing clear hotspots or cold spots from emerging.</p></li>
</ul>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>ft_ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tourism_spt, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"no_tourist_foreign"</span>, </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(ft_ehsa, <span class="st">"data/rds/ft_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>ft_ehsa <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ft_ehsa.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Sporadic cold spots</strong>: A large number of provinces (47 out of 77), including&nbsp;<strong>Amnat Charoen</strong>,&nbsp;<strong>Bueng Kan</strong>,&nbsp;<strong>Chaiyaphum</strong>, and&nbsp;<strong>Surat Thani</strong>, were identified as sporadic cold spots. These provinces experienced fluctuations in foreign tourist numbers, with periods where tourist arrivals were significantly lower than expected. However, these cold periods were not consistent enough to show a long-term decline in foreign tourist activity.</p></li>
<li><p><strong>Sporadic hot spots</strong>: Only 12 provinces, such as&nbsp;Bangkok,&nbsp;Chonburi, and&nbsp;Krabi, were classified as sporadic hot spots. These provinces saw intermittent peaks in foreign tourist numbers, suggesting short-term boosts possibly driven by seasonal events, marketing campaigns, or other external factors. These increases were not sustained over time, resulting in an on-and-off pattern rather than continuous growth in foreign tourist arrivals.</p></li>
<li><p><strong>No pattern detected</strong>: Some provinces, such as&nbsp;Chiang Rai,&nbsp;Trat, and&nbsp;Satun, showed no statistically significant spatial pattern for foreign tourists, indicating that these areas had neither sustained periods of higher nor lower foreign tourist activity. This lack of consistent trends might suggest that foreign tourist numbers in these provinces are more random or influenced by a wide range of uncontrollable variables.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="visualizing-emerging-hotspot-analysis" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-emerging-hotspot-analysis">6.4 Visualizing Emerging Hotspot Analysis</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">Revenue</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">Occupancy Rate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-3" role="tab" aria-controls="tabset-26-3" aria-selected="false">Number of Foreign Tourist</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rev_ehsa_joined <span class="ot">&lt;-</span> thaibounds <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(rev_ehsa,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(province_eng <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>or_ehsa_joined <span class="ot">&lt;-</span> thaibounds <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(or_ehsa,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(province_eng <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-26-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>ft_ehsa_joined <span class="ot">&lt;-</span> thaibounds <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(or_ehsa,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(province_eng <span class="sc">==</span> location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>rev_ehsa_sig <span class="ot">&lt;-</span> rev_ehsa_joined <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>or_ehsa_sig <span class="ot">&lt;-</span> or_ehsa_joined <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>ft_ehsa_sig <span class="ot">&lt;-</span> ft_ehsa_joined <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>rev_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(rev_ehsa_joined) <span class="sc">+</span></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(rev_ehsa_sig) <span class="sc">+</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>) <span class="sc">+</span> </span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Revenue EHSA"</span>, </span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>or_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(or_ehsa_joined) <span class="sc">+</span></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(or_ehsa_sig) <span class="sc">+</span></span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>) <span class="sc">+</span> </span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Occupancy Rate EHSA"</span>, </span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>ft_map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(ft_ehsa_joined) <span class="sc">+</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ft_ehsa_sig) <span class="sc">+</span></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>) <span class="sc">+</span> </span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Foreign Tourist EHSA"</span>, </span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">title.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text.size =</span> <span class="fl">0.4</span>, </span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title.size =</span> <span class="fl">0.4</span>)</span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(rev_map, or_map, ft_map, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Chonburi</strong>&nbsp;stands out as a consistent hotspot across all variables, indicating strong tourism development and economic benefits.</p>
<p>Other interesting provinces are the following:</p>
<ol type="1">
<li><p><strong>Phang Nga</strong>:</p>
<ul>
<li><p><strong>Revenue</strong>: Identified as a&nbsp;<strong>coldspot</strong>.</p></li>
<li><p><strong>Occupancy Rate</strong>: Identified as a&nbsp;<strong>coldspot</strong>.</p></li>
<li><p><strong>Number of Foreign Tourists</strong>: Identified as a&nbsp;<strong>hotspot</strong>.</p></li>
<li><p><strong>Observation</strong>: While Phang Nga has a significant number of foreign tourists, it is classified as a coldspot for both revenue and occupancy rate. This could suggest that while many foreign tourists visit, their spending is lower compared to other provinces.</p></li>
</ul></li>
<li><p><strong>Krabi</strong>:</p>
<ul>
<li><p><strong>Revenue</strong>: Identified as a&nbsp;<strong>coldspot</strong>.</p></li>
<li><p><strong>Occupancy Rate</strong>: Identified as a&nbsp;<strong>coldspot</strong>.</p></li>
<li><p><strong>Number of Foreign Tourists</strong>: Identified as a&nbsp;<strong>hotspot</strong>.</p></li>
<li><p><strong>Observation</strong>: Similar to Phang Nga, Krabi has a high number of foreign tourists but is a coldspot in terms of revenue and occupancy rate, indicating potential issues in capitalizing on foreign tourist visits.</p></li>
</ul></li>
<li><p><strong>Bangkok</strong>:</p>
<ul>
<li><p><strong>Revenue</strong>: Identified as a&nbsp;<strong>coldspot</strong>.</p></li>
<li><p><strong>Occupancy Rate</strong>: Identified as a&nbsp;<strong>hotspot</strong>.</p></li>
<li><p><strong>Number of Foreign Tourists</strong>: Identified as a&nbsp;<strong>hotspot</strong>.</p></li>
<li><p><strong>Observation</strong>: Bangkok shows a strong presence in foreign tourists and occupancy rates but is a coldspot in revenue, suggesting a discrepancy between visitor numbers and overall economic impact.</p></li>
</ul></li>
</ol>
</section>
</section>
<section id="conclusion" class="level1">
<h1>7 Conclusion</h1>
<p>In conclusion, this study aimed to explore the spatial and spatio-temporal dependencies of key indicators within Thailand’s tourism economy. By preparing comprehensive geospatial data layers at the provincial level, including a dedicated focus on Bangkok, we were able to analyze the relationships between tourism indicators and their geographic contexts. Using various methods from the <code>sfdep</code> package, we conducted global and local spatial autocorrelation analyses alongside emerging hotspot detection. The findings revealed significant clusters and outliers in tourism indicators, highlighting regions of high and low economic activity. Notably, Chonburi emerged as a consistent hotspot across revenue, occupancy rates, and foreign tourist numbers, while other provinces, despite their appeal in one economic indicator like number of foreign tourists, exhibited discrepancies in another such as revenue generation. These insights provide a deep understanding of Thailand’s tourism dynamics across time and provinces.</p>
<hr>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Betgem, F. (n.d.).&nbsp;<em>Things to do in the Golden Triangle</em>. Chiang Mai a la Carte. Retrieved October 7, 2024, from&nbsp;<a href="https://www.chiangmai-alacarte.com/chiangmai-alacarte/things-to-do/things-to-do-in-the-golden-triangle/" class="uri">https://www.chiangmai-alacarte.com/chiangmai-alacarte/things-to-do/things-to-do-in-the-golden-triangle/</a></p>
<p>Cheung, Elizabeth (13 January 2020). <a href="https://www.scmp.com/news/hong-kong/health-environment/article/3045902/wuhan-pneumonia-thailand-confirms-first-case">“Thailand confirms first case of Wuhan virus outside China”</a>. <em>South China Morning Post</em>. Archived from the original on 13 January 2020. Retrieved 29 September 2024.</p>
<p>Tourism Authority of Thailand. (n.d.).&nbsp;<em>Chon Buri: Destinations &amp; attractions</em>. Tourism Thailand. Retrieved October 3, 2024, from&nbsp;<a href="https://www.tourismthailand.org/Destinations/Provinces/Chon-Buri/464" class="uri">https://www.tourismthailand.org/Destinations/Provinces/Chon-Buri/464</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>